{"version":3,"file":"group.js","sourceRoot":"","sources":["../../../src/logic/group.js"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable prettier/prettier */\nimport { optionsMap } from 'pro-gallery-lib';\nimport { Item } from './item.js';\n\nconst GROUP_TYPES_BY_RATIOS_V = {\n  lll: '1,2h',\n  llp: '1,3r',\n  lpl: '1,2h',\n  pll: '1,2h,3l',\n  lpp: '1,2h,3r,3h',\n  plp: '1,2h,3l,3r,3h',\n  ppl: '1,2h,3l,3h',\n  ppp: '1,2h,3l,3r,3h',\n};\n\nconst GROUP_TYPES_BY_RATIOS_H = {\n  lll: '1,2v,3t,3b,3v',\n  llp: '1,2v,3t,3v',\n  lpl: '1,2v,3t,3b,3v',\n  pll: '1,2v,3b,3v',\n  lpp: '1,2v,3t',\n  plp: '1,2v',\n  ppl: '1,3b',\n  ppp: '1,2h',\n};\n\nconst GROUP_SIZES_BY_MAX_SIZE = {\n  1: [[1]],\n  2: [[1], [1, 2], [2]],\n  3: [[1], [1, 2], [1, 2, 3], [2, 3], [3]],\n};\n\nexport class Group {\n  constructor(config) {\n    this.idx = config.idx;\n    this.stripIdx = config.stripIdx;\n    this.inStripIdx = config.inStripIdx;\n    this.top = config.top;\n    this.showAllItems = config.showAllItems;\n    this.isLastItems = config.isLastItems;\n    this.dummyItems = [];\n    this.targetItemSize = config.targetItemSize;\n\n    this.items = config.items.map((item) => {\n      item.Group = this;\n      return item;\n    });\n\n    if (config.styleParams) {\n      const { styleParams } = config;\n      this.scrollDirection = styleParams[optionsMap.layoutParams.structure.scrollDirection];\n      this.cubeType = styleParams[optionsMap.layoutParams.crop.method];\n      this.cubeImages = styleParams[optionsMap.layoutParams.crop.enable];\n      this.layoutOrientation = styleParams[optionsMap.layoutParams.structure.layoutOrientation];\n      this.minItemSize = styleParams[optionsMap.layoutParams.targetItemSize.minimum];\n      this.collageDensity = styleParams[optionsMap.layoutParams.groups.density];\n      this.groupTypes = String(styleParams[optionsMap.layoutParams.groups.allowedGroupTypes]);\n      this.repeatingGroupTypes = String(styleParams[optionsMap.layoutParams.groups.repeatingGroupTypes]);\n      this.rotatingCropRatios = styleParams[optionsMap.layoutParams.crop.ratios];\n      this.chooseBestGroup = styleParams[optionsMap.layoutParams.groups.groupByOrientation];\n      this.externalInfoHeight = styleParams.externalInfoHeight;\n      this.externalInfoWidth = styleParams.externalInfoWidth;\n      this.imageMargin = styleParams[optionsMap.layoutParams.structure.itemSpacing];\n      this.groupSize = styleParams[optionsMap.layoutParams.groups.groupSize];\n    }\n\n    this.visible = true;\n    this.rendered = true;\n    this.required = true;\n\n    //prepare the group\n    let forcedGroupSize = this.items.length;\n\n    //todo - check if minItem size is really working\n    while (!this.isWithinMinItemSize && forcedGroupSize > 0) {\n      this.placeItems(forcedGroupSize);\n      this.resize();\n      forcedGroupSize--;\n    }\n  }\n\n  resize() {\n    if (this.layoutOrientation === 'VERTICAL') {\n      this.resizeToWidth(this.targetItemSize);\n    } else {\n      this.resizeToHeight(this.targetItemSize);\n    }\n    this.setLeft(this.left);\n    this.setTop(this.top);\n  }\n\n  safeGetItem(idx) {\n    if (this.items[idx]) {\n      return this.items[idx];\n    } else if (this.dummyItems[idx]) {\n      return this.dummyItems[idx];\n    } else {\n      // dummy created from the last item config\n      const item = new Item({ ...this.items[this.items.length - 1].config });\n\n      // const item = {...(this.items[this.items.length - 1])};\n      // item.id += 'dummy';\n\n      // item.idx given to dummy items starting from the last item\n      // item.config.idx = last item index (all gallery items, not group items)\n      // idx = in group item index\n      // this.items = the group's items\n      item.idx = item.config.idx + idx - (this.items.length - 1);\n      item.type = 'dummy';\n      this.dummyItems[idx] = item;\n      return item;\n    }\n  }\n\n  setCubedHeight(height) {\n    const shouldUseFixedHeight =\n      this.cubeImages &&\n      this.groupSize === 1 &&\n      ['FILL', 'FIT'].includes(this.cubeType) &&\n      this.repeatingGroupTypes.length === 0 &&\n      this.rotatingCropRatios.length < 2;\n    this.cubedHeight = shouldUseFixedHeight ? height : null;\n  }\n\n  round() {\n    //round all sizes to full pixels\n    \n    if (this.isLastGroup && this.scrollDirection === 'VERTICAL') {\n      this.width = this.stripWidth - this.left;\n    } else {\n      this.width = Math.round(this.width);\n    }\n    this.height = Math.round(this.height);\n\n    for (const item of this.items) {\n      item.width = Math.round(item.width);\n      item.height = Math.round(item.height);\n      item.group = {\n        width: this.width,\n        height: this.height,\n      };\n    }\n    const m = this.imageMargin;\n\n    switch (this.type) {\n      default:\n      case '1':\n        this.safeGetItem(0).width = this.width - m;\n        this.safeGetItem(0).height = this.height - m;\n        break;\n      case '2v':\n        this.safeGetItem(0).width = this.safeGetItem(1).width = this.width - m;\n        this.safeGetItem(0).height =\n          this.height - this.safeGetItem(1).height - 2 * m;\n        break;\n      case '2h':\n        this.safeGetItem(0).height = this.safeGetItem(1).height =\n          this.height - m;\n        this.safeGetItem(0).width =\n          this.width - this.safeGetItem(1).width - 2 * m;\n        break;\n      case '3t':\n        this.safeGetItem(0).width = this.width - m;\n        this.safeGetItem(0).height =\n          this.height - this.safeGetItem(1).height - 2 * m;\n        this.safeGetItem(1).width =\n          this.width - this.safeGetItem(2).width - 2 * m;\n        this.safeGetItem(2).height = this.safeGetItem(1).height;\n        break;\n      case '3b':\n        this.safeGetItem(0).width =\n          this.width - this.safeGetItem(1).width - 2 * m;\n        this.safeGetItem(1).height = this.safeGetItem(0).height;\n        this.safeGetItem(2).height =\n          this.height - this.safeGetItem(1).height - 2 * m;\n        this.safeGetItem(2).width = this.width - m;\n        break;\n      case '3l':\n        this.safeGetItem(1).height =\n          this.height - this.safeGetItem(2).height - 2 * m;\n        this.safeGetItem(2).width = this.safeGetItem(1).width;\n        this.safeGetItem(0).width =\n          this.width - this.safeGetItem(1).width - 2 * m;\n        this.safeGetItem(0).height = this.height - m;\n        break;\n      case '3r':\n        this.safeGetItem(0).height =\n          this.height - this.safeGetItem(1).height - 2 * m;\n        this.safeGetItem(1).width = this.safeGetItem(0).width;\n        this.safeGetItem(2).width =\n          this.width - this.safeGetItem(1).width - 2 * m;\n        this.safeGetItem(2).height = this.height - m;\n        break;\n      case '3v':\n        this.safeGetItem(0).width = this.width - m;\n        this.safeGetItem(1).width = this.width - m;\n        this.safeGetItem(2).width = this.width - m;\n        this.safeGetItem(2).height =\n          this.height -\n          this.safeGetItem(0).height -\n          this.safeGetItem(1).height -\n          3 * m;\n        break;\n      case '3h':\n        this.safeGetItem(0).height = this.height - m;\n        this.safeGetItem(1).height = this.height - m;\n        this.safeGetItem(2).height = this.height - m;\n        this.safeGetItem(2).width =\n          this.width -\n          this.safeGetItem(0).width -\n          this.safeGetItem(1).width -\n          3 * m;\n        break;\n    }\n  }\n\n  getGroupType(forcedGroupSize) {\n    //---------| Override with specifically defined rotating group types (ignores everything else)\n    if (this.repeatingGroupTypes) {\n      const groupTypesArr = String(this.repeatingGroupTypes).split(',');\n      return groupTypesArr[this.idx % groupTypesArr.length];\n\n      // } else if (this.isLastItems) {\n      //   return this.groupTypes.split(',')[0] || '1';\n    } else {\n      //layoutOrientation === 'VERTICAL' - is the gallery vertical (pinterest style) or horizontal (flickr style)\n\n      //---------| Find the best groupType for each ratios case\n      //optional types:\n      //  1   => single photo\n      //  2v  => 2 photos one above the other\n      //  2h  => 2 photos one alongside the other\n      //  3b  => 3 photos - one large at the bottom and two small on top, one alongside the other\n      //  3t  => 3 photos - one large on top and two small at the bottom, one alongside the other\n      //  3l  => 3 photos - one large on the left and two small on the right, one above the other\n      //  3r  => 3 photos - one large on the right and two small on the left, one above the other\n\n      //define optional ratios for each type:\n      //  1   => all\n      //  2v  => lll,llp,ppp     (horizontal only)\n      //  2h  => ppp,ppl,lll     (vertical only)\n      //  3b  => lll,lpl,pll,ppl (horizontal only)\n      //  3t  => lll,lpl,llp,lpp (horizontal only)\n      //  3l  => ppp,plp,ppl,pll (vertical only)\n      //  3r  => ppp,plp,lpp,llp (vertical only)\n\n      const isV = this.layoutOrientation === 'VERTICAL';\n      let optionalTypes; //optional groupTypes (separated by ,). 1 is always optional\n\n      if (this.chooseBestGroup) {\n        //map the group to l=landscape and p=portrait\n        //create a string to state the images group's type\n        const ratios = this.items\n          .map((item) => item.orientation.slice(0, 1))\n          .join('');\n        optionalTypes = (\n          isV ? GROUP_TYPES_BY_RATIOS_V : GROUP_TYPES_BY_RATIOS_H\n        )[ratios];\n      } else if (this.items.length === 3 || forcedGroupSize === 3) {\n        optionalTypes = isV ? '1,2h,3l,3r,3h' : '1,2v,3t,3b,3v';\n      }\n\n      if (this.items.length === 2 || forcedGroupSize === 2) {\n        optionalTypes = isV ? '1,2h' : '1,2v';\n      }\n      if (this.items.length === 1 || forcedGroupSize === 1) {\n        optionalTypes = '1';\n      }\n\n      let groupTypes = optionalTypes.length > 0 ? optionalTypes.split(',') : [];\n\n      //---------| Override with specifically defined group types\n      if (this.groupTypes) {\n        // let groupTypesArr = union(['1'], this.groupTypes.split(','));\n        const groupTypesArr = this.groupTypes.split(',');\n\n        if (groupTypesArr.length > 1) {\n          groupTypes = groupTypes.filter(\n            (gt) => groupTypesArr.indexOf(gt) >= 0\n          );\n\n          if (groupTypes.length === 0) {\n            //there is no match between required group types and the optional ones - use\n            groupTypes = ['1'];\n          }\n        } else {\n          groupTypes = groupTypesArr;\n        }\n      }\n\n      //---------| Calc collage density\n      if (this.collageDensity >= 0) {\n        //th new calculation of the collage amount\n\n        const collageDensity = this.collageDensity;\n\n        //use the collage amount to determine the optional groupsize\n        const maxGroupType = parseInt(groupTypes[groupTypes.length - 1]);\n        const optionalGroupSizes = GROUP_SIZES_BY_MAX_SIZE[maxGroupType];\n        const targetGroupSizes =\n          optionalGroupSizes[\n            Math.floor(collageDensity * (optionalGroupSizes.length - 1))\n          ];\n        // seed += ((collageDensity * 1.5) - 0.75) * numOfOptions;\n\n        groupTypes = groupTypes.filter(\n          (groupType) => targetGroupSizes.indexOf(parseInt(groupType)) >= 0\n        );\n\n        if (groupTypes.length === 0) {\n          groupTypes = ['1'];\n        }\n      }\n\n      const seed = this.calculateRandomSeed(groupTypes.length);\n\n      //---------| Final group type to render according to:\n      // - the number of options\n      // - the collageAmount (if 0 - always renders 1 image, if 1 always renders the max amount)\n      // - random seed (determined by the hash)\n      return groupTypes[seed] || '1';\n    }\n  }\n\n  calculateRandomSeed(numOfOptions) {\n    let seed;\n    if (this.layoutOrientation === 'VERTICAL') {\n      //vertical galleries random is not relevant (previous group is in another column)\n      seed = this.items[0].seed % numOfOptions;\n    } else {\n      seed = (this.inStripIdx + this.stripIdx) % numOfOptions;\n    }\n\n    return Math.round(Math.min(Math.max(0, seed), numOfOptions - 1));\n  }\n\n  placeItems(forcedGroupSize) {\n    this.type = this.getGroupType(forcedGroupSize);\n\n    //---------| Render the images by the groupType\n    let items = [];\n    let item;\n    let w = 0;\n    let h = 0;\n\n    switch (this.type) {\n      default:\n      case '1':\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        break;\n\n      case '2v':\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(1);\n        item.pinToCorner('bottom-left');\n        item.resize(w / item.width);\n        h += item.height;\n        items.push(item);\n\n        break;\n\n      case '2h':\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        item.innerOffset = [0, 0];\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(1);\n        item.pinToCorner('top-right');\n        item.innerOffset = [0, 0];\n        item.resize(h / item.height);\n        w += item.width;\n        items.push(item);\n\n        break;\n\n      case '3b':\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(1);\n        item.pinToCorner('top-right');\n        item.resize(h / item.height);\n        w += item.width;\n        items.push(item);\n\n        item = this.safeGetItem(2);\n        item.pinToCorner('bottom-left');\n        item.resize(w / item.width);\n        h += item.height;\n        items.push(item);\n\n        break;\n\n      case '3t':\n        item = this.safeGetItem(1);\n        item.pinToCorner('bottom-left');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(2);\n        item.pinToCorner('bottom-right');\n        item.resize(h / item.height);\n        w += item.width;\n        items.push(item);\n\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        item.resize(w / item.width);\n        h += item.height;\n        items = [item].concat(items);\n\n        break;\n\n      case '3r':\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(1);\n        item.pinToCorner('bottom-left');\n        item.resize(w / item.width);\n        h += item.height;\n        items.push(item);\n\n        item = this.safeGetItem(2);\n        item.pinToCorner('top-right');\n        item.resize(h / item.height);\n        w += item.width;\n        items.push(item);\n\n        break;\n\n      case '3l':\n        item = this.safeGetItem(1);\n        item.pinToCorner('top-right');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(2);\n        item.pinToCorner('bottom-right');\n        item.resize(w / item.width);\n        h += item.height;\n        items.push(item);\n\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        item.resize(h / item.height);\n        w += item.width;\n        items = [item].concat(items);\n\n        break;\n\n      case '3v':\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        item.setPosition('relative');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(2);\n        item.pinToCorner('bottom-left');\n        item.setPosition('relative');\n        item.resize(w / item.width);\n        h += item.height;\n        items.push(item);\n\n        //the middle item must be last to position it in the middle (h must be full height)\n        item = this.safeGetItem(1);\n        item.setPosition('relative');\n        item.resize(w / item.width);\n        h += item.height;\n        item.pinToCorner('top', items[0]);\n        items = [items[0], item, items[1]];\n\n        break;\n\n      case '3h':\n        item = this.safeGetItem(0);\n        item.pinToCorner('top-left');\n        item.setPosition('relative');\n        items.push(item);\n        w = item.width;\n        h = item.height;\n\n        item = this.safeGetItem(2);\n        item.pinToCorner('top-right');\n        item.setPosition('relative');\n        item.resize(h / item.height);\n        w += item.width;\n        items.push(item);\n\n        //the middle item must be last to position it in the middle (w must be full width)\n        item = this.safeGetItem(1);\n        item.setPosition('relative');\n        item.resize(h / item.height);\n        w += item.width;\n        item.pinToCorner('left', items[0]);\n        items = [items[0], item, items[1]];\n\n        break;\n    }\n\n    this.width = w;\n    this.height = h;\n    this.items = items;\n    this.placed = true;\n  }\n\n  resizeToHeight(height) {\n    this.height = height;\n    this.width = this.getWidthByHeight(height);\n    this.resizeItems();\n  }\n\n  resizeToWidth(width) {\n    this.width = width;\n    this.height = this.getHeightByWidth(width);\n\n    this.resizeItems();\n  }\n\n  resizeItems() {\n    const items =\n      ['3b', '3r'].indexOf(this.type) >= 0\n        ? this.items.slice().reverse()\n        : this.items;\n    items.forEach((item, i) => {\n      item.resize(this.getItemDimensions(items, i));\n      item.group = {\n        top: this.top,\n        left: this.left,\n        width: this.width,\n        height: this.height,\n      };\n      item.groupOffset = {\n        bottom: this.top + this.height,\n        right: this.left + this.width,\n      };\n    });\n  }\n\n  getItemDimensions(items, idx) {\n    const m = this.imageMargin;\n    switch (this.type) {\n      default:\n      case '1':\n      case '2v':\n      case '3v': {\n        const w = this.width - m;\n        return {\n          width: w,\n        };\n      }\n      case '2h':\n      case '3h': {\n        const h = this.height - m;\n        return {\n          height: h,\n        };\n      }\n      case '3t':\n      case '3b':\n        if (idx === 0) {\n          const w = this.width - m;\n          return {\n            width: w,\n          };\n        } else {\n          const h = this.height - items[0].height - 2 * m;\n          return {\n            height: h,\n          };\n        }\n      case '3r':\n      case '3l':\n        if (idx === 0) {\n          const h = this.height - m;\n          return {\n            height: h,\n          };\n        } else {\n          const w = this.width - items[0].width - 2 * m;\n          return {\n            width: w,\n          };\n        }\n    }\n  }\n\n  getHeightByWidth(W) {\n    let Rg = 1;\n    let Rm = 1;\n    const M = this.imageMargin;\n    const R = this.items.map((item) => item.width / item.height);\n    switch (this.type) {\n      // ---------------------------------\n      // GENERAL FORMULA:\n      // ---------------------------------\n      // Rg = Group ratio [layout specific calculation]\n      // M = margin space between items ( = margin around item * 2)\n      // Rm = Margin ratio [layout specific calculation]\n      // ---------------------------------\n      // | H = W * R + M * Rm |\n      // ---------------------------------\n      //    const H = W * Rg + M * (Vi - Hi * Rg);\n\n      default:\n      case '1':\n        Rg = 1 / R[0];\n        Rm = 1 - Rg;\n        break;\n      case '2h':\n        Rg = 1 / (R[0] + R[1]);\n        Rm = 1 - 2 * Rg;\n        break;\n      case '2v':\n        Rg = 1 / R[0] + 1 / R[1];\n        Rm = 2 - Rg;\n        break;\n      case '3h':\n        Rg = 1 / (R[0] + R[1] + R[2]);\n        Rm = 1 - 3 * Rg;\n        break;\n      case '3v':\n        Rg = 1 / R[0] + 1 / R[1] + 1 / R[2];\n        Rm = 3 - Rg;\n        break;\n      case '3t':\n        Rg = 1 / (R[2] + R[1]) + 1 / R[0];\n        Rm = 2 - 2 / (R[2] + R[1]) + 1 / R[0];\n        break;\n      case '3b':\n        Rg = 1 / (R[0] + R[1]) + 1 / R[2];\n        Rm = 2 - 2 / (R[0] + R[1]) + 1 / R[2];\n        break;\n      case '3l':\n        Rg = (R[1] + R[2]) / (R[0] * R[1] + R[1] * R[2] + R[0] * R[2]);\n        Rm = 2 - Rg * (2 + R[0]);\n        break;\n      case '3r':\n        Rg = (R[0] + R[1]) / (R[0] * R[1] + R[1] * R[2] + R[0] * R[2]);\n        Rm = 2 - Rg * (2 + R[2]);\n        break;\n    }\n    const H = W * Rg + M * Rm;\n\n    return H;\n  }\n\n  getWidthByHeight(H) {\n    let Rg = 1;\n    let Rm = 1;\n    const M = this.imageMargin;\n    const R = this.items.map((item) => item.width / item.height);\n    switch (this.type) {\n      // ---------------------------------\n      // GENERAL FORMULA:\n      // ---------------------------------\n      // Rh = Group ratio [layout specific calculation]\n      // M = margin space between items ( = margin around item * 2)\n      // Rm = Margin ratio [layout specific calculation]\n      // ---------------------------------\n      // | W = H * Rg + M * Rm |\n      // ---------------------------------\n      default:\n      case '1':\n        Rg = R[0];\n        Rm = 1 - Rg;\n        break;\n      case '2h':\n        Rg = R[0] + R[1];\n        Rm = 2 - Rg;\n        break;\n      case '2v':\n        Rg = 1 / (1 / R[0] + 1 / R[1]);\n        Rm = 1 - 2 * Rg;\n        break;\n      case '3h':\n        Rg = R[0] + R[1] + R[2];\n        Rm = 3 - Rg;\n        break;\n      case '3v':\n        Rg = 1 / (1 / R[0] + 1 / R[1] + 1 / R[2]);\n        Rm = 1 - 3 * Rg;\n        break;\n      case '3t':\n        Rg = 1 / (1 / (R[2] + R[1]) + 1 / R[0]);\n        Rm = (2 / (R[2] + R[1]) + 1 / R[0] - 2) * Rg;\n        break;\n      case '3b':\n        Rg = 1 / (1 / (R[0] + R[1]) + 1 / R[2]);\n        Rm = (2 / (R[0] + R[1]) + 1 / R[2] - 2) * Rg;\n        break;\n      case '3l':\n        Rg = (R[0] * R[1] + R[1] * R[2] + R[0] * R[2]) / (R[1] + R[2]);\n        Rm = 2 + R[0] - 2 * Rg;\n        break;\n      case '3r':\n        Rg = (R[0] * R[1] + R[1] * R[2] + R[0] * R[2]) / (R[0] + R[1]);\n        Rm = 2 + R[2] - 2 * Rg;\n        break;\n    }\n    const W = H * Rg + M * Rm;\n\n    return W;\n  }\n\n  setTop(top) {\n    this.top = top || 0;\n    for (const item of this.items) {\n      item.groupOffset = {\n        top,\n        bottom: top + this.height,\n      };\n    }\n  }\n\n  setLeft(left) {\n    this.left = left || 0;\n    for (const item of this.items) {\n      item.groupOffset = {\n        left,\n        right: left + this.width,\n      };\n    }\n  }\n\n  get id() {\n    return 'g' + this.idx + '_' + (this.items[0] || {}).id;\n  }\n\n  get ratio() {\n    const w = this.width;\n    const h = this.height;\n    return w / h;\n  }\n\n  get height() {\n    return this.cubedHeight || this._height;\n  }\n\n  set height(h) {\n    this._height = h;\n  }\n\n  get totalHeight() {\n    return this.height + this.infoHeight;\n  }\n\n  get infoHeight() {\n    return this.externalInfoHeight || 0;\n  }\n\n  get infoWidth() {\n    return this.Column ? this.Column.infoWidth : this.externalInfoWidth || 0;\n  }\n\n  get bottom() {\n    return this.top + this.height;\n  }\n\n  get right() {\n    return this.left + this.width;\n  }\n\n  set items(items) {\n    this._items = items;\n  }\n\n  get items() {\n    return this._items;\n  }\n\n  get realItems() {\n    return this._items.filter((item) => item.type !== 'dummy');\n  }\n\n  get isWithinMinItemSize() {\n    if (this.items.length === 0 || !this.placed) {\n      return false;\n    }\n    if (this.items.length === 1) {\n      return true;\n    } else {\n      return this.items.reduce((i, item) => {\n        const isInSize = Math.min(item.width, item.height) >= this.minItemSize;\n        return i && isInSize;\n      }, true);\n    }\n  }\n\n  get scheme() {\n    return {\n      id: this.id,\n      idx: this.idx,\n      stripIdx: this.stripIdx,\n      inStripIdx: this.inStripIdx,\n      isLastGroup: this.isLastGroup,\n      items: this.items.map((item) => item.scheme),\n      type: this.type,\n      width: this.width,\n      height: this.height,\n      infoHeight: this.infoHeight,\n      infoWidth: this.infoWidth,\n      ratio: this.ratio,\n      top: this.top,\n      left: this.left,\n      right: this.right,\n      bottom: this.bottom,\n      visible: this.visible,\n      rendered: this.rendered,\n      required: this.required,\n    };\n  }\n}\n/* eslint-enable prettier/prettier */\n"]}
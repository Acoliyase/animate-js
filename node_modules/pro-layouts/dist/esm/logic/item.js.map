{"version":3,"file":"item.js","sourceRoot":"","sources":["../../../src/logic/item.js"],"names":[],"mappings":"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","sourcesContent":["import { optionsMap } from 'pro-gallery-lib';\nimport { utils } from './utils.js';\n\nexport class Item {\n  /* @ngInject */\n  constructor(config) {\n    this.style = {};\n    this.visibility = {};\n\n    config = config || {};\n\n    if (!config.dto) {\n      console.error('Item has no DTO', config);\n      config.dto = {};\n    }\n\n    this.config = config;\n    this.dto = config.dto;\n    this.idx = config.idx;\n    this.inGroupIdx = config.inGroupIdx;\n    this.container = config.container;\n    this.cubeType = 'FILL';\n\n    if (config.styleParams) {\n      const { styleParams } = config;\n      this.cubeType = styleParams[optionsMap.layoutParams.crop.method];\n      this.cubeImages = styleParams[optionsMap.layoutParams.crop.enable];\n      this._cropRatio = styleParams[optionsMap.layoutParams.crop.ratios];\n      this.rotatingCropRatios =\n        styleParams[optionsMap.layoutParams.crop.ratios].length > 1 && styleParams[optionsMap.layoutParams.crop.ratios];\n      this.smartCrop = styleParams[optionsMap.layoutParams.crop.enableSmartCrop];\n      this.cropOnlyFill = styleParams[optionsMap.layoutParams.crop.cropOnlyFill];\n      this.imageMargin = styleParams[optionsMap.layoutParams.structure.itemSpacing];\n      this.gallerySpacing = styleParams[optionsMap.layoutParams.structure.gallerySpacing];\n      this.scatter = styleParams[optionsMap.layoutParams.structure.scatter.randomScatter];\n      this.rotatingScatter = styleParams[optionsMap.layoutParams.structure.scatter.manualScatter];\n      this.smartCrop = styleParams[optionsMap.layoutParams.crop.enableSmartCrop];\n      this.useMaxDimensions =\n        !styleParams[optionsMap.layoutParams.structure.enableStreching] && this.itemType !== 'text';\n      this.cubeFitPosition = styleParams[optionsMap.layoutParams.crop.alignment];\n    }\n\n    this._groupOffset = {\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n    };\n\n    this._group = {};\n    this.calcPinOffset = () => 0;\n\n    this.resize(1);\n  }\n\n  fixMetadataVerticalVideoRatio(metadata) {\n    if (metadata.qualities && metadata.qualities[0]) {\n      //fix incorrect width height for vertical videos\n      const { qualities } = metadata;\n      const { height, width } = qualities[qualities.length - 1];\n      metadata.height = height;\n      metadata.width = width;\n    }\n  }\n\n  resize(scaleOrDimensions) {\n    let scale = 1;\n    if (scaleOrDimensions === false) {\n      return;\n    } else if (scaleOrDimensions > 0) {\n      scale = scaleOrDimensions;\n    } else if (typeof scaleOrDimensions === 'object') {\n      if (scaleOrDimensions.width) {\n        const w = Math.max(1, scaleOrDimensions.width);\n        scale = w / this.width;\n      } else if (scaleOrDimensions.height) {\n        const h = Math.max(1, scaleOrDimensions.height);\n        scale = h / this.height;\n      }\n    }\n\n    this.width *= scale;\n    this.height *= scale;\n\n    this.resized = true;\n\n    return this;\n  }\n\n  pinToCorner(cornerName, pinAfter = false) {\n    const isTop = cornerName.indexOf('top') >= 0;\n    const isLeft = cornerName.indexOf('left') >= 0;\n\n    this.style.top = isTop ? 0 : 'auto';\n    this.style.bottom = isTop ? 'auto' : 0;\n    this.style.left = isLeft ? 0 : 'auto';\n    this.style.right = isLeft ? 'auto' : 0;\n\n    this.pin = cornerName;\n    this.isPinnedTop = isTop;\n    this.isPinnedLeft = isLeft;\n    this.pinAfter = pinAfter;\n    this.pinAfterType = isTop ? 'top' : isLeft ? 'left' : '';\n    this.calcPinOffset = (groupSize, dir) => {\n      if (!this.pinAfter) {\n        return 0;\n      } else if (this.pin === dir) {\n        //this is used only for 3h/3v group types - to calc the offset of the middle item\n        const m = this.imageMargin / 2;\n        // return ((groupSize - 6 * m) * this.pinOffset + 2 * m);\n        if (dir === 'top') {\n          return this.pinAfter.height + 2 * m;\n        } else if (dir === 'left') {\n          return this.pinAfter.width + 2 * m;\n        } else {\n          return 0;\n        }\n        // return ((groupSize - 6 * m) * this.pinOffset + 4 * m);\n      } else {\n        return 0;\n      }\n    };\n  }\n\n  setPosition(position) {\n    this.style.position = position;\n  }\n\n  getPosition(pos) {\n    return parseInt(pos, 10) >= 0 ? pos : 'auto';\n  }\n\n  calcScatter(offset) {\n    const m = this.imageMargin / 2;\n    const g = this.gallerySpacing;\n\n    const spaceLeft = offset.left > 0 ? m : g;\n    const spaceRight = this.container.galleryWidth - offset.right > 2 * m ? m : g;\n    const spaceUp = offset.top > 0 ? m : g;\n    const spaceDown = this.container.galleryHeight - offset.bottom > 2 * m ? m : g;\n\n    if (this.rotatingScatter.length > 0) {\n      try {\n        const scatterArr = this.rotatingScatter.split(',');\n        const [x, y] = scatterArr[this.idx % scatterArr.length]\n          .split('/')\n          .map((dim) => parseInt(dim))\n          .map((dim) => dim / 100);\n        let horizontalShift = x * (x > 0 ? spaceRight : spaceLeft);\n        let verticalShift = y * (y > 0 ? spaceDown : spaceUp);\n        return { x: horizontalShift, y: verticalShift };\n      } catch (e) {\n        console.error('Cannot calculate rotating scatter', e);\n      }\n    } else if (this.scatter > 0) {\n      const minShift = 0.4 * (this.scatter / 100);\n\n      let horizontalShift = utils.hashToRandomInt(this.seed + offset.right + 'x', -spaceLeft, spaceRight);\n\n      horizontalShift *= this.scatter / 100;\n      horizontalShift *= 1 - minShift;\n\n      horizontalShift +=\n        (horizontalShift > 0 ? minShift * spaceRight : minShift * spaceLeft) * Math.sign(horizontalShift);\n\n      horizontalShift = Math.round(horizontalShift);\n\n      let verticalShift = utils.hashToRandomInt(this.seed + offset.right + 'y', -spaceUp, spaceDown);\n\n      verticalShift *= this.scatter / 100;\n      verticalShift *= 1 - minShift;\n\n      verticalShift += (verticalShift > 0 ? minShift * spaceDown : minShift * spaceUp) * Math.sign(verticalShift);\n\n      verticalShift = Math.round(verticalShift);\n\n      return { x: horizontalShift, y: verticalShift };\n    } else {\n      return { x: 0, y: 0 };\n    }\n  }\n\n  get top() {\n    return this.getPosition(this.style.top);\n  }\n\n  get left() {\n    return this.getPosition(this.style.left);\n  }\n\n  get right() {\n    return this.getPosition(this.style.right);\n  }\n\n  get bottom() {\n    return this.getPosition(this.style.bottom);\n  }\n\n  set group(group) {\n    Object.assign(this._group, group);\n  }\n\n  get group() {\n    return this._group;\n  }\n\n  set groupOffset(offset) {\n    Object.assign(this._groupOffset, offset);\n  }\n\n  get offset() {\n    const offset = {\n      top:\n        this._groupOffset.top +\n          (this.isPinnedTop ? this.calcPinOffset(this._group.height, 'top') : this._group.height - this.outerHeight) ||\n        0,\n      left:\n        this._groupOffset.left +\n          (this.isPinnedLeft ? this.calcPinOffset(this._group.width, 'left') : this._group.width - this.outerWidth) ||\n        0,\n    };\n    const { fixTop = 0, fixLeft = 0, fixRight = 0, fixBottom = 0 } = this.dimensions;\n\n    offset.innerTop = fixTop;\n    offset.innerLeft = fixLeft;\n    offset.innerRight = fixRight;\n    offset.innerBottom = fixBottom;\n\n    offset.right = offset.left + this.width;\n    offset.bottom = offset.top + this.height;\n\n    if (this.scatter > 0 || this.rotatingScatter?.length > 0) {\n      const { x, y } = this.calcScatter(offset);\n      offset.left += x;\n      offset.top += y;\n      offset.right = offset.left + this.width;\n      offset.bottom = offset.top + this.height;\n    }\n\n    return offset;\n  }\n\n  get id() {\n    return this.dto.id || this.dto.photoId || this.dto.itemId;\n  }\n\n  set id(id) {\n    this.dto.itemId = this.dto.photoId = this.dto.id = id;\n  }\n\n  get hash() {\n    return this.dto.hash || this.dto.mediaUrl || this.dto.id;\n  }\n\n  get seed() {\n    return this.dto.seed || utils.hashToInt(this.hash);\n  }\n\n  get metadata() {\n    return this.dto.metadata || this.dto.metaData || {};\n  }\n\n  get itemType() {\n    return this.metadata.type || 'image';\n  }\n\n  get maxWidth() {\n    return this.dto.width || this.dto.w;\n  }\n  set maxWidth(w) {\n    this.dto.width = w;\n  }\n\n  get outerWidth() {\n    return this.width + 2 * this.margins;\n  }\n\n  get infoWidth() {\n    return this.Group ? this.Group.infoWidth : 0;\n  }\n\n  get orgWidth() {\n    return this.style.orgWidth || this.dto.width || this.dto.w || 1; //make sure the width / height is not undefined (crashes the gallery)\n  }\n\n  get width() {\n    let width;\n    if (this.cubeImages && this.ratio >= this.cropRatio) {\n      width = this.style.cubedWidth || this.orgHeight * this.cropRatio;\n    } else {\n      width = this.orgWidth;\n    }\n    return Math.max(width, 1);\n  }\n\n  set width(w) {\n    // prettier-ignore\n    this.style.cubedWidth =\n    // prettier-ignore\n      this.style.orgWidth =\n    // prettier-ignore\n      this.style.width =\n    // prettier-ignore\n        Math.max(1, w);\n\n    const { fixLeft = 0, fixRight = 0 } = this.dimensions;\n    this.style.innerWidth = this.style.width - fixLeft - fixRight;\n  }\n\n  get outerHeight() {\n    return this.height + 2 * this.margins;\n  }\n\n  get orgHeight() {\n    return this.style.orgHeight || this.dto.height || this.dto.h || 1; //make sure the width / height is not undefined (creashes the gallery)\n  }\n\n  get height() {\n    let height;\n    if (this.cubeImages && this.ratio < this.cropRatio) {\n      height = this.style.cubedHeight || this.orgWidth / this.cropRatio;\n    } else {\n      height = this.orgHeight;\n    }\n    return Math.max(height, 1);\n  }\n\n  set height(h) {\n    // prettier-ignore\n    this.style.cubedHeight =\n    // prettier-ignore\n      this.style.orgHeight =\n    // prettier-ignore\n      this.style.height =\n    // prettier-ignore\n        Math.max(1, h);\n\n    const { fixTop = 0, fixBottom = 0 } = this.dimensions;\n    this.style.innerHeight = this.style.height - fixBottom - fixTop;\n  }\n\n  get maxHeight() {\n    return this.dto.height || this.dto.h;\n  }\n  set maxHeight(h) {\n    h = this.dto.height;\n  }\n  get infoHeight() {\n    return this.Group ? this.Group.infoHeight : 0;\n  }\n\n  get margins() {\n    return this.imageMargin / 2 || 0;\n  }\n  set margins(m) {\n    this.imageMargin = m;\n  }\n\n  get dimensions() {\n    const isGridFit = this.cubeImages && this.cubeType === 'FIT';\n\n    let targetWidth = this.width;\n    let targetHeight = this.height;\n\n    const setTargetDimensions = (setByWidth, ratio) => {\n      if (setByWidth) {\n        targetWidth = this.useMaxDimensions ? Math.min(this.width, this.maxWidth) : this.width;\n        targetHeight = targetWidth / ratio;\n      } else {\n        targetHeight = this.useMaxDimensions ? Math.min(this.height, this.maxHeight) : this.height;\n        targetWidth = targetHeight * ratio;\n      }\n    };\n\n    const isLandscape = this.ratio >= this.cropRatio; //relative to container size\n    if (isGridFit) {\n      setTargetDimensions(isLandscape, this.ratio);\n    } else if (this.useMaxDimensions && (this.width > this.maxWidth || this.height > this.maxHeight)) {\n      if (this.cubeImages) {\n        setTargetDimensions(!isLandscape, this.cropRatio);\n      } else {\n        setTargetDimensions(!isLandscape, this.ratio);\n      }\n    }\n\n    let fixVals = {\n      fixTop: (this.height - targetHeight) / 2,\n      fixLeft: (this.width - targetWidth) / 2,\n      fixRight: (this.width - targetWidth) / 2,\n      fixBottom: (this.height - targetHeight) / 2,\n    };\n\n    switch (this.cubeFitPosition) {\n      case 'TOP':\n        fixVals.fixTop = 0;\n        fixVals.fixBottom *= 2;\n        break;\n      case 'BOTTOM':\n        fixVals.fixTop *= 2;\n        fixVals.fixBottom = 0;\n        break;\n      case 'LEFT':\n        fixVals.fixLeft = 0;\n        fixVals.fixRight *= 2;\n        break;\n      case 'RIGHT':\n        fixVals.fixLeft *= 2;\n        fixVals.fixRight = 0;\n        break;\n    }\n\n    return fixVals;\n  }\n\n  get cropRatio() {\n    let ratio;\n    if (this.rotatingCropRatio) {\n      ratio = this.rotatingCropRatio;\n    } else if (this.rotatingCropRatios && this.rotatingCropRatios.length > 1) {\n      const cropRatiosArr = this.rotatingCropRatios;\n      ratio = this.rotatingCropRatio = cropRatiosArr[this.idx % cropRatiosArr.length];\n    }\n    if (!ratio && typeof this._cropRatio === 'function') {\n      ratio = this._cropRatio();\n    }\n    if (!ratio && this.cropOnlyFill && this.cubeType === 'FIT') {\n      ratio = this.ratio;\n    }\n\n    if (!ratio) {\n      ratio = (this._cropRatio && this._cropRatio[0]) || this.ratio;\n    }\n\n    if (this.dynamicCropRatios !== null && typeof ratio === 'string') {\n      if (!this.dynamicCropRatios) {\n        const dynamicCropRegex = /^\\d*\\.?\\d*(%|px)\\/\\d*\\.?\\d*(%|px)$/;\n        const match = dynamicCropRegex.exec(ratio);\n        if (match) {\n          this.dynamicCropRatios = ratio.split('/').map((val, idx) => {\n            if (val.indexOf('%') > 0) {\n              return {\n                type: '%',\n                val: parseFloat(val.replace('%', '')) / 100,\n                dim: idx === 0 ? 'galleryWidth' : 'galleryHeight',\n              };\n            } else {\n              return {\n                type: 'px',\n                val: parseInt(val.replace('px', '')),\n              };\n            }\n          });\n        } else {\n          this.dynamicCropRatios = null;\n        }\n      }\n      if (this.dynamicCropRatios) {\n        const dynamicCropRatio = this.dynamicCropRatios.map((r) => {\n          if (r.type === '%') {\n            const dim = this.container[r.dim] + (r.dim === 'galleryHeight' ? this.imageMargin / 2 : 0);\n            const relativeDim = r.val * dim - this.imageMargin;\n            return relativeDim;\n          } else {\n            return r.val;\n          }\n        });\n        ratio = dynamicCropRatio[0] / dynamicCropRatio[1];\n      }\n    }\n\n    ratio = Number(ratio);\n\n    if (this.smartCrop === true) {\n      if (this.isPortrait) {\n        ratio = Math.min(ratio, 1 / ratio);\n      } else {\n        ratio = Math.max(ratio, 1 / ratio);\n      }\n    }\n\n    if (this.cubeType === 'MIN') {\n      ratio = Math.max(ratio, this.orgRatio);\n    } else if (this.cubeType === 'MAX') {\n      ratio = Math.min(ratio, this.orgRatio);\n    }\n\n    return ratio;\n  }\n\n  set cropRatio(ratio) {\n    if (typeof this._cropRatio === 'number') {\n      this._cropRatio = ratio;\n      this.style.cubedHeight = this.style.cubedWidth = 0;\n    }\n  }\n\n  get orientation() {\n    return this.ratio < 0.999 ? 'portrait' : 'landscape'; //make sure that almost square images get the same treatment\n  }\n\n  get isPortrait() {\n    return this.orientation === 'portrait';\n  }\n\n  get isLandscape() {\n    return this.orientation === 'landscape';\n  }\n\n  get ratio() {\n    if (!this.orgRatio) {\n      this.orgRatio = this.orgWidth / this.orgHeight;\n    }\n    return this.orgRatio;\n  }\n\n  set ratio(r) {\n    this.orgRatio = r;\n  }\n\n  get roundedStyle() {\n    return {\n      ...this.style,\n      width: Math.round(this.style.width),\n      height: Math.round(this.style.height),\n    };\n  }\n\n  get scheme() {\n    return {\n      id: this.id,\n      idx: this.idx,\n      inGroupIdx: this.inGroupIdx,\n      dto: this.dto,\n      type: this.type,\n      style: this.style,\n      roundedStyle: this.roundedStyle,\n      width: this.width,\n      maxWidth: this.maxWidth,\n      outerWidth: this.outerWidth,\n      infoWidth: this.infoWidth,\n      margins: this.margins,\n      ratio: this.ratio,\n      dimensions: this.dimensions,\n      cropRatio: this.cropRatio,\n      isCropped: this.cubeImages,\n      cropType: this.cubeType,\n      height: this.height,\n      maxHeight: this.maxHeight,\n      outerHeight: this.outerHeight,\n      infoHeight: this.infoHeight,\n      group: this.group,\n      offset: this.offset,\n      groupOffset: this._groupOffset,\n      orientation: this.orientation,\n      isPortrait: this.isPortrait,\n      isLandscape: this.isLandscape,\n      visibility: this.visibility,\n    };\n  }\n}\n"]}
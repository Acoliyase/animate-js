{"version":3,"sources":["../../../src/api/uri.js"],"names":["constants","require","imageServiceUtils","transforms","transform","getURI","fittingType","src","target","options","transformObj","uri","emptyData","isImageTransformApplicable","id","getImageURI","module","exports"],"mappings":"AAAA;;AAEA,IAAMA,YAAYC,QAAQ,kCAAR,CAAlB;AACA,IAAMC,oBAAoBD,QAAQ,8BAAR,CAA1B;AACA,IAAME,aAAaF,QAAQ,uBAAR,CAAnB;AACA,IAAMG,YAAYH,QAAQ,aAAR,CAAlB;;AAEA;;;;;;;;;;;AAWA,SAASI,MAAT,CAAgBC,WAAhB,EAA6BC,GAA7B,EAAkCC,MAAlC,EAA0CC,OAA1C,EAAmDC,YAAnD,EAAiE;AAC7D,MAAIC,MAAMX,UAAUY,SAAV,CAAoBD,GAA9B;;AAEA;AACA,MAAIT,kBAAkBW,0BAAlB,CAA6CN,IAAIO,EAAjD,CAAJ,EAA0D;AACtDJ,mBAAeA,gBAAgBN,UAAUE,WAAV,EAAuBC,GAAvB,EAA4BC,MAA5B,EAAoCC,OAApC,EAA6CC,YAA7C,CAA/B;;AAEA;AACAC,UAAMR,WAAWY,WAAX,CAAuBL,YAAvB,CAAN;AACH,GALD,MAKO;AACHC,UAAMJ,IAAIO,EAAV;AACH;;AAED,SAAOH,GAAP;AACH;;AAEDK,OAAOC,OAAP,GAAiBZ,MAAjB;;AAEA;;;;;;;;;;;;;;;;AAgBA;;;;;;;;;;AAUA;;;;;;;;;;;;AAYA","file":"uri.js","sourcesContent":["'use strict'\n\nconst constants = require('../helpers/imageServiceConstants')\nconst imageServiceUtils = require('../helpers/imageServiceUtils')\nconst transforms = require('../engines/transforms')\nconst transform = require('./transform')\n\n/**\n * returns image transform uri\n *\n * @param {string}                  fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   options             transform options\n * @param {Object}                  [transformObj]      transform data object to use\n *\n * @returns {string}\n */\nfunction getURI(fittingType, src, target, options, transformObj) {\n    let uri = constants.emptyData.uri\n\n    // check if image transformation is applicable (e.g. .gif, .wix_mp)\n    if (imageServiceUtils.isImageTransformApplicable(src.id)) {\n        transformObj = transformObj || transform(fittingType, src, target, options, transformObj)\n\n        // set the uri property\n        uri = transforms.getImageURI(transformObj)\n    } else {\n        uri = src.id\n    }\n\n    return uri\n}\n\nmodule.exports = getURI\n\n/**\n * the source image to transform\n * @typedef  {object} ImageTransformSource\n * @property {string}  id               source image uri\n * @property {number}  width            source image width\n * @property {number}  height           source image height\n * @property {object}  [crop]           source image crop values\n * @property {number}  crop.x           crop x\n * @property {number}  crop.y           crop y\n * @property {number}  crop.width       crop width\n * @property {number}  crop.height      crop height\n * @property {object}  [focalPoint]     source image focal point values\n * @property {number}  focalPoint.x     focal point x\n * @property {number}  focalPoint.y     focal point y\n */\n\n/**\n * the destination container\n * @typedef  {object}  ImageTransformTarget\n * @property {number}  width                destination container width\n * @property {number}  height               destination container height\n * @property {number}  [pixelAspectRatio]   for retina and mobile displays, 1 (default)\n * @property {string}  [alignment]          how to align the image in the container, imageService.alignTypes  CENTER(default)\n * @property {string}  [htmlTag]            the css style, imageService.htmlTag IMG(default)\n */\n\n/**\n * the transform options\n * @typedef  {object}   ImageTransformOptions\n * @property {boolean}  [progressive]               image transform progressive\n * @property {number}   [quality]                   image transform quality\n * @property {string}   [watermark]                 image watermark id\n * @property {object}   [unsharpMask]               unsharpMask filter\n * @property {number}   [unsharpMask.radius]        unsharpMask radius\n * @property {number}   [unsharpMask.amount]        unsharpMask amount\n * @property {number}   [unsharpMask.threshold]     unsharpMask threshold\n */\n\n/**\n * the transform results\n * @typedef  {object} ImageTransformResult\n * @property {string} uri the generated image uri, *without* base path\n * @property {object} css CSS properties for the image and it's parent container, empty object for SVG\n * @property {object} css.img CSS for the image element\n * @property {object} css.container CSS for the image container\n * @property {object} attr HTML Attributes for the image and it's parent container, empty object for bg and img types\n * @property {object} attr.img HTML Attributes for the image element\n * @property {object} attr.container HTML Attributes for the image container\n *\n */\n"]}
{"version":3,"sources":["../../../../src/api/max/index.js"],"names":["utils","require","constants","imageServiceUtils","attributes","transform","getURI","getData","fittingType","src","target","options","data","isValidRequest","transformObj","uri","assign","getAttributes","emptyData","module","exports","populateGlobalFeatureSupport","fittingTypes","alignTypes","htmlTag","upscaleMethods"],"mappings":"AAAA;;AACA,IAAMA,QAAQC,QAAQ,qBAAR,CAAd;AACA,IAAMC,YAAYD,QAAQ,qCAAR,CAAlB;AACA,IAAME,oBAAoBF,QAAQ,iCAAR,CAA1B;AACA,IAAMG,aAAaH,QAAQ,0BAAR,CAAnB;AACA,IAAMI,YAAYJ,QAAQ,cAAR,CAAlB;AACA,IAAMK,SAASL,QAAQ,QAAR,CAAf;;AAIA;;;;;;;;;;;AAWA,SAASM,OAAT,CAAiBC,WAAjB,EAA8BC,GAA9B,EAAmCC,MAAnC,EAA2CC,OAA3C,EAAoD;AAChD,MAAIC,OAAO,EAAX;;AAEA;AACA,MAAIT,kBAAkBU,cAAlB,CAAiCL,WAAjC,EAA8CC,GAA9C,EAAmDC,MAAnD,CAAJ,EAAgE;AAC5D,QAAMI,eAAeT,UAAUG,WAAV,EAAuBC,GAAvB,EAA4BC,MAA5B,EAAoCC,OAApC,CAArB;;AAEAC,SAAKG,GAAL,GAAWT,OAAOE,WAAP,EAAoBC,GAApB,EAAyBC,MAAzB,EAAiCC,OAAjC,EAA0CG,YAA1C,CAAX;;AAEA;AACAd,UAAMgB,MAAN,CAAaJ,IAAb,EAAmBR,WAAWa,aAAX,CAAyBH,YAAzB,EAAuCJ,MAAvC,CAAnB;AACH,GAPD,MAOO;AACH;AACAE,WAAOV,UAAUgB,SAAjB;AACH;;AAED;AACA,SAAON,IAAP;AACH;;AAEDO,OAAOC,OAAP,GAAiB;AACbC,gCAA8BlB,kBAAkBkB,4BADnC;AAEbd,kBAFa;AAGbe,gBAAcpB,UAAUoB,YAHX;AAIbC,cAAYrB,UAAUqB,UAJT;AAKbC,WAAStB,UAAUsB,OALN;AAMbC,kBAAgBvB,UAAUuB;;AAG9B;;;;;;;;;;;;;;;;AAgBA;;;;;;;;;;AAUA;;;;;;;;;;;;AAYA;;;;;;;;;;;;;AA/CiB,CAAjB","file":"index.js","sourcesContent":["'use strict'\nconst utils = require('../../helpers/utils')\nconst constants = require('../../helpers/imageServiceConstants')\nconst imageServiceUtils = require('../../helpers/imageServiceUtils')\nconst attributes = require('../../engines/attributes')\nconst transform = require('../transform')\nconst getURI = require('../uri')\n\n\n\n/**\n * returns image transform uri and the\n * needed css for alignment and positioning\n *\n * @param {string}                  fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   [options]          transform options\n *\n * @returns {{uri: string, css: {img: {}, container: {}}} | {uri: string, attr: {img: {}, container: {}}} | {}}\n */\nfunction getData(fittingType, src, target, options) {\n    let data = {}\n\n    // check if valid request\n    if (imageServiceUtils.isValidRequest(fittingType, src, target)) {\n        const transformObj = transform(fittingType, src, target, options)\n\n        data.uri = getURI(fittingType, src, target, options, transformObj)\n\n        //set the CSS or the SVG property\n        utils.assign(data, attributes.getAttributes(transformObj, target))\n    } else {\n        // empty data\n        data = constants.emptyData\n    }\n\n    // return data to be used in html\n    return data\n}\n\nmodule.exports = {\n    populateGlobalFeatureSupport: imageServiceUtils.populateGlobalFeatureSupport,\n    getData,\n    fittingTypes: constants.fittingTypes,\n    alignTypes: constants.alignTypes,\n    htmlTag: constants.htmlTag,\n    upscaleMethods: constants.upscaleMethods\n}\n\n/**\n * the source image to transform\n * @typedef  {object} ImageTransformSource\n * @property {string}  id               source image uri\n * @property {number}  width            source image width\n * @property {number}  height           source image height\n * @property {object}  [crop]           source image crop values\n * @property {number}  crop.x           crop x\n * @property {number}  crop.y           crop y\n * @property {number}  crop.width       crop width\n * @property {number}  crop.height      crop height\n * @property {object}  [focalPoint]     source image focal point values\n * @property {number}  focalPoint.x     focal point x\n * @property {number}  focalPoint.y     focal point y\n */\n\n/**\n * the destination container\n * @typedef  {object}  ImageTransformTarget\n * @property {number}  width                destination container width\n * @property {number}  height               destination container height\n * @property {number}  [pixelAspectRatio]   for retina and mobile displays, 1 (default)\n * @property {string}  [alignment]          how to align the image in the container, imageService.alignTypes  CENTER(default)\n * @property {string}  [htmlTag]            the css style, imageService.htmlTag IMG(default)\n */\n\n/**\n * the transform options\n * @typedef  {object}   ImageTransformOptions\n * @property {boolean}  [progressive]               image transform progressive\n * @property {number}   [quality]                   image transform quality\n * @property {string}   [watermark]                 image watermark id\n * @property {object}   [unsharpMask]               unsharpMask filter\n * @property {number}   [unsharpMask.radius]        unsharpMask radius\n * @property {number}   [unsharpMask.amount]        unsharpMask amount\n * @property {number}   [unsharpMask.threshold]     unsharpMask threshold\n */\n\n/**\n * the transform results\n * @typedef  {object} ImageTransformResult\n * @property {string} uri the generated image uri, *without* base path\n * @property {object} css CSS properties for the image and it's parent container, empty object for SVG\n * @property {object} css.img CSS for the image element\n * @property {object} css.container CSS for the image container\n * @property {object} attr HTML Attributes for the image and it's parent container, empty object for bg and img types\n * @property {object} attr.img HTML Attributes for the image element\n * @property {object} attr.container HTML Attributes for the image container\n *\n */\n"]}
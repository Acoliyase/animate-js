{"version":3,"sources":["../../../../src/engines/attributes/SVGAttributes.js"],"names":["constants","require","imageServiceUtils","getSvgAttr","transformsObj","target","attributes","css","container","attr","img","fittingType","fittingTypes","alignType","alignment","alignTypes","sourceWidth","src","width","sourceHeight","height","imageScale","position","ORIGINAL_SIZE","LEGACY_ORIGINAL_SIZE","TILE","parts","length","preserveAspectRatio","SCALE_TO_FIT","LEGACY_FIT_WIDTH","LEGACY_FIT_HEIGHT","LEGACY_FULL","transform","STRETCH","x","y","SCALE_TO_FILL","isImageTransformApplicable","id","getDimension","transformTypes","FILL","right","bottom","center","Math","round","middle","TOP_LEFT","TOP","TOP_RIGHT","LEFT","CENTER","RIGHT","BOTTOM_LEFT","BOTTOM","BOTTOM_RIGHT","viewBox","join","module","exports","get"],"mappings":"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","file":"SVGAttributes.js","sourcesContent":["'use strict'\nconst constants = require('../../helpers/imageServiceConstants')\nconst imageServiceUtils = require('../../helpers/imageServiceUtils')\n/* eslint-disable indent */\n/**\n * get CSS or SVG attributes to be used in the browser\n * @param {object}          transformsObj  transform parts object\n * @param {ImageTransformTarget}  target\n *\n * @returns {{attr:{img: {}, container: {}}, css:{container:{}}}}\n */\nfunction getSvgAttr(transformsObj, target) {\n    const attributes = {\n        css: {\n            container: {}\n        },\n        attr: {\n            container: {},\n            img: {}\n        }\n    }\n    const css = attributes.css\n    const attr = attributes.attr\n    const fittingType = transformsObj.fittingType\n    const fittingTypes = constants.fittingTypes\n    const alignType = target.alignment\n    const alignTypes = constants.alignTypes\n    const sourceWidth = transformsObj.src.width\n    const sourceHeight = transformsObj.src.height\n    let imageScale\n\n    css.container.position = 'relative'\n\n// populate SVG attributes object\n    //eslint-disable-line indent\n    switch (fittingType) {\n        case fittingTypes.ORIGINAL_SIZE:\n        case fittingTypes.LEGACY_ORIGINAL_SIZE:\n        case fittingTypes.TILE:\n            if (transformsObj.parts && transformsObj.parts.length) {\n                attr.img.width = transformsObj.parts[0].width\n                attr.img.height = transformsObj.parts[0].height\n            } else {\n                attr.img.width = sourceWidth\n                attr.img.height = sourceHeight\n            }\n            attr.img.preserveAspectRatio = 'xMidYMid slice'\n            break\n\n        case fittingTypes.SCALE_TO_FIT:\n        case fittingTypes.LEGACY_FIT_WIDTH:\n        case fittingTypes.LEGACY_FIT_HEIGHT:\n        case fittingTypes.LEGACY_FULL:\n            attr.img.width = '100%'\n            attr.img.height = '100%'\n            attr.img.transform = ''\n            attr.img.preserveAspectRatio = ''\n            break\n\n        case fittingTypes.STRETCH:\n            attr.img.width = target.width\n            attr.img.height = target.height\n            attr.img.x = 0\n            attr.img.y = 0\n            attr.img.transform = ''\n            attr.img.preserveAspectRatio = 'none'\n            break\n\n        case fittingTypes.SCALE_TO_FILL:\n            if (!imageServiceUtils.isImageTransformApplicable(transformsObj.src.id)) {\n                imageScale = imageServiceUtils.getDimension(sourceWidth, sourceHeight, target.width, target.height, constants.transformTypes.FILL)\n                attr.img.width = imageScale.width\n                attr.img.height = imageScale.height\n            } else {\n                attr.img.width = target.width\n                attr.img.height = target.height\n            }\n            attr.img.x = 0\n            attr.img.y = 0\n            attr.img.transform = ''\n            attr.img.preserveAspectRatio = 'xMidYMid slice'\n            break\n    }\n\n    // set alignment for cases where the requested src is smaller or bigger than the target element,\n    if (attr.img.width !== target.width || attr.img.height !== target.height) {\n        // x and y to use in svg <pattern> element\n        let x = 0\n        let y = 0\n        let right\n        let bottom\n        if (fittingType === fittingTypes.TILE) {\n            right = target.width % attr.img.width\n            bottom = target.height % attr.img.height\n        } else {\n            right = target.width - attr.img.width\n            bottom = target.height - attr.img.height\n        }\n        const center = Math.round(right / 2)\n        const middle = Math.round(bottom / 2)\n\n        switch (alignType) {\n            case alignTypes.TOP_LEFT:\n                x = 0\n                y = 0\n                break\n            case alignTypes.TOP:\n                x = center\n                y = 0\n                break\n            case alignTypes.TOP_RIGHT:\n                x = right\n                y = 0\n                break\n\n            case alignTypes.LEFT:\n                x = 0\n                y = middle\n                break\n            case alignTypes.CENTER:\n                x = center\n                y = middle\n                break\n            case alignTypes.RIGHT:\n                x = right\n                y = middle\n                break\n\n            case alignTypes.BOTTOM_LEFT:\n                x = 0\n                y = bottom\n                break\n            case alignTypes.BOTTOM:\n                x = center\n                y = bottom\n                break\n            case alignTypes.BOTTOM_RIGHT:\n                x = right\n                y = bottom\n                break\n        }\n\n        attr.img.x = x\n        attr.img.y = y\n    }\n\n    attr.container.width = target.width\n    attr.container.height = target.height\n    attr.container.viewBox = [0, 0, target.width, target.height].join(' ')\n\n// return attributes object\n    return attributes\n}\n/* eslint-enable indent */\n\nmodule.exports = {\n    get: getSvgAttr\n}\n"]}
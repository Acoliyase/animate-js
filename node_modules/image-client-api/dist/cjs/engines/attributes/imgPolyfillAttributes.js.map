{"version":3,"sources":["../../../../src/engines/attributes/imgPolyfillAttributes.js"],"names":["utils","require","constants","imageServiceUtils","getCSS","transformsObj","target","attributes","css","container","img","fittingType","fittingTypes","alignType","alignment","alignTypes","sourceWidth","sourceHeight","parts","length","width","height","src","cssValues","display","position","top","right","bottom","left","ORIGINAL_SIZE","LEGACY_ORIGINAL_SIZE","SCALE_TO_FIT","LEGACY_FIT_WIDTH","LEGACY_FIT_HEIGHT","LEGACY_FULL","getDimension","transformTypes","FIT","assign","STRETCH","SCALE_TO_FILL","uri","id","isImageTypeSupported","isExternalUrl","FILL","overflow","verticalMiddle","Math","round","horizontalMiddle","CENTER","LEFT","RIGHT","TOP","BOTTOM","TOP_RIGHT","TOP_LEFT","BOTTOM_RIGHT","BOTTOM_LEFT","module","exports","get"],"mappings":"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","file":"imgPolyfillAttributes.js","sourcesContent":["'use strict'\n\nconst utils = require('../../helpers/utils')\nconst constants = require('../../helpers/imageServiceConstants')\nconst imageServiceUtils = require('../../helpers/imageServiceUtils')\n\n/**\n * returns alternative Image tag CSS data\n * @param {object}                  transformsObj    transform parts object\n * @param {ImageTransformTarget}    target\n *\n * @returns {{css: {img: {}, container: {}}}}\n */\nfunction getCSS(transformsObj, target) {\n    const attributes = {\n        css: {\n            container: {},\n            img: {}\n        }\n    }\n    const css = attributes.css\n    const fittingType = transformsObj.fittingType\n    const fittingTypes = constants.fittingTypes\n    const alignType = target.alignment\n    const alignTypes = constants.alignTypes\n    let sourceWidth\n    let sourceHeight\n    if (transformsObj.parts && transformsObj.parts.length) {\n        sourceWidth = transformsObj.parts[0].width\n        sourceHeight = transformsObj.parts[0].height\n    } else {\n        sourceWidth = transformsObj.src.width\n        sourceHeight = transformsObj.src.height\n    }\n    let cssValues\n\n    css.img.display = 'block'\n    css.container.position = 'relative'\n    css.img.position = 'absolute'\n    css.img.top = 'auto'\n    css.img.right = 'auto'\n    css.img.bottom = 'auto'\n    css.img.left = 'auto'\n\n    // set css\n    switch (fittingType) {\n        case fittingTypes.ORIGINAL_SIZE:\n        case fittingTypes.LEGACY_ORIGINAL_SIZE:\n            css.img.width = sourceWidth\n            css.img.height = sourceHeight\n            break\n        case fittingTypes.SCALE_TO_FIT:\n        case fittingTypes.LEGACY_FIT_WIDTH:\n        case fittingTypes.LEGACY_FIT_HEIGHT:\n        case fittingTypes.LEGACY_FULL:\n            cssValues = imageServiceUtils.getDimension(sourceWidth, sourceHeight, target.width, target.height, constants.transformTypes.FIT)\n            utils.assign(css.img, cssValues)\n            break\n\n        case fittingTypes.STRETCH:\n            css.img.width = target.width\n            css.img.height = target.height\n            break\n\n        case fittingTypes.SCALE_TO_FILL:\n            const uri = transformsObj.src.id\n            if (imageServiceUtils.isImageTypeSupported(uri) || imageServiceUtils.isExternalUrl(uri)) {\n                css.img.width = target.width\n                css.img.height = target.height\n            } else {\n                cssValues = imageServiceUtils.getDimension(sourceWidth, sourceHeight, target.width, target.height, constants.transformTypes.FILL)\n                utils.assign(css.img, cssValues)\n                css.container.overflow = 'hidden'\n            }\n            break\n    }\n\n    //no need to align when sizing are the same\n    if (css.img.width !== target.width || css.img.height !== target.height) {\n        const verticalMiddle = Math.round((target.height - css.img.height) / 2)\n        const horizontalMiddle = Math.round((target.width - css.img.width) / 2)\n\n        switch (alignType) {\n            default:\n            case alignTypes.CENTER:\n                css.img.top = verticalMiddle\n                css.img.left = horizontalMiddle\n                break\n\n            case alignTypes.LEFT:\n                css.img.left = 0\n                css.img.top = verticalMiddle\n                //0% 50%\n                break\n\n            case alignTypes.RIGHT:\n                css.img.right = 0\n                css.img.top = verticalMiddle\n                //100% 50%\n                break\n\n            case alignTypes.TOP:\n                css.img.left = horizontalMiddle\n                css.img.top = 0\n                //50% 0%\n                break\n\n            case alignTypes.BOTTOM:\n                css.img.left = horizontalMiddle\n                css.img.bottom = 0\n                //50% 100%\n                break\n\n            case alignTypes.TOP_RIGHT:\n                css.img.right = 0\n                css.img.top = 0\n                //100% 0%\n                break\n\n            case alignTypes.TOP_LEFT:\n                css.img.left = 0\n                css.img.top = 0\n                //0% 0%\n                break\n\n            case alignTypes.BOTTOM_RIGHT:\n                css.img.right = 0\n                css.img.bottom = 0\n                //100% 100%\n                break\n\n            case alignTypes.BOTTOM_LEFT:\n                css.img.left = 0\n                css.img.bottom = 0\n                //0% 100%\n                break\n        }\n    }\n    // returns alternative Image tag CSS data\n    return attributes\n}\n\nmodule.exports = {\n    get: getCSS\n}\n"]}
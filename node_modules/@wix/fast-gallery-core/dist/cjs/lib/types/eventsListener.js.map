{"version":3,"names":["makeEventsListener","handlers","handler","event","data","eventHandlers","forEach","_handler","self","Proxy","get","_","prop","parent","eventName","handlerToAdd","push"],"sources":["../../../../src/lib/types/eventsListener.ts"],"sourcesContent":["import { GALLERY_EVENTS, EventsListenerFunction, EventData } from './events';\n\ntype EventHandler<T> = (data: T) => void;\n\ntype HandlersMap = {\n  [event: string]: EventHandler<any>[];\n};\n\ntype Handle = {\n  [Key in keyof typeof GALLERY_EVENTS]: <T>(handler: EventHandler<T>) => Handle;\n} & {\n  done: (parent?: EventsListenerFunction) => EventsListenerFunction;\n};\n\n/**\n * @returns {Handle} - a pipeable object that allows to register event handlers, to close the pipe use the done method\n * @example\n * const eventsListener = makeeventsListener();\n * eventsListener\n *  .HOVER_SET<{ idx: number }>(({idx}) => console.log('hovering on item', idx))\n *  .done();\n */\n\nexport function makeEventsListener(): Handle {\n  const handlers: HandlersMap = {};\n\n  const handler = (event: GALLERY_EVENTS, data: EventData) => {\n    const eventHandlers = handlers[event];\n    if (eventHandlers) {\n      eventHandlers.forEach((_handler) => _handler(data));\n    }\n  };\n\n  const self = new Proxy(\n    {},\n    {\n      get: (_, prop) => {\n        if (prop === 'done') {\n          return (parent?: EventsListenerFunction) =>\n            (eventName: GALLERY_EVENTS, data: EventData) => {\n              handler(eventName, data);\n              if (parent) {\n                parent(eventName, data);\n              }\n            };\n        }\n        return <T>(handlerToAdd: EventHandler<T>) => {\n          const event = prop as string;\n          if (!handlers[event]) {\n            handlers[event] = [];\n          }\n          handlers[event].push(handlerToAdd);\n          return self;\n        };\n      },\n    },\n  ) as Handle;\n  return self;\n}\n"],"mappings":";;;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO,SAASA,kBAAkBA,CAAA,EAAW;EAC3C,MAAMC,QAAqB,GAAG,CAAC,CAAC;EAEhC,MAAMC,OAAO,GAAGA,CAACC,KAAqB,EAAEC,IAAe,KAAK;IAC1D,MAAMC,aAAa,GAAGJ,QAAQ,CAACE,KAAK,CAAC;IACrC,IAAIE,aAAa,EAAE;MACjBA,aAAa,CAACC,OAAO,CAAEC,QAAQ,IAAKA,QAAQ,CAACH,IAAI,CAAC,CAAC;IACrD;EACF,CAAC;EAED,MAAMI,IAAI,GAAG,IAAIC,KAAK,CACpB,CAAC,CAAC,EACF;IACEC,GAAG,EAAEA,CAACC,CAAC,EAAEC,IAAI,KAAK;MAChB,IAAIA,IAAI,KAAK,MAAM,EAAE;QACnB,OAAQC,MAA+B,IACrC,CAACC,SAAyB,EAAEV,IAAe,KAAK;UAC9CF,OAAO,CAACY,SAAS,EAAEV,IAAI,CAAC;UACxB,IAAIS,MAAM,EAAE;YACVA,MAAM,CAACC,SAAS,EAAEV,IAAI,CAAC;UACzB;QACF,CAAC;MACL;MACA,OAAWW,YAA6B,IAAK;QAC3C,MAAMZ,KAAK,GAAGS,IAAc;QAC5B,IAAI,CAACX,QAAQ,CAACE,KAAK,CAAC,EAAE;UACpBF,QAAQ,CAACE,KAAK,CAAC,GAAG,EAAE;QACtB;QACAF,QAAQ,CAACE,KAAK,CAAC,CAACa,IAAI,CAACD,YAAY,CAAC;QAClC,OAAOP,IAAI;MACb,CAAC;IACH;EACF,CACF,CAAW;EACX,OAAOA,IAAI;AACb","ignoreList":[]}
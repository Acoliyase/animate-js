{"version":3,"names":["NeedMoreItemsPaddingSize","exports","canNavigateByScroller","scrollerRef","scrollerMeasurements","containerMeasurements","scrollerExists","current","containerExists","differentDimensions","areDimensionsEqual","Error","containerWidth","width","containerHeight","height","scrollerWidth","scrollerHeight","sameHeight","sameWidth","isALargerThanB","a","b","byHeight","byWidth","isHTMLElement","element","HTMLElement","isWindowElement","Window","someItemsOutsideOfContainer","items","some","item","measurements","left","top","isCurrentlyNavigating","currentNavigation","currentScroll","state","getScrollPositionFromMeasurements","x","y","isAtEnd","isRTL","navigationBoundries","scrollPosition","isAtScrollEnd","isAtScrollStartX","isAtScrollEndY","isAtScrollEndX","isAtStart","isAtScrollStartY","isAtScrollEndWithPadding","navigationBoundaries","padding","paddedScrollPosition","reachedToNeedMoreItems","getScrollPositionFromEvent","event","target","document","bubbles","srcElement","scrollingElement","scrollLeft","scrollTop","isItemCenteredX","itemMeasurements","centerX","itemLeft","itemRight","isItemCenteredY","centerY","itemTop","itemBottom","isItemCenteredBothAxes"],"sources":["../../../src/navigator/navigatorUtils.ts"],"sourcesContent":["import { Item, Measurements, ScrollPosition } from './types';\nimport { TrackablePromise, Deferred } from './asyncUtils';\nimport { RefObject } from 'react';\n\nexport const NeedMoreItemsPaddingSize = 1500;\n\nexport function canNavigateByScroller(\n  scrollerRef: RefObject<HTMLDivElement | Window> | null,\n  scrollerMeasurements: Measurements | null,\n  containerMeasurements: Measurements | null,\n) {\n  const scrollerExists = !!scrollerRef?.current;\n  const containerExists = !!containerMeasurements; // Need to see if this is enough, TODO - if I have the ref by the end of it - use it\n  const differentDimensions = !areDimensionsEqual(\n    scrollerMeasurements,\n    containerMeasurements,\n  );\n  return scrollerExists && containerExists && differentDimensions;\n}\n\nexport function areDimensionsEqual(\n  containerMeasurements: Measurements | null,\n  scrollerMeasurements: Measurements | null,\n) {\n  if (!containerMeasurements || !scrollerMeasurements) {\n    throw new Error(\n      'containerMeasurements and scrollerMeasurements must be defined',\n    );\n  }\n  const containerWidth = containerMeasurements.width;\n  const containerHeight = containerMeasurements.height;\n  const scrollerWidth = scrollerMeasurements.width;\n  const scrollerHeight = scrollerMeasurements.height;\n  const sameHeight = containerHeight === scrollerHeight;\n  const sameWidth = containerWidth === scrollerWidth;\n  return sameHeight && sameWidth;\n}\n\nexport function isALargerThanB(a: Measurements | null, b: Measurements | null) {\n  if (!a || !b) {\n    throw new Error('two measurements must be defined');\n  }\n  const byHeight = a.height >= b.height;\n  const byWidth = a.width >= b.width;\n  return byHeight && byWidth;\n}\n\nexport function isHTMLElement(element: HTMLElement | Window | null): element is HTMLElement {\n  return element instanceof HTMLElement;\n}\n\nexport function isWindowElement(element: HTMLElement | Window | null): element is Window {\n  return element instanceof Window;\n}\n\nexport function someItemsOutsideOfContainer(\n  items: Item[],\n  containerMeasurements: Measurements | null,\n) {\n  if (!containerMeasurements) {\n    throw new Error(\n      'containerMeasurements must be defined to check for items arrangement',\n    );\n  }\n  return items.some((item) => {\n    return (\n      item.measurements.left + item.measurements.width >\n        containerMeasurements.width ||\n      item.measurements.top + item.measurements.height >\n        containerMeasurements.height\n    );\n  });\n}\nexport function isCurrentlyNavigating(\n  currentNavigation: TrackablePromise<ScrollPosition> | undefined,\n  currentScroll: Deferred<ScrollPosition> | undefined,\n) {\n  return (\n    (currentNavigation && currentNavigation.state === 'pending') || // navigation promise is ongoing\n    currentScroll // current scroll in process\n  );\n}\n\nexport function getScrollPositionFromMeasurements(\n  measurements: Measurements,\n): ScrollPosition {\n  return {\n    x: measurements.left,\n    y: measurements.top,\n  };\n}\nexport function isAtEnd(\n  isRTL: boolean,\n  scrollerMeasurements: Measurements,\n  navigationBoundries: Measurements,\n  scrollPosition: ScrollPosition,\n) {\n  return isAtScrollEnd(\n    isRTL,\n    scrollerMeasurements,\n    navigationBoundries,\n    scrollPosition,\n  );\n}\nexport function isAtScrollEnd(\n  isRTL: boolean,\n  scrollerMeasurements: Measurements,\n  navigationBoundries: Measurements,\n  scrollPosition: ScrollPosition,\n) {\n  if (isRTL) {\n    return (\n      isAtScrollStartX(scrollPosition) &&\n      isAtScrollEndY(scrollerMeasurements, navigationBoundries, scrollPosition)\n    );\n  } else {\n    return (\n      isAtScrollEndX(\n        scrollerMeasurements,\n        navigationBoundries,\n        scrollPosition,\n      ) &&\n      isAtScrollEndY(scrollerMeasurements, navigationBoundries, scrollPosition)\n    );\n  }\n}\n\nexport function isAtStart(\n  isRTL: boolean,\n  scrollerMeasurements: Measurements,\n  navigationBoundries: Measurements,\n  scrollPosition: ScrollPosition,\n) {\n  if (isRTL) {\n    return (\n      isAtScrollEndX(\n        scrollerMeasurements,\n        navigationBoundries,\n        scrollPosition,\n      ) && isAtScrollStartY(scrollPosition)\n    );\n  } else {\n    return isAtScrollStartX(scrollPosition) && isAtScrollStartY(scrollPosition);\n  }\n}\n\nexport function isAtScrollStartX(scrollPosition: ScrollPosition) {\n  return scrollPosition.x === 0;\n}\nexport function isAtScrollStartY(scrollPosition: ScrollPosition) {\n  return scrollPosition.y === 0;\n}\n\nexport function isAtScrollEndX(\n  scrollerMeasurements: Measurements,\n  navigationBoundries: Measurements,\n  scrollPosition: ScrollPosition,\n) {\n  return (\n    navigationBoundries.height != 0 && scrollPosition.x >= navigationBoundries!.width - scrollerMeasurements!.width\n  );\n}\n\nexport function isAtScrollEndY(\n  scrollerMeasurements: Measurements,\n  navigationBoundries: Measurements,\n  scrollPosition: ScrollPosition,\n) {\n  return (\n    scrollPosition.y >=\n    navigationBoundries!.height - scrollerMeasurements!.height\n  );\n}\n\nexport function isAtScrollEndWithPadding(\n  isRTL: boolean,\n  scrollerMeasurements: Measurements,\n  navigationBoundaries: Measurements,\n  scrollPosition: ScrollPosition,\n  padding: number,\n) {\n  const paddedScrollPosition = {\n    x: scrollPosition.x + padding,\n    y: scrollPosition.y + padding,\n  };\n  return isAtScrollEnd(\n    isRTL,\n    scrollerMeasurements,\n    navigationBoundaries,\n    paddedScrollPosition,\n  );\n}\n\nexport function reachedToNeedMoreItems(\n  isRTL: boolean,\n  scrollerMeasurements: Measurements,\n  navigationBoundries: Measurements,\n  scrollPosition: ScrollPosition,\n) {\n  // should return true if the scroll in the gallery reached the threshold to load more items (considering the padding)\n  return isAtScrollEndWithPadding(\n    isRTL,\n    scrollerMeasurements,\n    navigationBoundries,\n    scrollPosition,\n    NeedMoreItemsPaddingSize,\n  );\n}\n\nexport function getScrollPositionFromEvent(event: Event): ScrollPosition {\n  let target;\n  if (event.target === document && event.bubbles) {\n    //scrolling through window\n    // @ts-ignore\n    target = event.srcElement.scrollingElement;\n  } else {\n    // scrolling through a div\n    target = event.target as HTMLElement;\n  }\n  return { x: target.scrollLeft, y: target.scrollTop };\n}\n\nexport function isItemCenteredX(\n  itemMeasurements: Measurements,\n  centerX: number,\n): boolean {\n  const itemLeft = itemMeasurements.left;\n  const itemRight = itemMeasurements.left + itemMeasurements.width;\n  return itemLeft < centerX && itemRight > centerX;\n}\n\nexport function isItemCenteredY(\n  itemMeasurements: Measurements,\n  centerY: number,\n): boolean {\n  const itemTop = itemMeasurements.top;\n  const itemBottom = itemMeasurements.top + itemMeasurements.height;\n  return itemTop < centerY && itemBottom > centerY;\n}\n\nexport function isItemCenteredBothAxes(\n  itemMeasurements: Measurements,\n  centerX: number,\n  centerY: number,\n): boolean {\n  return (\n    isItemCenteredX(itemMeasurements, centerX) &&\n    isItemCenteredY(itemMeasurements, centerY)\n  );\n}\n"],"mappings":"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","ignoreList":[]}
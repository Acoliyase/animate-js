"use strict";

exports.__esModule = true;
exports.useArrowsNavigation = void 0;
var _react = require("react");
function getDirection(event) {
  switch (event.key) {
    case 'ArrowLeft':
      return 'left';
    case 'ArrowRight':
      return 'right';
    case 'ArrowUp':
      return 'up';
    case 'ArrowDown':
      return 'down';
    default:
      return null;
  }
}
const useArrowsNavigation = (navigator, isAccessible) => {
  const itemRefs = (0, _react.useRef)({});
  const handleKeyDown = (0, _react.useCallback)(event => {
    try {
      if (!navigator) {
        return;
      }

      // Get current index directly from navigator to avoid stale closure issues
      const currentIndex = navigator.getCurrentIndex();
      if (currentIndex === null || currentIndex === undefined) {
        return;
      }
      const direction = getDirection(event);
      if (direction === null) {
        return;
      }
      event.preventDefault();
      const navigationApi = navigator.getNavigationApi();
      const nextIndex = navigationApi.getNextItemByDirection(currentIndex, direction);
      if (nextIndex === null) {
        return;
      }
      navigator.setCurrentItem(nextIndex);
      const nextItemElement = itemRefs.current[nextIndex];
      if (nextItemElement && nextItemElement.focus) {
        nextItemElement.focus();
      }
    } catch (error) {
      console.error('Navigation error:', error);
    }
  }, [navigator] // Remove currentIndex from dependencies since we get it from navigator
  );

  // On mount, focus on the first item if accessibility is enabled
  (0, _react.useEffect)(() => {
    if (navigator === null || !isAccessible) {
      return;
    }
    navigator.focusOnFirstItem();
  }, [navigator, isAccessible]);
  const registerItemRef = (0, _react.useCallback)((index, element) => {
    itemRefs.current[index] = element;
  }, []);

  // Cleanup function to remove all references
  const cleanupRefs = (0, _react.useCallback)(() => {
    itemRefs.current = {};
  }, []);
  return {
    handleKeyDown,
    registerItemRef,
    cleanupRefs
  };
};
exports.useArrowsNavigation = useArrowsNavigation;
//# sourceMappingURL=useArrowNavigation.js.map
{"version":3,"names":["_react","require","getDirection","event","key","useArrowsNavigation","navigator","isAccessible","itemRefs","useRef","handleKeyDown","useCallback","currentIndex","getCurrentIndex","undefined","direction","preventDefault","navigationApi","getNavigationApi","nextIndex","getNextItemByDirection","setCurrentItem","nextItemElement","current","focus","error","console","useEffect","focusOnFirstItem","registerItemRef","index","element","cleanupRefs","exports"],"sources":["../../../../src/components/hooks/useArrowNavigation.ts"],"sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\nimport { Direction, INavigator } from '../../navigator';\n\nfunction getDirection(event: KeyboardEvent): Direction | null {\n  switch (event.key) {\n    case 'ArrowLeft':\n      return 'left';\n    case 'ArrowRight':\n      return 'right';\n    case 'ArrowUp':\n      return 'up';\n    case 'ArrowDown':\n      return 'down';\n    default:\n      return null;\n  }\n}\n\nexport const useArrowsNavigation = (\n  navigator: INavigator | null,\n  isAccessible: boolean,\n) => {\n  const itemRefs = useRef<{ [key: number]: HTMLDivElement | null }>({});\n\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      try {\n        if (!navigator) {\n          return;\n        }\n\n        // Get current index directly from navigator to avoid stale closure issues\n        const currentIndex = navigator.getCurrentIndex();\n        if (currentIndex === null || currentIndex === undefined) {\n          return;\n        }\n\n        const direction = getDirection(event);\n        if (direction === null) {\n          return;\n        }\n\n        event.preventDefault();\n\n        const navigationApi = navigator.getNavigationApi();\n        const nextIndex = navigationApi.getNextItemByDirection(\n          currentIndex,\n          direction,\n        );\n        if (nextIndex === null) {\n          return;\n        }\n\n        navigator.setCurrentItem(nextIndex);\n\n        const nextItemElement = itemRefs.current[nextIndex];\n        if (nextItemElement && nextItemElement.focus) {\n          nextItemElement.focus();\n        }\n      } catch (error) {\n        console.error('Navigation error:', error);\n      }\n    },\n    [navigator], // Remove currentIndex from dependencies since we get it from navigator\n  );\n\n  // On mount, focus on the first item if accessibility is enabled\n  useEffect(() => {\n    if (navigator === null || !isAccessible) {\n      return;\n    }\n    navigator.focusOnFirstItem();\n  }, [navigator, isAccessible]);\n\n  const registerItemRef = useCallback(\n    (index: number, element: HTMLDivElement | null) => {\n      itemRefs.current[index] = element;\n    },\n    [],\n  );\n\n  // Cleanup function to remove all references\n  const cleanupRefs = useCallback(() => {\n    itemRefs.current = {};\n  }, []);\n\n  return {\n    handleKeyDown,\n    registerItemRef,\n    cleanupRefs,\n  };\n};\n"],"mappings":";;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAGA,SAASC,YAAYA,CAACC,KAAoB,EAAoB;EAC5D,QAAQA,KAAK,CAACC,GAAG;IACf,KAAK,WAAW;MACd,OAAO,MAAM;IACf,KAAK,YAAY;MACf,OAAO,OAAO;IAChB,KAAK,SAAS;MACZ,OAAO,IAAI;IACb,KAAK,WAAW;MACd,OAAO,MAAM;IACf;MACE,OAAO,IAAI;EACf;AACF;AAEO,MAAMC,mBAAmB,GAAGA,CACjCC,SAA4B,EAC5BC,YAAqB,KAClB;EACH,MAAMC,QAAQ,GAAG,IAAAC,aAAM,EAA2C,CAAC,CAAC,CAAC;EAErE,MAAMC,aAAa,GAAG,IAAAC,kBAAW,EAC9BR,KAAoB,IAAK;IACxB,IAAI;MACF,IAAI,CAACG,SAAS,EAAE;QACd;MACF;;MAEA;MACA,MAAMM,YAAY,GAAGN,SAAS,CAACO,eAAe,CAAC,CAAC;MAChD,IAAID,YAAY,KAAK,IAAI,IAAIA,YAAY,KAAKE,SAAS,EAAE;QACvD;MACF;MAEA,MAAMC,SAAS,GAAGb,YAAY,CAACC,KAAK,CAAC;MACrC,IAAIY,SAAS,KAAK,IAAI,EAAE;QACtB;MACF;MAEAZ,KAAK,CAACa,cAAc,CAAC,CAAC;MAEtB,MAAMC,aAAa,GAAGX,SAAS,CAACY,gBAAgB,CAAC,CAAC;MAClD,MAAMC,SAAS,GAAGF,aAAa,CAACG,sBAAsB,CACpDR,YAAY,EACZG,SACF,CAAC;MACD,IAAII,SAAS,KAAK,IAAI,EAAE;QACtB;MACF;MAEAb,SAAS,CAACe,cAAc,CAACF,SAAS,CAAC;MAEnC,MAAMG,eAAe,GAAGd,QAAQ,CAACe,OAAO,CAACJ,SAAS,CAAC;MACnD,IAAIG,eAAe,IAAIA,eAAe,CAACE,KAAK,EAAE;QAC5CF,eAAe,CAACE,KAAK,CAAC,CAAC;MACzB;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,mBAAmB,EAAEA,KAAK,CAAC;IAC3C;EACF,CAAC,EACD,CAACnB,SAAS,CAAC,CAAE;EACf,CAAC;;EAED;EACA,IAAAqB,gBAAS,EAAC,MAAM;IACd,IAAIrB,SAAS,KAAK,IAAI,IAAI,CAACC,YAAY,EAAE;MACvC;IACF;IACAD,SAAS,CAACsB,gBAAgB,CAAC,CAAC;EAC9B,CAAC,EAAE,CAACtB,SAAS,EAAEC,YAAY,CAAC,CAAC;EAE7B,MAAMsB,eAAe,GAAG,IAAAlB,kBAAW,EACjC,CAACmB,KAAa,EAAEC,OAA8B,KAAK;IACjDvB,QAAQ,CAACe,OAAO,CAACO,KAAK,CAAC,GAAGC,OAAO;EACnC,CAAC,EACD,EACF,CAAC;;EAED;EACA,MAAMC,WAAW,GAAG,IAAArB,kBAAW,EAAC,MAAM;IACpCH,QAAQ,CAACe,OAAO,GAAG,CAAC,CAAC;EACvB,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACLb,aAAa;IACbmB,eAAe;IACfG;EACF,CAAC;AACH,CAAC;AAACC,OAAA,CAAA5B,mBAAA,GAAAA,mBAAA","ignoreList":[]}
{"version":3,"names":["_react","_interopRequireWildcard","require","_clsx","_interopRequireDefault","_navigator","_Item","_lib","_generalConstants","_GalleryModule","_useArrowNavigation","_jsxFileName","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","Gallery","dataList","selectors","gallerySelectors","customRenderers","eventsListener","createResizedMediaUrl","options","disableContextMenu","isAccessible","wrapperRef","getItemCustomAttributes","navigator","setNavigator","useState","scrollerRef","useRef","defaultScrollerWrapperRef","scrollerWrapperRef","containerRef","currentIndex","setCurrentIndex","handleKeyDown","registerItemRef","useArrowsNavigation","isInHover","setIsInHover","currentHoveredIndex","setCurrentHoveredIndex","defaultGallerySelectors","galleryEventsListener","makeEventsListener","CURRENT_ITEM_CHANGED","eventData","index","HOVER_SET","done","useEffect","loadNavigator","Navigator","Promise","resolve","then","initSettings","setScrollerRef","setWrapperRef","setContainerRef","updateTotalItemsCount","scrollerElement","current","addEventListener","removeScrollerRef","removeWrapperRef","removeContainerRef","removeEventListener","handleScrollerMeasure","newMeasurements","updateScrollerMeasurements","handleWrapperMeasure","updateWrapperMeasurements","handleContainerMeasure","updateContainerMeasurements","handleItemMeasure","itemRef","updateItemMeasurements","useMeasure","callback","measurements","ref","onMouseEnter","_containerRef$current","classList","add","hoverClasses","containerHover","onMouseLeave","_containerRef$current2","remove","onContainerFocus","_containerRef$current3","onContainerBlur","_containerRef$current4","createElement","id","className","classNames","s","scroller","hover","__self","__source","fileName","lineNumber","columnNumber","container","role","onFocus","onBlur","tabIndex","map","data","key","onMeasure","activeIndex","isCurrentlyHovered","_default","exports"],"sources":["../../../../src/components/gallery/Gallery.tsx"],"sourcesContent":["import React, { useRef, useEffect, useState, RefObject } from 'react';\nimport classNames from 'clsx';\nimport { INavigator, Measurements, useMeasure } from '../../navigator';\nimport Item from '../item/Item';\nimport {\n  makeEventsListener,\n  EventData,\n  EventsListenerFunction,\n  GallerySelectors,\n  ItemContentData,\n  GalleryOptions,\n  ResizeMediaParams,\n  ResizedImageSource,\n} from '../../lib';\nimport { CustomGalleryRenderers, ItemCustomAttributesFunction } from '../types';\nimport { defaultGallerySelectors, hoverClasses } from '../generalConstants';\nimport s from './Gallery.module.scss';\nimport { useArrowsNavigation } from '../hooks/useArrowNavigation';\n\nexport interface GalleryProps {\n  dataList: ItemContentData[];\n  selectors?: GallerySelectors;\n  customRenderers?: CustomGalleryRenderers;\n  createResizedMediaUrl?: (\n    params: ResizeMediaParams,\n  ) => string | [ResizedImageSource];\n  eventsListener?: EventsListenerFunction;\n  options?: GalleryOptions;\n  totalItemsCount?: number;\n  isAccessible?: boolean;\n  wrapperRef?: RefObject<Window>;\n  getItemCustomAttributes?: ItemCustomAttributesFunction;\n}\n\nconst Gallery: React.FC<GalleryProps> = ({\n  dataList,\n  selectors: gallerySelectors,\n  customRenderers,\n  eventsListener = () => {},\n  createResizedMediaUrl,\n  options = { disableContextMenu: true },\n  isAccessible = false,\n  wrapperRef,\n  getItemCustomAttributes,\n}) => {\n  const [navigator, setNavigator] = useState<INavigator | null>(null);\n  const scrollerRef = useRef<HTMLDivElement>(null);\n  const defaultScrollerWrapperRef = useRef<Window>(null);\n  const scrollerWrapperRef = wrapperRef\n    ? wrapperRef\n    : defaultScrollerWrapperRef;\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [currentIndex, setCurrentIndex] = useState<any>(0);\n  const { handleKeyDown, registerItemRef } = useArrowsNavigation(\n    navigator,\n    isAccessible,\n  );\n  const [isInHover, setIsInHover] = useState<boolean>(false);\n  const [currentHoveredIndex, setCurrentHoveredIndex] = useState<number>(-1);\n  const selectors = {\n    ...defaultGallerySelectors,\n    ...gallerySelectors,\n  };\n  const galleryEventsListener = makeEventsListener()\n    .CURRENT_ITEM_CHANGED((eventData: EventData) => {\n      setCurrentIndex(eventData.index);\n    })\n    .HOVER_SET((eventData: EventData) => {\n      setCurrentHoveredIndex(eventData.index ?? -1);\n    })\n    .done(eventsListener);\n\n  useEffect(() => {\n    const loadNavigator = async () => {\n      const { Navigator } = await import(\n        /* webpackChunkName: \"Navigator\" */\n        '../../navigator'\n      );\n      setNavigator(\n        new Navigator({\n          initSettings: {},\n          eventsListener: galleryEventsListener,\n        }),\n      );\n    };\n\n    loadNavigator();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (navigator === null) {\n      return;\n    }\n    navigator.setScrollerRef(scrollerRef);\n    navigator.setWrapperRef(wrapperRef);\n    navigator.setContainerRef(containerRef);\n    navigator.updateTotalItemsCount(5);\n\n    const scrollerElement = scrollerRef.current;\n    if (scrollerElement) {\n      scrollerElement.addEventListener('keydown', handleKeyDown);\n    }\n\n    return () => {\n      if (navigator === null) {\n        return;\n      }\n      navigator.removeScrollerRef(scrollerRef);\n      navigator.removeWrapperRef(wrapperRef);\n      navigator.removeContainerRef(containerRef);\n\n      if (scrollerElement) {\n        scrollerElement.removeEventListener('keydown', handleKeyDown);\n      }\n    };\n  }, [navigator, scrollerRef, wrapperRef, handleKeyDown]);\n\n  const handleScrollerMeasure = (newMeasurements: Measurements) => {\n    navigator?.updateScrollerMeasurements(newMeasurements);\n  };\n  const handleWrapperMeasure = (newMeasurements: Measurements) => {\n    navigator?.updateWrapperMeasurements(newMeasurements);\n  };\n  const handleContainerMeasure = (newMeasurements: Measurements) => {\n    navigator?.updateContainerMeasurements(newMeasurements);\n  };\n  const handleItemMeasure = (\n    index: number,\n    newMeasurements: Measurements,\n    itemRef: React.RefObject<HTMLDivElement>,\n  ) => {\n    navigator?.updateItemMeasurements(newMeasurements, index, itemRef);\n  };\n\n  useMeasure({\n    callback: (measurements: any) => handleScrollerMeasure(measurements),\n    ref: scrollerRef,\n  });\n  useMeasure({\n    callback: (measurements: any) => handleWrapperMeasure(measurements),\n    ref: scrollerWrapperRef,\n  });\n  useMeasure({\n    callback: (measurements: any) => handleContainerMeasure(measurements),\n    ref: containerRef,\n  });\n\n  const onMouseEnter = () => {\n    // the commented code is copied from pro-gallery and is not used in this component currently\n    // if (\n    //   this.currentScrollData?.isContinuousScrolling &&\n    //   this.state.options[optionsMap.behaviourParams.gallery.horizontal.autoSlide.pauseOnHover]\n    // ) {\n    //   haltScroll(this.currentScrollData);\n    // }\n    setIsInHover(true);\n    containerRef.current?.classList.add(hoverClasses.containerHover);\n  };\n\n  const onMouseLeave = () => {\n    setIsInHover(false);\n    containerRef.current?.classList.remove(hoverClasses.containerHover);\n  };\n\n  const onContainerFocus = () => {\n    setIsInHover(true);\n    containerRef.current?.classList.add(hoverClasses.containerHover);\n  };\n\n  const onContainerBlur = () => {\n    setIsInHover(false);\n    containerRef.current?.classList.remove(hoverClasses.containerHover);\n  };\n\n  return (\n    <div\n      ref={scrollerRef}\n      id=\"scroller\"\n      className={classNames(\n        s.scroller,\n        'scroller',\n        selectors?.scroller,\n        isInHover && s.hover,\n      )}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n    >\n      <div\n        ref={containerRef}\n        className={classNames(\n          s.container,\n          selectors?.container,\n          isInHover ? 'container-hover' : '',\n        )}\n        role=\"list\"\n        onFocus={onContainerFocus}\n        onBlur={onContainerBlur}\n        tabIndex={isAccessible ? 0 : -1}\n      >\n        {dataList.map((data, index) => (\n          <Item\n            getItemCustomAttributes={getItemCustomAttributes}\n            key={data.id}\n            index={index}\n            data={data}\n            selectors={selectors}\n            customRenderers={customRenderers}\n            eventsListener={galleryEventsListener}\n            createResizedMediaUrl={createResizedMediaUrl}\n            onMeasure={handleItemMeasure}\n            activeIndex={currentIndex}\n            isCurrentlyHovered={index === currentHoveredIndex}\n            options={options}\n            isAccessible={isAccessible}\n            registerItemRef={registerItemRef}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default Gallery;\n"],"mappings":"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","ignoreList":[]}
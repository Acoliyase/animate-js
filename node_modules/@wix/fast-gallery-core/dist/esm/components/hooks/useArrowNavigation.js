import { useCallback, useEffect, useRef } from 'react';
function getDirection(event) {
    switch (event.key) {
        case 'ArrowLeft':
            return 'left';
        case 'ArrowRight':
            return 'right';
        case 'ArrowUp':
            return 'up';
        case 'ArrowDown':
            return 'down';
        default:
            return null;
    }
}
export const useArrowsNavigation = (navigator, isAccessible) => {
    const itemRefs = useRef({});
    const handleKeyDown = useCallback((event) => {
        try {
            if (!navigator) {
                return;
            }
            // Get current index directly from navigator to avoid stale closure issues
            const currentIndex = navigator.getCurrentIndex();
            if (currentIndex === null || currentIndex === undefined) {
                return;
            }
            const direction = getDirection(event);
            if (direction === null) {
                return;
            }
            event.preventDefault();
            const navigationApi = navigator.getNavigationApi();
            const nextIndex = navigationApi.getNextItemByDirection(currentIndex, direction);
            if (nextIndex === null) {
                return;
            }
            navigator.setCurrentItem(nextIndex);
            const nextItemElement = itemRefs.current[nextIndex];
            if (nextItemElement && nextItemElement.focus) {
                nextItemElement.focus();
            }
        }
        catch (error) {
            console.error('Navigation error:', error);
        }
    }, [navigator]);
    // On mount, focus on the first item if accessibility is enabled
    useEffect(() => {
        if (navigator === null || !isAccessible) {
            return;
        }
        navigator.focusOnFirstItem();
    }, [navigator, isAccessible]);
    const registerItemRef = useCallback((index, element) => {
        itemRefs.current[index] = element;
    }, []);
    // Cleanup function to remove all references
    const cleanupRefs = useCallback(() => {
        itemRefs.current = {};
    }, []);
    return {
        handleKeyDown,
        registerItemRef,
        cleanupRefs,
    };
};
//# sourceMappingURL=useArrowNavigation.js.map
{"version":3,"names":["_monitoringVelo","require","_headers","_authUtils","createHostModule","__type","create","host","essentials","passThroughHeaders","getPassThroughHeaders","language","_window$essentials","window","locale","_window$essentials2","timezone","_window$essentials3","timeZone","getMonitoringClient","producer","req","document","location","href","Request","createVeloMonitoringClient","namespace","getAuthToken","resolveAuthToken","exports"],"sources":["../../src/host-module.ts"],"sourcesContent":["import type { HostModule, Host } from '@wix/sdk-types';\nimport { createVeloMonitoringClient } from '@wix/monitoring-velo';\nimport { getPassThroughHeaders } from './headers';\nimport { resolveAuthToken } from './utils/auth-utils';\nimport type { SDK, SDKOptions } from './types';\n\nexport const createHostModule = (): HostModule<SDK, Host> & {\n  host: (options: SDKOptions) => Host;\n} => {\n  return {\n    __type: 'host',\n    create: () => {\n      return {};\n    },\n    host: ({ essentials }: SDKOptions = {}) => {\n      return {\n        essentials: {\n          get passThroughHeaders() {\n            return getPassThroughHeaders();\n          },\n          get language() {\n            return essentials?.language ?? window.essentials?.language ?? 'en';\n          },\n          get locale() {\n            return essentials?.locale ?? window.essentials?.locale ?? 'en-US';\n          },\n          get timezone() {\n            return essentials?.timezone ?? window.essentials?.timeZone ?? 'UTC';\n          },\n        },\n        getMonitoringClient: () => {\n          let producer = 'unknown';\n          let req: Request | undefined;\n\n          if (typeof document !== 'undefined') {\n            producer = document.location.href;\n            req = new Request(document.location.href);\n          }\n\n          return createVeloMonitoringClient({\n            namespace: 'Headless',\n            producer,\n            getAuthToken: async () => resolveAuthToken(),\n            req,\n          });\n        },\n      };\n    },\n  };\n};\n"],"mappings":";;;;AACA,IAAAA,eAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AAGO,MAAMG,gBAAgB,GAAGA,CAAA,KAE3B;EACH,OAAO;IACLC,MAAM,EAAE,MAAM;IACdC,MAAM,EAAEA,CAAA,KAAM;MACZ,OAAO,CAAC,CAAC;IACX,CAAC;IACDC,IAAI,EAAEA,CAAC;MAAEC;IAAuB,CAAC,GAAG,CAAC,CAAC,KAAK;MACzC,OAAO;QACLA,UAAU,EAAE;UACV,IAAIC,kBAAkBA,CAAA,EAAG;YACvB,OAAO,IAAAC,8BAAqB,EAAC,CAAC;UAChC,CAAC;UACD,IAAIC,QAAQA,CAAA,EAAG;YAAA,IAAAC,kBAAA;YACb,OAAO,CAAAJ,UAAU,oBAAVA,UAAU,CAAEG,QAAQ,OAAAC,kBAAA,GAAIC,MAAM,CAACL,UAAU,qBAAjBI,kBAAA,CAAmBD,QAAQ,KAAI,IAAI;UACpE,CAAC;UACD,IAAIG,MAAMA,CAAA,EAAG;YAAA,IAAAC,mBAAA;YACX,OAAO,CAAAP,UAAU,oBAAVA,UAAU,CAAEM,MAAM,OAAAC,mBAAA,GAAIF,MAAM,CAACL,UAAU,qBAAjBO,mBAAA,CAAmBD,MAAM,KAAI,OAAO;UACnE,CAAC;UACD,IAAIE,QAAQA,CAAA,EAAG;YAAA,IAAAC,mBAAA;YACb,OAAO,CAAAT,UAAU,oBAAVA,UAAU,CAAEQ,QAAQ,OAAAC,mBAAA,GAAIJ,MAAM,CAACL,UAAU,qBAAjBS,mBAAA,CAAmBC,QAAQ,KAAI,KAAK;UACrE;QACF,CAAC;QACDC,mBAAmB,EAAEA,CAAA,KAAM;UACzB,IAAIC,QAAQ,GAAG,SAAS;UACxB,IAAIC,GAAwB;UAE5B,IAAI,OAAOC,QAAQ,KAAK,WAAW,EAAE;YACnCF,QAAQ,GAAGE,QAAQ,CAACC,QAAQ,CAACC,IAAI;YACjCH,GAAG,GAAG,IAAII,OAAO,CAACH,QAAQ,CAACC,QAAQ,CAACC,IAAI,CAAC;UAC3C;UAEA,OAAO,IAAAE,0CAA0B,EAAC;YAChCC,SAAS,EAAE,UAAU;YACrBP,QAAQ;YACRQ,YAAY,EAAE,MAAAA,CAAA,KAAY,IAAAC,2BAAgB,EAAC,CAAC;YAC5CR;UACF,CAAC,CAAC;QACJ;MACF,CAAC;IACH;EACF,CAAC;AACH,CAAC;AAACS,OAAA,CAAA1B,gBAAA,GAAAA,gBAAA","ignoreList":[]}
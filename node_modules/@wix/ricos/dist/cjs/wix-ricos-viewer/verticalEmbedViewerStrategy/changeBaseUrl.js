"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var changeBaseUrl_exports = {};
__export(changeBaseUrl_exports, {
  changeBaseUrl: () => changeBaseUrl
});
module.exports = __toCommonJS(changeBaseUrl_exports);
const storesPath = "/product-page/";
const storesPath2 = "/stores/";
const bookingsPath = "/bookings-checkout/";
const bookingsPath2 = "/service-page/";
const eventsPath = "/event-details/";
const eventsPath2 = "/events/";
const eventsPath3 = "/event-details-registration/";
const UNIVERSAL_DELIMITER = "?d=";
const UNIVERSAL_REGEX = /^https:\/\/www.wix.app/;
const getWebUrlFromUniversalUrl = (url) => url.split(UNIVERSAL_DELIMITER)[1];
const getVerticalRelativePath = (webUrl) => {
  const position = Math.max(
    webUrl.indexOf(storesPath),
    webUrl.indexOf(storesPath2),
    webUrl.indexOf(bookingsPath),
    webUrl.indexOf(bookingsPath2),
    webUrl.indexOf(eventsPath),
    webUrl.indexOf(eventsPath2),
    webUrl.indexOf(eventsPath3)
  );
  return position >= 0 ? webUrl.slice(position) : void 0;
};
const removeLastSlashFromUrl = (url) => url.replace(/\/$/, "");
const replaceWebUrlInsideUniversalUrl = (universalUrl, webUrl) => {
  const base = universalUrl.split(UNIVERSAL_DELIMITER)[0];
  return `${base}${UNIVERSAL_DELIMITER}${webUrl}`;
};
const changeBaseUrl = (url, baseUrl) => {
  const isUniversalUrl = url.match(UNIVERSAL_REGEX);
  const oldWebUrl = isUniversalUrl ? getWebUrlFromUniversalUrl(url) : url;
  const path = getVerticalRelativePath(oldWebUrl);
  const webUrl = path !== void 0 ? removeLastSlashFromUrl(baseUrl) + path : oldWebUrl;
  return isUniversalUrl ? replaceWebUrlInsideUniversalUrl(url, webUrl) : webUrl;
};
//# sourceMappingURL=changeBaseUrl.js.map

{"version":3,"names":["React","useCallback","useActionsSDK","MultiBulkActionToolbar","bulkDeleteAction","customAction","resolveAction","groupActions","useBulkActionToolbar","_ref","config","collectionId","sdk","bulkActionToolbar","param","buildAction","actionConfig","actionToResolve","baseParams","actionParams","type","action","resolvedAction","icon","resolvedActionParams","prefixIcon","isValidElement","undefined","dataHook","id","buildPrimaryActions","primaryActions","map","primaryItem","index","item","actionGroups","menu","items","subItems","group","filter","Boolean","length","label","primaryActionItems","secondaryActionItems","secondaryActions","createElement","hasPrimaryActions","hasSecondaryActions"],"sources":["../../../src/hooks/useBulkActionToolbar.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport {\n  BulkActionItemConfig,\n  BulkActionsConfig,\n  ResolvedAction,\n} from '../types';\nimport { useActionsSDK } from './useActionsSDK';\nimport {\n  TableProps,\n  MultiBulkActionToolbar,\n  ActionSubitem,\n} from '@wix/patterns';\nimport {\n  bulkDeleteAction,\n  customAction,\n  resolveAction,\n  groupActions,\n} from '../utils/actions';\n\nexport type BulkActionToolbarRenderProp = Parameters<\n  NonNullable<TableProps<any, any>['bulkActionToolbar']>\n>[0];\n\nexport interface useBulkActionToolbarParams {\n  config?: BulkActionsConfig;\n  collectionId: string;\n}\n\nexport const useBulkActionToolbar = ({\n  config,\n  collectionId,\n}: useBulkActionToolbarParams) => {\n  const sdk = useActionsSDK({\n    collectionId,\n  });\n\n  const bulkActionToolbar = useCallback(\n    (param: BulkActionToolbarRenderProp) => {\n      const buildAction = (\n        actionConfig: BulkActionItemConfig,\n      ): ActionSubitem | null => {\n        let actionToResolve: Partial<ResolvedAction> | null = null;\n\n        const baseParams = {\n          actionParams: param,\n          sdk,\n        };\n\n        switch (actionConfig.type) {\n          case 'bulkDelete':\n            actionToResolve = bulkDeleteAction({\n              action: actionConfig,\n              ...baseParams,\n            });\n            break;\n\n          case 'custom':\n            actionToResolve = customAction({\n              action: actionConfig,\n              ...baseParams,\n            });\n            break;\n\n          default:\n            return null;\n        }\n\n        if (!actionToResolve) {\n          return null;\n        }\n\n        const resolvedAction = resolveAction(actionConfig, actionToResolve);\n        const { icon, ...resolvedActionParams } = resolvedAction;\n\n        return {\n          prefixIcon: React.isValidElement(icon) ? icon : undefined,\n          dataHook: actionConfig.id,\n          ...resolvedActionParams,\n        };\n      };\n\n      const buildPrimaryActions = (): ActionSubitem[] => {\n        if (!config?.primaryActions) {\n          return [];\n        }\n\n        return config.primaryActions\n          .map((primaryItem, index) => {\n            if (primaryItem.type === 'action') {\n              return buildAction(primaryItem.action.item);\n            }\n\n            if (primaryItem.type === 'menu') {\n              const actionGroups = groupActions(primaryItem.menu.items);\n              const subItems = actionGroups\n                .map((group) =>\n                  group\n                    .map(buildAction)\n                    .filter((action): action is ActionSubitem =>\n                      Boolean(action),\n                    ),\n                )\n                .filter((group) => group.length > 0);\n\n              if (subItems.length === 0) {\n                return null;\n              }\n\n              return {\n                label: primaryItem.menu.label,\n                subItems,\n                dataHook: `bulk-multi-action-${index}`,\n              };\n            }\n\n            return null;\n          })\n          .filter((action): action is ActionSubitem => Boolean(action));\n      };\n\n      const primaryActionItems = buildPrimaryActions();\n\n      const secondaryActionItems = config?.secondaryActions\n        ? groupActions(config.secondaryActions)\n            .map((group) =>\n              group\n                .map(buildAction)\n                .filter((action): action is ActionSubitem => Boolean(action)),\n            )\n            .filter((group) => group.length > 0)\n        : [];\n\n      return (\n        <MultiBulkActionToolbar\n          primaryActionItems={primaryActionItems}\n          secondaryActionItems={secondaryActionItems}\n        />\n      );\n    },\n    [config, sdk],\n  );\n\n  if (!config) {\n    return undefined;\n  }\n\n  const hasPrimaryActions =\n    config.primaryActions && config.primaryActions.length > 0;\n\n  const hasSecondaryActions =\n    config.secondaryActions && config.secondaryActions.length > 0;\n\n  if (!hasPrimaryActions && !hasSecondaryActions) {\n    return undefined;\n  }\n\n  return bulkActionToolbar;\n};\n"],"mappings":"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","ignoreList":[]}
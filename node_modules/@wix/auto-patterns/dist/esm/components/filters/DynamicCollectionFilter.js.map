{"version":3,"names":["React","useFilterCollection","useSchemaRegistry","fetchCmsData","DynamicCollectionFilter","_ref","filter","collectionId","component","FilterComponent","filterProps","getSchema","referencedSchema","fetchData","useCallback","query","items","total","result","fields","searchableFieldIds","displayField","filterFieldMapping","map","item","id","idField","name","collection","queryName","createElement","_extends"],"sources":["../../../../src/components/filters/DynamicCollectionFilter.tsx"],"sourcesContent":["import React from 'react';\nimport { Filter, useFilterCollection } from '@wix/patterns';\nimport { useSchemaRegistry } from '../../providers';\nimport { fetchCmsData } from '../../dataSourceAdapters/cms/fetchCmsData';\n\ninterface DynamicCollectionFilterProps {\n  filter: Filter<any>;\n  collectionId: string;\n  component: React.ElementType;\n  componentName?: string;\n  [key: string]: any;\n}\n\nexport const DynamicCollectionFilter: React.FC<\n  DynamicCollectionFilterProps\n> = ({ filter, collectionId, component: FilterComponent, ...filterProps }) => {\n  const { getSchema } = useSchemaRegistry();\n  const referencedSchema = getSchema(collectionId);\n\n  const fetchData = React.useCallback(\n    async (query) => {\n      if (!referencedSchema) {\n        return { items: [], total: 0 };\n      }\n\n      const result = await fetchCmsData(\n        collectionId,\n        query,\n        referencedSchema.fields,\n        {\n          searchableFieldIds: [referencedSchema.displayField],\n          filterFieldMapping: {},\n        },\n      );\n\n      return {\n        items: result.items.map((item: any) => ({\n          id: item[referencedSchema.idField],\n          name: item[referencedSchema.displayField],\n        })),\n      };\n    },\n    [collectionId, referencedSchema],\n  );\n\n  const collection = useFilterCollection(filter, {\n    queryName: `filter-collection-${collectionId}`,\n    fetchData,\n  });\n\n  return (\n    <FilterComponent filter={filter} collection={collection} {...filterProps} />\n  );\n};\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAAiBC,mBAAmB,QAAQ,eAAe;AAC3D,SAASC,iBAAiB,QAAQ,iBAAiB;AACnD,SAASC,YAAY,QAAQ,2CAA2C;AAUxE,OAAO,MAAMC,uBAEZ,GAAGC,IAAA,IAA0E;EAAA,IAAzE;IAAEC,MAAM;IAAEC,YAAY;IAAEC,SAAS,EAAEC,eAAe;IAAE,GAAGC;EAAY,CAAC,GAAAL,IAAA;EACvE,MAAM;IAAEM;EAAU,CAAC,GAAGT,iBAAiB,CAAC,CAAC;EACzC,MAAMU,gBAAgB,GAAGD,SAAS,CAACJ,YAAY,CAAC;EAEhD,MAAMM,SAAS,GAAGb,KAAK,CAACc,WAAW,CACjC,MAAOC,KAAK,IAAK;IACf,IAAI,CAACH,gBAAgB,EAAE;MACrB,OAAO;QAAEI,KAAK,EAAE,EAAE;QAAEC,KAAK,EAAE;MAAE,CAAC;IAChC;IAEA,MAAMC,MAAM,GAAG,MAAMf,YAAY,CAC/BI,YAAY,EACZQ,KAAK,EACLH,gBAAgB,CAACO,MAAM,EACvB;MACEC,kBAAkB,EAAE,CAACR,gBAAgB,CAACS,YAAY,CAAC;MACnDC,kBAAkB,EAAE,CAAC;IACvB,CACF,CAAC;IAED,OAAO;MACLN,KAAK,EAAEE,MAAM,CAACF,KAAK,CAACO,GAAG,CAAEC,IAAS,KAAM;QACtCC,EAAE,EAAED,IAAI,CAACZ,gBAAgB,CAACc,OAAO,CAAC;QAClCC,IAAI,EAAEH,IAAI,CAACZ,gBAAgB,CAACS,YAAY;MAC1C,CAAC,CAAC;IACJ,CAAC;EACH,CAAC,EACD,CAACd,YAAY,EAAEK,gBAAgB,CACjC,CAAC;EAED,MAAMgB,UAAU,GAAG3B,mBAAmB,CAACK,MAAM,EAAE;IAC7CuB,SAAS,EAAE,qBAAqBtB,YAAY,EAAE;IAC9CM;EACF,CAAC,CAAC;EAEF,oBACEb,KAAA,CAAA8B,aAAA,CAACrB,eAAe,EAAAsB,QAAA;IAACzB,MAAM,EAAEA,MAAO;IAACsB,UAAU,EAAEA;EAAW,GAAKlB,WAAW,CAAG,CAAC;AAEhF,CAAC","ignoreList":[]}
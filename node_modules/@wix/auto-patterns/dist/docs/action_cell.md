## ActionCell Configuration

The ActionCell feature adds an interactive action column to collection tables or grid views, enabling users to perform operations on individual entities.

### Placement and Structure

The ActionCell has a two-level structure:
* `primaryAction`: A single prominent action shown directly in the table/grid row
* `secondaryActions`: Additional actions shown in a dropdown menu

Both properties are optional, but at least one should be provided for the ActionCell to be useful.

### Inline Secondary Actions

**New Feature**: By default, all secondary actions are hidden in a popover menu that appears when the user hovers over or clicks the "more actions" button. However, you can now configure some secondary actions to display inline directly in the table row for improved accessibility and reduced clicks.

### Action Types Reference

1. **Update Action** (`type: "update"`):
   - ✓ Use when: Editing entity fields or navigating to a detailed edit page
   - ✓ Common scenarios:
     - Full entity editing (use page mode)
   - ✓ Built-in functionality: No custom implementation needed

2. **Delete Action** (`type: "delete"`):
   - ✓ Use when: Removing entities with confirmation
   - ✓ Common scenarios:
     - Deleting records with confirmation
     - Soft-delete with status update
   - ✓ Built-in functionality: No custom implementation needed

3. **Custom Action** (`type: "custom"`):
   - ✓ Use when: Executing custom JavaScript without UI
   - ✓ Common scenarios:
     - API calls
     - Browser interactions (alerts, downloads)
     - Complex operations
   - ⚠️ Requires implementation: Must register action in overrides

### Action Appearance: The `skin` Property

All action types support the optional `skin` property to customize the visual appearance of action buttons. The skin determines the button's color scheme and visual emphasis.

#### Skin Values by Action Type:

**Primary Actions** support these skin values:
- `"standard"` - Default appearance (blue primary button)
- `"inverted"` - Inverted color scheme
- `"premium"` - Premium styling for premium features

**Secondary Actions** support these skin values:
- `"dark"` - Dark appearance
- `"destructive"` - Red appearance for dangerous actions (ideal for delete operations)
- `"premium"` - Premium styling for premium features

### Type Selection Decision Tree

When choosing an action type, follow this decision process:

1. IF editing entity fields:
   → Use `type: "update"`
   a. IF complex edits → Use `mode: "page"`

2. IF removing entities:
   → Use `type: "delete"`

3. IF executing custom logic without UI:
   → Use `type: "custom"`
   - MUST implement action handler
   - MUST register with `actions` override

### Update Action Configuration

Update actions edit entities by navigating to an entity page.

#### Validation Rules:

1. If `update.mode` is `"page"`:
   - `update.page` must exist
   - `update.page.id` must match an entity page ID in the configuration

### Delete Action Configuration

Delete actions remove entities with a confirmation modal.

#### Validation Rules:

1. `delete.mode` must be `"modal"` (currently only modal is supported)
2. `delete.modal` object must exist
3. The modal properties (title, description, actions, feedback) are all optional

### Custom Action Configuration

Custom actions execute JavaScript code that you define. These actions receive parameters that give them access to entity data and utilities. Here's how to implement a custom action:

1. First, create the actions folder structure in your page folder:
   ```
   your-page/
   ├── page.tsx
   └── components/
       └── actions/
           ├── index.tsx                    // Exports all actions
           └── downloadPetDetails.tsx       // Your custom action (name = action id)
   ```

2. Create your action handler in `downloadPetDetails.tsx` (note: the filename and function name MUST match your action id):
   ```typescript
   import { CustomActionCellActionResolver } from '@wix/auto-patterns';
   import { Download } from '@wix/wix-ui-icons-common';
   import React from 'react';

   // IMPORTANT: Function name MUST match the action id in your configuration
   export const downloadPetDetails: CustomActionCellActionResolver = (params) => {
     const { actionParams, sdk } = params;
     const { item } = actionParams;

     return {
       label: 'Download Details',
       icon: <Download />,
       onClick: () => {
         // sdk is provided to custom action resolvers (see SDK Utilities section)
         const optimisticActions = sdk.getOptimisticActions(sdk.collectionId);
         const schema = sdk.getSchema(sdk.collectionId);

         // Example: Mark pet as downloaded
         const updatedItem = { ...item, lastDownloaded: new Date() };
         optimisticActions.updateOne(updatedItem, {
           submit: async (items) => {
             // Your download logic here + update server
             return await schema.actions.update(items[0]);
           },
           successToast: 'Pet details downloaded',
           errorToast: (err, {retry}) => ({
             text: 'Download failed',
             action: { text: 'Retry', onClick: retry }
           })
         });
       },
     };
   };
   ```

3. Export your action in `actions/index.tsx`:
   ```typescript
   export * from './downloadPetDetails';
   ```

   **Important:** Every time you create a new action, you must add a corresponding export line to this `index.tsx` file. For example, if you create `sendEmail.tsx`, you must add `export * from './sendEmail';` to the index file.

4. Configure the action in your JSON configuration:
   ```ts
   {
     "id": "downloadPetDetails",        // MUST match the function name exactly
     "type": "custom",                  // REQUIRED: Must be exactly "custom"
     "label": "Download Details",       // Optional: Displayed text
   }
   ```

5. Register your action in the `PatternsWizardOverridesProvider`:
   ```typescript
   import * as actions from './components/actions';

   <PatternsWizardOverridesProvider value={{ actions }}>
     <AutoPatternsApp configuration={config as AppConfig} />
   </PatternsWizardOverridesProvider>
   ```

### Key Points for Custom Actions:
- The action `id` in the configuration MUST exactly match the function name exported from your actions folder
- The function name and file name should follow a consistent naming convention (e.g., camelCase)
- The implementation must be exported as a named export (not default export)
- The implementation must use the `CustomActionCellActionResolver` type

#### Validation Rules for Custom Actions:

1. `id` must:
   - Match exactly the function name of the custom action implementation
   - Be registered in the `actions` property of your `PatternsWizardOverridesProvider`
   - Follow JavaScript identifier naming rules (camelCase recommended)

2. The implementation must return an object with:
   - `label`: Text displayed for the action
   - `icon`: An Icon component from "@wix/wix-ui-icons-common"
   - `onClick`: Handler function for the action

3. The implementation must:
   - Use the correct type: `CustomActionCellActionResolver`
   - Be exported as a named export
   - Have a filename matching the function name

### Key Implementation Decisions

Follow this decision process when implementing ActionCell:

1. **Basic Decision**: Decide which actions users need to perform on entities:
   - Edit entities? → Use `update` actions
   - Delete entities? → Use `delete` actions
   - Custom operations? → Use `custom` actions

2. **Primary vs Secondary**: Choose the most common/important action as primary:
   - Most common operation (typically Edit) → Place in `primaryAction.item`
   - Less common operations → Place in `secondaryActions.items` array

3. **Inline Secondary Actions Strategy**:
   - **Action Prioritization**: Order `secondaryActions.items` by frequency of use (most used first)
   - **Inline Count**: Use `inlineCount: 1-3` for optimal UX (avoid cluttering)
   - **Visibility Control**:
     - Use `inlineAlwaysVisible: false` (default) for cleaner visual appearance
     - Use `inlineAlwaysVisible: true` only for critical actions requiring constant visibility

4. **Update Action Mode**:
   - Complex, full-entity edits → Use `mode: "page"` to navigate to entity page

5. **Custom Implementation**:
   - For `custom` actions, you must provide implementations in your code and register them with `PatternsWizardOverridesProvider`

### ActionCell Validation Checklist

AI agents should verify these requirements before generating ActionCell configurations:

✓ ActionCell is placed directly inside `table` or `grid` configuration
✓ Each action has a unique `id` and correct `type` value
✓ Each action type only includes its required field(s)
✓ Update page action refers to a valid entity page ID
✓ Delete action has a modal configuration
✓ Custom actions match implementations in overrides
✓ At least one of `primaryAction` or `secondaryActions` is provided
✓ `inlineCount` (if specified) is a non-negative number ≤ total secondary actions count
✓ `inlineAlwaysVisible` (if specified) is a boolean value
✓ Inline secondary actions configuration is applied only when secondary actions exist
✓ `skin` property (if specified) uses valid skin values:
  - Primary actions: `"standard"`, `"inverted"`, `"premium"`
  - Secondary actions: `"dark"`, `"destructive"`, `"premium"`

{"version":3,"names":["_react","_interopRequireDefault","require","_patterns","_providers","_fetchCmsData","_jsxFileName","DynamicCollectionFilter","filter","collectionId","component","FilterComponent","filterProps","getSchema","useSchemaRegistry","referencedSchema","fetchData","React","useCallback","query","items","total","result","fetchCmsData","fields","searchableFieldIds","displayField","filterFieldMapping","map","item","id","idField","name","collection","useFilterCollection","queryName","default","createElement","_extends2","__self","__source","fileName","lineNumber","columnNumber","exports"],"sources":["../../../../src/components/filters/DynamicCollectionFilter.tsx"],"sourcesContent":["import React from 'react';\nimport { Filter, useFilterCollection } from '@wix/patterns';\nimport { useSchemaRegistry } from '../../providers';\nimport { fetchCmsData } from '../../dataSourceAdapters/cms/fetchCmsData';\n\ninterface DynamicCollectionFilterProps {\n  filter: Filter<any>;\n  collectionId: string;\n  component: React.ElementType;\n  componentName?: string;\n  [key: string]: any;\n}\n\nexport const DynamicCollectionFilter: React.FC<\n  DynamicCollectionFilterProps\n> = ({ filter, collectionId, component: FilterComponent, ...filterProps }) => {\n  const { getSchema } = useSchemaRegistry();\n  const referencedSchema = getSchema(collectionId);\n\n  const fetchData = React.useCallback(\n    async (query) => {\n      if (!referencedSchema) {\n        return { items: [], total: 0 };\n      }\n\n      const result = await fetchCmsData(\n        collectionId,\n        query,\n        referencedSchema.fields,\n        {\n          searchableFieldIds: [referencedSchema.displayField],\n          filterFieldMapping: {},\n        },\n      );\n\n      return {\n        items: result.items.map((item: any) => ({\n          id: item[referencedSchema.idField],\n          name: item[referencedSchema.displayField],\n        })),\n      };\n    },\n    [collectionId, referencedSchema],\n  );\n\n  const collection = useFilterCollection(filter, {\n    queryName: `filter-collection-${collectionId}`,\n    fetchData,\n  });\n\n  return (\n    <FilterComponent filter={filter} collection={collection} {...filterProps} />\n  );\n};\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AACA,IAAAG,aAAA,GAAAH,OAAA;AAAyE,IAAAI,YAAA;AAUlE,MAAMC,uBAEZ,GAAGA,CAAC;EAAEC,MAAM;EAAEC,YAAY;EAAEC,SAAS,EAAEC,eAAe;EAAE,GAAGC;AAAY,CAAC,KAAK;EAC5E,MAAM;IAAEC;EAAU,CAAC,GAAG,IAAAC,4BAAiB,EAAC,CAAC;EACzC,MAAMC,gBAAgB,GAAGF,SAAS,CAACJ,YAAY,CAAC;EAEhD,MAAMO,SAAS,GAAGC,cAAK,CAACC,WAAW,CACjC,MAAOC,KAAK,IAAK;IACf,IAAI,CAACJ,gBAAgB,EAAE;MACrB,OAAO;QAAEK,KAAK,EAAE,EAAE;QAAEC,KAAK,EAAE;MAAE,CAAC;IAChC;IAEA,MAAMC,MAAM,GAAG,MAAM,IAAAC,0BAAY,EAC/Bd,YAAY,EACZU,KAAK,EACLJ,gBAAgB,CAACS,MAAM,EACvB;MACEC,kBAAkB,EAAE,CAACV,gBAAgB,CAACW,YAAY,CAAC;MACnDC,kBAAkB,EAAE,CAAC;IACvB,CACF,CAAC;IAED,OAAO;MACLP,KAAK,EAAEE,MAAM,CAACF,KAAK,CAACQ,GAAG,CAAEC,IAAS,KAAM;QACtCC,EAAE,EAAED,IAAI,CAACd,gBAAgB,CAACgB,OAAO,CAAC;QAClCC,IAAI,EAAEH,IAAI,CAACd,gBAAgB,CAACW,YAAY;MAC1C,CAAC,CAAC;IACJ,CAAC;EACH,CAAC,EACD,CAACjB,YAAY,EAAEM,gBAAgB,CACjC,CAAC;EAED,MAAMkB,UAAU,GAAG,IAAAC,6BAAmB,EAAC1B,MAAM,EAAE;IAC7C2B,SAAS,EAAE,qBAAqB1B,YAAY,EAAE;IAC9CO;EACF,CAAC,CAAC;EAEF,oBACEhB,MAAA,CAAAoC,OAAA,CAAAC,aAAA,CAAC1B,eAAe,MAAA2B,SAAA,CAAAF,OAAA;IAAC5B,MAAM,EAAEA,MAAO;IAACyB,UAAU,EAAEA;EAAW,GAAKrB,WAAW;IAAA2B,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAnC,YAAA;MAAAoC,UAAA;MAAAC,YAAA;IAAA;EAAA,EAAG,CAAC;AAEhF,CAAC;AAACC,OAAA,CAAArC,uBAAA,GAAAA,uBAAA","ignoreList":[]}
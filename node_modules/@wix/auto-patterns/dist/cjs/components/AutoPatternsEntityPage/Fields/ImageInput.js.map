{"version":3,"names":["_react","_interopRequireDefault","require","_designSystem","_patterns","_form","_getImageUrl","_dashboard","_jsxFileName","ImageInput","props","_pageState$entity","_field$validation2","_controller$fieldStat","field","dataHook","translate","t","container","useWixPatternsContainer","useSelector","initTask","status","pageState","useEntityPageContext","openMedia","_chosenMediaItems$ite","chosenMediaItems","dashboard","openMediaManager","multiSelect","category","newImage","items","media","image","controller","onChange","error","console","useController","name","id","control","form","defaultValue","entity","rules","validate","value","_field$validation","validation","required","undefined","imageUrl","getImageUrl","default","createElement","FormField","label","displayName","fieldState","statusMessage","message","__self","__source","fileName","lineNumber","columnNumber","ImageViewer","onAddImage","onUpdateImage","updateImageInfo","removeImageInfo","addImageInfo","height","width","fit","onRemoveImage","exports"],"sources":["../../../../../src/components/AutoPatternsEntityPage/Fields/ImageInput.tsx"],"sourcesContent":["import React from 'react';\nimport { FormField, ImageViewer } from '@wix/design-system';\nimport { BaseInputProps } from './types';\nimport {\n  useEntityPageContext,\n  useSelector,\n  useWixPatternsContainer,\n} from '@wix/patterns';\nimport { useController } from '@wix/patterns/form';\nimport { getImageUrl } from '../../../utils/media/getImageUrl';\nimport { dashboard } from '@wix/dashboard';\n\nexport interface ImageInputProps extends BaseInputProps<string> {}\n\nexport const ImageInput = (props: ImageInputProps) => {\n  const { field, dataHook } = props;\n\n  const { translate: t, ...container } = useWixPatternsContainer();\n  useSelector(() => container.initTask.status);\n\n  const pageState = useEntityPageContext();\n\n  async function openMedia() {\n    try {\n      const chosenMediaItems = await dashboard.openMediaManager({\n        multiSelect: false,\n        category: 'IMAGE',\n      });\n\n      const newImage = chosenMediaItems?.items[0]?.media?.image?.image;\n\n      controller.field.onChange(newImage);\n    } catch (error) {\n      console.error('Error opening Media Manager or no files selected:', error);\n    }\n  }\n\n  const controller = useController({\n    name: field?.id ?? '',\n    control: pageState.form.control,\n    defaultValue: (pageState.entity as any)?.[field?.id ?? ''],\n    rules: {\n      validate: (value) => {\n        if (\n          field.validation?.required &&\n          (value === null || value === undefined || value === '')\n        ) {\n          return t('cairo.fieldValidation.requiredField');\n        }\n\n        return true;\n      },\n    },\n  });\n\n  const imageUrl =\n    controller.field.value && getImageUrl(controller.field.value);\n\n  return (\n    <FormField\n      label={field.displayName}\n      required={field.validation?.required}\n      status={controller.fieldState.error ? 'error' : undefined}\n      statusMessage={controller.fieldState.error?.message}\n      dataHook={dataHook}\n    >\n      <ImageViewer\n        imageUrl={imageUrl}\n        dataHook={`image-${field.id}`}\n        onAddImage={() => openMedia()}\n        onUpdateImage={() => openMedia()}\n        updateImageInfo={t('cairo.replace-image.tooltip')}\n        removeImageInfo={t('cairo.remove-image.tooltip')}\n        addImageInfo={t('cairo.add-image.tooltip')}\n        height=\"120px\"\n        width=\"25%\"\n        fit=\"cover\"\n        onRemoveImage={() => controller.field.onChange(null)}\n      />\n    </FormField>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
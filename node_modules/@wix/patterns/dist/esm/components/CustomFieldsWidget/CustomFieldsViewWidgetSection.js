import { Text, Layout, Cell, Box, Heading, TextButton, } from '@wix/design-system';
import React from 'react';
import { useWixPatternsContainer } from '@wix/bex-core/react';
import { observer } from 'mobx-react-lite';
import { FileCardList } from '../FileCard/FileCardList';
import { getDateWithoutTimezone } from '../../utils/datesUtil';
const _CustomFieldsViewWidgetSection = ({ customFields, fieldValues, namespace, title, }) => {
    const container = useWixPatternsContainer();
    const { translate: t, dateFormatters } = container;
    const valueWrapper = (value, props) => {
        if (typeof value === 'string' && !/\s/.test(value)) {
            // if there are no space symbols we apply ellipsis (e.g. for links, emails, etc.)
            return (React.createElement(Text, { ...props, overflowWrap: "break-word" }, value));
        }
        if (typeof value !== 'string' && React.isValidElement(value)) {
            return value;
        }
        return React.createElement(Text, { ...props }, value);
    };
    const getViewValue = (value, type, valueDataHook) => {
        const textProps = {
            dataHook: valueDataHook,
            size: 'small',
            secondary: true,
        };
        // It is relevant only to app sections. User fields that are null/undefined will be filtered before and won't be displayed
        if (value === undefined || value === null) {
            return valueWrapper('-', textProps);
        }
        let newValue = value;
        switch (type) {
            case 'dropdown': {
                newValue = value;
                break;
            }
            case 'multiSelect': {
                newValue = value.join(', ');
                break;
            }
            case 'files': {
                const files = Array.isArray(value) ? value : [value];
                return React.createElement(FileCardList, { files: files, showDownloadCTA: true, showDetails: true });
            }
            case 'date':
                newValue = dateFormatters.medium.format(getDateWithoutTimezone(value));
                break;
            case 'dateTime':
                newValue = dateFormatters.mediumTime.format(new Date(value));
                break;
            case 'checkbox':
                newValue = value
                    ? t('cairo.customFields.booleanValue.true')
                    : t('cairo.customFields.booleanValue.false');
                break;
            case 'url':
                newValue = (React.createElement(TextButton, { as: "a", rel: "noopener", target: "_blank", size: "small", href: value, ellipsis: true, dataHook: valueDataHook }, value));
                break;
            default:
                break;
        }
        return valueWrapper(newValue, textProps);
    };
    return (React.createElement(Box, { width: "100%", direction: "vertical", dataHook: `custom-field-section-${namespace}` },
        React.createElement(Layout, { gap: "SP3", dataHook: `custom-field-section-${namespace}` },
            title && (React.createElement(Cell, { span: 12 },
                React.createElement(Heading, { size: "tiny", ellipsis: true, dataHook: `custom-field-section-title-${namespace}` }, title))),
            React.createElement(Cell, { span: 12 },
                React.createElement(Box, { display: "grid", rowGap: "18PX", columnGap: "24PX", gridTemplateColumns: "repeat(auto-fill, minmax(248px, 1fr))" }, customFields.map((field) => (React.createElement(Box, { key: field.id, flexGrow: 1, flexShrink: 1, flexBasis: 0, minWidth: "248px" },
                    React.createElement(CustomFieldCell, { key: field.id, field: field, value: getViewValue(fieldValues[field.id], field.type, `custom-field-value-${namespace}-${field.id}`), labelDataHook: `custom-field-label-${namespace}-${field.id}` })))))))));
};
export const CustomFieldsViewWidgetSection = observer(_CustomFieldsViewWidgetSection);
const CustomFieldCell = ({ field, value, labelDataHook, }) => {
    return (React.createElement(Cell, { key: field.id },
        React.createElement(Box, { direction: "vertical", gap: "SP1" },
            React.createElement(Text, { weight: "normal", size: "small", ellipsis: true, dataHook: labelDataHook },
                field.label || field.id,
                ":"),
            value)));
};
//# sourceMappingURL=CustomFieldsViewWidgetSection.js.map
import React, { useEffect, useState } from 'react';
import { observer } from 'mobx-react-lite';
import { CustomFieldsWidgetContextProvider } from '../CustomFieldsWidgetContext';
import { useCustomFieldsWidget } from '../../hooks/useCustomFieldsWidget';
import { CustomFieldsWidgetInline } from './CustomFieldsWidgetInline';
import { CustomFieldsWidgetCard } from './CustomFieldsWidgetCard';
import { runInAction } from 'mobx';
import { CustomFieldsWidgetCommonComponents } from './CustomFieldsWidgetCommonComponents';
const _CustomFieldsWidgetBase = ({ subtitle, dataHook, hideEmptyState, emptyStateOverrides = {}, state, theme = 'card', onChange, extendedFields, }) => {
    useState(() => {
        runInAction(() => {
            state._extendedFields = extendedFields;
        });
    });
    useEffect(() => {
        runInAction(() => {
            state._extendedFields = extendedFields;
        });
    }, [extendedFields]);
    const hideWidget = hideEmptyState &&
        (state.isLoading || state.dataExtension.availableCustomFields.length === 0);
    return (React.createElement(CustomFieldsWidgetContextProvider, { value: state },
        React.createElement(CustomFieldsWidgetCommonComponents, { state: state }),
        !hideWidget &&
            (theme === 'card' ? (React.createElement(CustomFieldsWidgetCard, { state: state, emptyStateOverrides: emptyStateOverrides, subtitle: subtitle, dataHook: dataHook, onChange: onChange })) : (React.createElement(CustomFieldsWidgetInline, { state: state, emptyStateOverrides: emptyStateOverrides, onChange: onChange, dataHook: dataHook })))));
};
const CustomFieldsWidgetBase = observer(_CustomFieldsWidgetBase);
const _CustomFieldsWidgetWithoutState = (props) => {
    const state = useCustomFieldsWidget(props);
    return React.createElement(CustomFieldsWidgetBase, { ...props, state: state });
};
const CustomFieldsWidgetWithoutState = observer(_CustomFieldsWidgetWithoutState);
const _CustomFieldsWidget = (props) => {
    return props.state ? (React.createElement(CustomFieldsWidgetBase, { ...props })) : (React.createElement(CustomFieldsWidgetWithoutState, { ...props }));
};
export const CustomFieldsWidget = observer(_CustomFieldsWidget);
//# sourceMappingURL=CustomFieldsWidget.js.map
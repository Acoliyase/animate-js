import { useOptimisticActions, useWixPatternsContainer, } from '@wix/bex-core/react';
import { createWixPatternsCreationEventName } from './aiAssistant';
import { useAiAssistantContext } from './useAiAssistantContext';
import { useState } from 'react';
import { wixPatternsItemCreatedWithAiSrc144Evid3 } from '@wix/bex-core/bi';
export function createAiAssistant({ appDefId, }) {
    return {
        useAiAssistant: ({ collection, loadingRowState, }) => {
            useAiAssistantCreation({ appDefId, collection, loadingRowState });
        },
    };
}
function useAiAssistantCreation(props) {
    const { appDefId, collection, loadingRowState } = props;
    const optimisticActions = useOptimisticActions(collection);
    const { useAssistantEffect } = useAiAssistantContext();
    const { reportBi } = useWixPatternsContainer();
    useState(() => {
        loadingRowState._loadAnimationAssets();
    });
    useAssistantEffect((payload) => {
        if (!payload.item) {
            if (process.env.NODE_ENV !== 'production') {
                console.warn('No item provided in the payload. Pass the new item that should be added to the collection like {item: myNewItem}. Skipping creation.');
            }
            return;
        }
        const itemKey = collection.itemKey(payload.item);
        loadingRowState.addLoadingItem(itemKey);
        reportBi(wixPatternsItemCreatedWithAiSrc144Evid3({
            itemId: itemKey,
        }));
        optimisticActions.createOne(payload.item, {
            submit: async (newItem) => {
                return newItem;
            },
        });
    }, appDefId, createWixPatternsCreationEventName(collection));
}
//# sourceMappingURL=createAiAssistant.js.map
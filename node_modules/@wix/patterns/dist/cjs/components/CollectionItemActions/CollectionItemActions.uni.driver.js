"use strict";

exports.__esModule = true;
exports.CollectionItemActionsUniDriver = void 0;
var _unidriver = require("@wix/design-system/dist/testkit/unidriver");
const CollectionItemActionsUniDriver = (base, body) => {
  const actionCell = (0, _unidriver.TableActionCellUniDriver)(base.$('[data-hook="collection-action-cell"]'), body);
  const getActionModal = () => (0, _unidriver.MessageModalLayoutUniDriver)(body.$('[data-hook="collection-action-modal"]'), body);
  const getPopoverMenuContent = async () => {
    const popoverMenu = await actionCell.getHiddenActionsPopoverMenuDriver();
    return popoverMenu.getContentElement();
  };
  const isSecondaryHiddenAction = async dataHook => {
    const popover = await actionCell.getHiddenActionsPopoverMenuDriver();
    if (await popover.exists()) {
      await actionCell.clickPopoverMenu();
      const popoverMenuContent = await getPopoverMenuContent();
      return popoverMenuContent.$(`[data-hook="${dataHook}"]`).exists();
    }
    return false;
  };
  const getHiddenActionBase = async dataHook => {
    const popoverMenuContent = await getPopoverMenuContent();
    return popoverMenuContent.$(`[data-hook="${dataHook}"]`);
  };
  const getVisibleActionBase = async dataHook => {
    return base.$(`[data-hook="${dataHook}"]`).$('[data-hook="table-action-cell-visible-action"]');
  };
  const clickAction = async dataHook => {
    const isHidden = await isSecondaryHiddenAction(dataHook);
    if (isHidden) {
      await actionCell.clickHiddenActionByDataHook(dataHook);
    } else {
      await base.$(`[data-hook="${dataHook}"]`).$('[data-hook="table-action-cell-visible-action"]').click();
    }
  };
  const clickSecondaryAction = async dataHook => {
    await actionCell.clickPopoverMenu();
    await actionCell.clickHiddenActionByDataHook(dataHook);
  };
  const confirmActionModal = async () => {
    const modal = getActionModal();
    const confirmButton = await modal.getPrimaryButtonDriver();
    await confirmButton.click();
  };
  const isSecondaryActionDisabled = async dataHook => (await (0, _unidriver.ListItemActionUniDriver)(await getHiddenActionBase(dataHook), body)).isDisabled();
  const getSecondaryActionTitleText = async dataHook => (await (0, _unidriver.ListItemActionUniDriver)(await getHiddenActionBase(dataHook), body)).getTitleText();
  const isVisibleSecondaryActionDisabled = async dataHook => (await (0, _unidriver.ButtonUniDriver)(await getVisibleActionBase(dataHook), body)).isButtonDisabled();
  return {
    ...actionCell,
    clickSecondaryAction,
    clickAction,
    getActionModal,
    confirmActionModal,
    isSecondaryActionDisabled,
    getSecondaryActionTitleText,
    isVisibleSecondaryActionDisabled
  };
};
exports.CollectionItemActionsUniDriver = CollectionItemActionsUniDriver;
//# sourceMappingURL=CollectionItemActions.uni.driver.js.map
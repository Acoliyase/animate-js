{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { types as BabelTypes, NodePath } from '@babel/core';\nimport * as t from '@babel/types';\nimport path from 'path';\n\ninterface SourceLocationPluginOptions {\n  attributeName?: string;\n}\n\nexport default function sourceLocationPlugin(\n  { types: t }: { types: typeof BabelTypes },\n  opts: SourceLocationPluginOptions = {},\n) {\n  const attrName = opts.attributeName || 'data-source-location';\n\n  return {\n    name: 'babel-plugin-jsx-source-attrs',\n    visitor: {\n      JSXOpeningElement(pathNode: NodePath<t.JSXOpeningElement>, state: any) {\n        if (t.isJSXFragment(pathNode.node)) {\n          return;\n        }\n        if (\n          pathNode.node.attributes.some(\n            (a) => t.isJSXAttribute(a) && a.name.name === attrName,\n          )\n        ) {\n          return;\n        }\n        const absPath = state.file.opts.filename || 'unknown';\n        const relPath = path.relative(process.cwd(), absPath);\n        const { line, column } = pathNode.node.loc?.start || {};\n        const attr = t.jsxAttribute(\n          t.jsxIdentifier(attrName),\n          t.stringLiteral(`${relPath}:${line}:${column}`),\n        );\n        pathNode.node.attributes.unshift(attr);\n      },\n    },\n  };\n}\n"],"mappings":";;;;AAEA,OAAO,UAAU;AAMF,SAAR,qBACL,EAAE,OAAO,EAAE,GACX,OAAoC,CAAC,GACrC;AACA,QAAM,WAAW,KAAK,iBAAiB;AAEvC,SAAO;AAAA,IACL,MAAM;AAAA,IACN,SAAS;AAAA,MACP,kBAAkB,UAAyC,OAAY;AACrE,YAAI,EAAE,cAAc,SAAS,IAAI,GAAG;AAClC;AAAA,QACF;AACA,YACE,SAAS,KAAK,WAAW;AAAA,UACvB,CAAC,MAAM,EAAE,eAAe,CAAC,KAAK,EAAE,KAAK,SAAS;AAAA,QAChD,GACA;AACA;AAAA,QACF;AACA,cAAM,UAAU,MAAM,KAAK,KAAK,YAAY;AAC5C,cAAM,UAAU,KAAK,SAAS,QAAQ,IAAI,GAAG,OAAO;AACpD,cAAM,EAAE,MAAM,OAAO,IAAI,SAAS,KAAK,KAAK,SAAS,CAAC;AACtD,cAAM,OAAO,EAAE;AAAA,UACb,EAAE,cAAc,QAAQ;AAAA,UACxB,EAAE,cAAc,GAAG,OAAO,IAAI,IAAI,IAAI,MAAM,EAAE;AAAA,QAChD;AACA,iBAAS,KAAK,WAAW,QAAQ,IAAI;AAAA,MACvC;AAAA,IACF;AAAA,EACF;AACF;","names":[]}
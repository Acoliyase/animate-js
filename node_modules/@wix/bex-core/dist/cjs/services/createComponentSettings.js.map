{"version":3,"names":["_DataCapsuleMergeStrategy","require","_mapGuidComponentIdToNonGuid","createComponentSettings","createEssentials","environment","options","dataCapsule","_dataCapsule","storageStrategy","namespace","scope","mapGuidComponentIdToNonGuid","componentId","artifactId","componentSettings","DataCapsuleMergeStrategy","storage","exports"],"sources":["../../../src/services/createComponentSettings.ts"],"sourcesContent":["import {\n  BaseStorage,\n  BaseStorageOptions,\n  DataCapsule,\n} from '@wix/fe-essentials/data-capsule';\nimport { CreateComponentSettings } from '../model';\nimport { DataCapsuleMergeStrategy } from './DataCapsuleMergeStrategy';\nimport { mapGuidComponentIdToNonGuid } from './mapGuidComponentIdToNonGuid';\n\nexport const createComponentSettings: CreateComponentSettings = ({\n  createEssentials,\n  environment,\n}) => {\n  return (options) => {\n    const { dataCapsule: _dataCapsule } = createEssentials({\n      dataCapsule: {\n        storageStrategy: 'userPreferences',\n        namespace: options.namespace,\n        scope: mapGuidComponentIdToNonGuid(\n          environment.componentId || environment.artifactId,\n        ),\n      },\n    });\n\n    const componentSettings = _dataCapsule as unknown as Omit<\n      DataCapsule,\n      'storageStrategy'\n    > & {\n      storageStrategy: BaseStorage<BaseStorageOptions>;\n    };\n\n    componentSettings.storageStrategy = new DataCapsuleMergeStrategy({\n      storage: componentSettings.storageStrategy,\n    });\n\n    return _dataCapsule;\n  };\n};\n"],"mappings":";;;;AAMA,IAAAA,yBAAA,GAAAC,OAAA;AACA,IAAAC,4BAAA,GAAAD,OAAA;AAEO,MAAME,uBAAgD,GAAGA,CAAC;EAC/DC,gBAAgB;EAChBC;AACF,CAAC,KAAK;EACJ,OAAQC,OAAO,IAAK;IAClB,MAAM;MAAEC,WAAW,EAAEC;IAAa,CAAC,GAAGJ,gBAAgB,CAAC;MACrDG,WAAW,EAAE;QACXE,eAAe,EAAE,iBAAiB;QAClCC,SAAS,EAAEJ,OAAO,CAACI,SAAS;QAC5BC,KAAK,EAAE,IAAAC,wDAA2B,EAChCP,WAAW,CAACQ,WAAW,IAAIR,WAAW,CAACS,UACzC;MACF;IACF,CAAC,CAAC;IAEF,MAAMC,iBAAiB,GAAGP,YAKzB;IAEDO,iBAAiB,CAACN,eAAe,GAAG,IAAIO,kDAAwB,CAAC;MAC/DC,OAAO,EAAEF,iBAAiB,CAACN;IAC7B,CAAC,CAAC;IAEF,OAAOD,YAAY;EACrB,CAAC;AACH,CAAC;AAACU,OAAA,CAAAf,uBAAA,GAAAA,uBAAA","ignoreList":[]}
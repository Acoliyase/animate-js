{"version":3,"names":["_lodash","require","_InMemoryBackend","_kanbanStaticData","createKanbanStage","chance","createdAt","date","min","Date","now","max","rest","id","guid","name","updatedAt","createKanbanStagesBackend","createOne","params","InMemoryBackend","enableTotal","i","raw","kanbanStaticStagesData","itemKey","item","total","length","predicate","query","search","rgx","RegExp","escapeRegExp","test","orderBy","sort","exports"],"sources":["../../../../src/testkit/kanban/createKanbanStagesBackend.ts"],"sourcesContent":["import { escapeRegExp } from 'lodash';\nimport { InMemoryBackend, InMemoryBackendParams } from '../../InMemoryBackend';\nimport { KanbanFilters } from './kanbanFilter';\nimport { MockStage } from './kanban';\nimport { kanbanStaticStagesData } from './kanbanStaticData';\n\nexport function createKanbanStage(\n  chance: Chance.Chance,\n  {\n    createdAt = chance.date({\n      min: new Date(Date.now() - 365 * 24 * 60 * 60 * 1000),\n      max: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),\n    }) as Date,\n    ...rest\n  }: Partial<MockStage> = {},\n): MockStage {\n  return {\n    id: chance.guid(),\n    name: chance.name(),\n    createdAt,\n    updatedAt: createdAt,\n    ...rest,\n  };\n}\n\nexport const createKanbanStagesBackend = ({\n  createOne,\n  ...params\n}: Partial<InMemoryBackendParams<MockStage, KanbanFilters>> = {}) => {\n  return new InMemoryBackend<MockStage, KanbanFilters>({\n    enableTotal: params?.enableTotal,\n    createOne: (i) => {\n      const raw = kanbanStaticStagesData[i];\n      return {\n        ...raw,\n        createdAt: new Date(raw.createdAt ?? ''),\n        updatedAt: new Date(raw.updatedAt ?? ''),\n      };\n    },\n    itemKey: (item) => item.id,\n    total: kanbanStaticStagesData.length,\n    predicate: (query) => {\n      const { search } = query;\n      // const filters = query.filters ?? {};\n      const rgx = new RegExp(escapeRegExp(search), 'i');\n\n      return (item: MockStage) => {\n        if (search && !rgx.test(item.name)) {\n          return false;\n        }\n\n        return true;\n      };\n    },\n    orderBy: (query) => {\n      return [...(query.sort ?? [])];\n    },\n    ...params,\n  });\n};\n"],"mappings":";;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AACA,IAAAC,gBAAA,GAAAD,OAAA;AAGA,IAAAE,iBAAA,GAAAF,OAAA;AAEO,SAASG,iBAAiBA,CAC/BC,MAAqB,EACrB;EACEC,SAAS,GAAGD,MAAM,CAACE,IAAI,CAAC;IACtBC,GAAG,EAAE,IAAIC,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;IACrDC,GAAG,EAAE,IAAIF,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;EACpD,CAAC,CAAS;EACV,GAAGE;AACe,CAAC,GAAG,CAAC,CAAC,EACf;EACX,OAAO;IACLC,EAAE,EAAER,MAAM,CAACS,IAAI,CAAC,CAAC;IACjBC,IAAI,EAAEV,MAAM,CAACU,IAAI,CAAC,CAAC;IACnBT,SAAS;IACTU,SAAS,EAAEV,SAAS;IACpB,GAAGM;EACL,CAAC;AACH;AAEO,MAAMK,yBAAyB,GAAGA,CAAC;EACxCC,SAAS;EACT,GAAGC;AACqD,CAAC,GAAG,CAAC,CAAC,KAAK;EACnE,OAAO,IAAIC,gCAAe,CAA2B;IACnDC,WAAW,EAAEF,MAAM,oBAANA,MAAM,CAAEE,WAAW;IAChCH,SAAS,EAAGI,CAAC,IAAK;MAChB,MAAMC,GAAG,GAAGC,wCAAsB,CAACF,CAAC,CAAC;MACrC,OAAO;QACL,GAAGC,GAAG;QACNjB,SAAS,EAAE,IAAIG,IAAI,CAACc,GAAG,CAACjB,SAAS,IAAI,EAAE,CAAC;QACxCU,SAAS,EAAE,IAAIP,IAAI,CAACc,GAAG,CAACP,SAAS,IAAI,EAAE;MACzC,CAAC;IACH,CAAC;IACDS,OAAO,EAAGC,IAAI,IAAKA,IAAI,CAACb,EAAE;IAC1Bc,KAAK,EAAEH,wCAAsB,CAACI,MAAM;IACpCC,SAAS,EAAGC,KAAK,IAAK;MACpB,MAAM;QAAEC;MAAO,CAAC,GAAGD,KAAK;MACxB;MACA,MAAME,GAAG,GAAG,IAAIC,MAAM,CAAC,IAAAC,oBAAY,EAACH,MAAM,CAAC,EAAE,GAAG,CAAC;MAEjD,OAAQL,IAAe,IAAK;QAC1B,IAAIK,MAAM,IAAI,CAACC,GAAG,CAACG,IAAI,CAACT,IAAI,CAACX,IAAI,CAAC,EAAE;UAClC,OAAO,KAAK;QACd;QAEA,OAAO,IAAI;MACb,CAAC;IACH,CAAC;IACDqB,OAAO,EAAGN,KAAK,IAAK;MAClB,OAAO,CAAC,IAAIA,KAAK,CAACO,IAAI,IAAI,EAAE,CAAC,CAAC;IAChC,CAAC;IACD,GAAGlB;EACL,CAAC,CAAC;AACJ,CAAC;AAACmB,OAAA,CAAArB,yBAAA,GAAAA,yBAAA","ignoreList":[]}
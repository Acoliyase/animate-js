{"version":3,"names":["_mobx","require","_ConditionalModalState","_CustomFieldModalBiReporter","_formstate","_ToggleState","_util","_isHttpError","CustomFieldModalState","constructor","params","_defineProperty2","default","ToggleState","undefined","ConditionalModalState","onConfirm","mode","dataExtensionState","isReachedMaxCustomFields","form","customFieldModalBiReporter","reportModalEndProcess","t","validation","validate","hasError","enableAutoValidation","Error","_this$dataExtensionSt","_this$dataExtensionSt2","dataExtensionSchema","dataExtensionService","addCustomField","getFormValues","schema","userSchema","fqdn","fqdnString","filterable","runInAction","_upsertSchema","container","showToast","call","message","type","biName","endType","e","onConfirmError","FormState","FieldState","validators","value","name","key","allUserCustomFields","some","field","id","test","readUsers","readApps","writeUsers","writeApps","containsPii","permissions","read","apps","users","write","$","dirty","reportBi","CustomFieldModalBiReporter","customFieldModalState","makeObservable","namePlaceholder","computed","isSubmitting","disabledFields","observable","ref","errorToastConfig","reset","action","setFormValues","generateUniqueKey","bound","setKeyFieldIfNotDirty","setDefaultPermissions","_this$errorToastConfi","getResolvedError","errorHandler","_httpError$response","_httpError$response2","_httpError$response3","resolvedError","httpError","isDetailsResponse","response","data","isErrorDetails","details","validationError","fieldViolations","v","ruleName","text","onClick","window","open","requestId","reportSubmitFailure","errorType","settings","setOff","disableAutoValidation","disablePermissionCheckboxes","_defaultPermissions$i","_defaultPermissions$s","defaultPermissions","installedApps","hide","_defaultPermissions$i2","_defaultPermissions$i3","defaultRead","defaultWrite","siteVisitors","_defaultPermissions$s2","_defaultPermissions$s3","containsKey","slug","slugify","length","index","translate","modalState","modal","confirming","isLoading","exports"],"sources":["../../../src/state/CustomFieldModalState.ts"],"sourcesContent":["import {\n  action,\n  computed,\n  makeObservable,\n  observable,\n  runInAction,\n} from 'mobx';\nimport { ConditionalModalState } from './ConditionalModalState';\nimport { CustomFieldModalBiReporter } from './CustomFieldModalBiReporter';\nimport { FieldState, FormState } from 'formstate';\nimport { ToggleState } from './ToggleState';\nimport { CustomFieldOrigin, CustomFieldType, ReportBI } from '../services';\nimport { DataExtensionState } from './DataExtensionState';\nimport { slugify } from '../util';\nimport { isDetailsResponse, isErrorDetails } from '../util/isHttpError';\nimport { ToastConfig } from '../model';\n\nexport interface CustomFieldStateParams {\n  dataExtensionState: DataExtensionState;\n  reportBi: ReportBI;\n}\n\nexport interface CustomFieldForm {\n  type?: CustomFieldType;\n  key: string;\n  name: string;\n  readApps: boolean;\n  readUsers: boolean;\n  writeApps: boolean;\n  writeUsers: boolean;\n  containsPii: boolean;\n}\n\nexport class CustomFieldModalState {\n  dataExtensionState: DataExtensionState;\n  customFieldModalBiReporter: CustomFieldModalBiReporter;\n  settings = new ToggleState();\n  errorToastConfig: ToastConfig | undefined = undefined;\n  mode: 'new' | 'edit' = 'new';\n  origin: CustomFieldOrigin = 'Custom columns panel';\n  customOrigin?: string;\n  reportBi: ReportBI;\n\n  modalState = new ConditionalModalState({\n    onConfirm: async () => {\n      if (\n        this.mode === 'new' &&\n        this.dataExtensionState.isReachedMaxCustomFields\n      ) {\n        return;\n      }\n      const {\n        form,\n        mode,\n        customFieldModalBiReporter: { reportModalEndProcess },\n        t,\n      } = this;\n\n      const validation = await form.validate();\n\n      if (validation.hasError) {\n        this.enableAutoValidation();\n        throw new Error('validation');\n      }\n\n      const { dataExtensionState } = this;\n      try {\n        const { dataExtensionSchema } =\n          await dataExtensionState.dataExtensionService.addCustomField({\n            form: this.getFormValues(),\n            schema: this.dataExtensionState.userSchema,\n            fqdn: this.dataExtensionState.fqdnString,\n            filterable: this.dataExtensionState.filterable,\n          });\n\n        runInAction(() => {\n          if (dataExtensionSchema) {\n            dataExtensionState._upsertSchema(dataExtensionSchema);\n          }\n        });\n\n        this.dataExtensionState.container.showToast?.({\n          message:\n            mode === 'new'\n              ? t('cairo.customFields.successToast')\n              : t('cairo.customFields.editCustomField.success.toast'),\n          type: 'SUCCESS',\n          biName: 'cairo-custom-field-success-toast',\n        });\n\n        reportModalEndProcess({ endType: 'Add Field' });\n      } catch (e: unknown) {\n        this.onConfirmError(e);\n      }\n    },\n  });\n\n  form = new FormState({\n    type: new FieldState<CustomFieldType | undefined>(undefined).validators(\n      (value) => {\n        if (!value) {\n          return this.t(\n            'cairo.customFields.addCustomField.modal.emptyFieldType.error',\n          );\n        }\n\n        return undefined;\n      },\n    ),\n    name: new FieldState('').validators((value) => {\n      if (!value) {\n        return this.t(\n          'cairo.customFields.addCustomField.modal.emptyFieldName.error',\n        );\n      }\n\n      return undefined;\n    }),\n    key: new FieldState('').validators((value) => {\n      const {\n        t,\n        mode,\n        dataExtensionState: { allUserCustomFields },\n      } = this;\n\n      if (!value) {\n        return this.t(\n          'cairo.customFields.addCustomField.modal.emptyFieldName.error',\n        );\n      }\n\n      if (\n        mode === 'new' &&\n        allUserCustomFields.some((field) => field.id === value)\n      ) {\n        return t('cairo.customFields.addCustomField.modal.sameKey.error');\n      }\n\n      if (!/^[a-zA-Z][a-zA-Z0-9_]*$/g.test(value)) {\n        return t('cairo.customFields.addCustomField.modal.keyFormat.error');\n      }\n\n      return undefined;\n    }),\n    readUsers: new FieldState(false),\n    readApps: new FieldState(false),\n    writeUsers: new FieldState(false),\n    writeApps: new FieldState(false),\n    containsPii: new FieldState(false),\n  });\n\n  disabledFields = {\n    permissions: {\n      read: { apps: true, users: true },\n      write: { apps: true, users: true },\n    },\n  };\n\n  constructor(params: CustomFieldStateParams) {\n    this.dataExtensionState = params.dataExtensionState;\n    this.reportBi = params.reportBi;\n    this.customFieldModalBiReporter = new CustomFieldModalBiReporter({\n      customFieldModalState: this,\n    });\n\n    makeObservable(this, {\n      namePlaceholder: computed,\n      isSubmitting: computed,\n      disabledFields: observable.ref,\n      errorToastConfig: observable.ref,\n      mode: observable.ref,\n      reset: action,\n      setFormValues: action,\n      generateUniqueKey: action.bound,\n      setKeyFieldIfNotDirty: action.bound,\n      setDefaultPermissions: action,\n    });\n  }\n\n  onConfirmError(e: unknown) {\n    const { getResolvedError } = this.dataExtensionState.container.errorHandler;\n\n    runInAction(() => {\n      const resolvedError = getResolvedError?.(e);\n      const httpError = resolvedError?.httpError;\n\n      if (\n        isDetailsResponse(httpError?.response?.data) &&\n        isErrorDetails(httpError?.response?.data.details) &&\n        httpError?.response?.data?.details?.validationError?.fieldViolations?.some(\n          (v) => v.ruleName === 'EXCEEDED_STORED_DATA_SIZE',\n        )\n      ) {\n        this.errorToastConfig = {\n          message: this.t('cairo.customFields.modal.maxFieldsError'),\n          action: {\n            text: this.t('cairo.error.contactSupport.cta'),\n            onClick: () => {\n              window.open('https://www.wix.com/contact', '_blank');\n            },\n          },\n        };\n      } else {\n        this.errorToastConfig = {\n          message: resolvedError?.message!,\n          action: resolvedError?.action,\n          details: resolvedError?.requestId\n            ? {\n                requestId: resolvedError.requestId,\n              }\n            : undefined,\n        };\n      }\n    });\n\n    this.customFieldModalBiReporter.reportSubmitFailure({\n      errorType: this.errorToastConfig?.message,\n    });\n\n    // Prevents modal closing\n    throw e;\n  }\n  reset() {\n    const {\n      form,\n      settings,\n      disabledFields: { permissions },\n    } = this;\n\n    form.reset();\n    settings.setOff();\n    this.errorToastConfig = undefined;\n    this.disableAutoValidation();\n\n    permissions.read.apps = false;\n    permissions.read.users = false;\n    permissions.write.apps = false;\n    permissions.write.users = false;\n  }\n\n  enableAutoValidation() {\n    const {\n      form: {\n        $: { key, name, type },\n      },\n    } = this;\n\n    key.enableAutoValidation();\n    name.enableAutoValidation();\n    type.enableAutoValidation();\n  }\n\n  disableAutoValidation() {\n    const {\n      form: {\n        $: { key, name, type },\n      },\n    } = this;\n\n    key.disableAutoValidation();\n    name.disableAutoValidation();\n    type.disableAutoValidation();\n  }\n\n  getFormValues(): CustomFieldForm {\n    const {\n      form: {\n        $: {\n          type,\n          key,\n          name,\n          readApps,\n          readUsers,\n          writeApps,\n          writeUsers,\n          containsPii,\n        },\n      },\n    } = this;\n\n    return {\n      type: type.value,\n      key: key.value,\n      name: name.value,\n      readApps: readApps.value,\n      readUsers: readUsers.value,\n      writeApps: writeApps.value,\n      writeUsers: writeUsers.value,\n      containsPii: containsPii.value,\n    };\n  }\n\n  setFormValues(\n    form: CustomFieldForm,\n    params?: { disablePermissionCheckboxes: boolean },\n  ) {\n    const {\n      form: { $ },\n    } = this;\n\n    $.key.value = form.key;\n    $.name.value = form.name;\n    $.type.value = form.type;\n    $.readApps.value = form.readApps;\n    $.readUsers.value = form.readUsers;\n    $.writeApps.value = form.writeApps;\n    $.writeUsers.value = form.writeUsers;\n    $.containsPii.value = form.containsPii;\n    if (params?.disablePermissionCheckboxes) {\n      if (form.readUsers) {\n        this.disabledFields.permissions.read.users = true;\n      }\n\n      if (form.readApps) {\n        this.disabledFields.permissions.read.apps = true;\n      }\n\n      if (form.writeUsers) {\n        this.disabledFields.permissions.write.users = true;\n      }\n\n      if (form.writeApps) {\n        this.disabledFields.permissions.write.apps = true;\n      }\n    }\n  }\n\n  setDefaultPermissions() {\n    const {\n      form: { $ },\n      dataExtensionState: { defaultPermissions },\n    } = this;\n    if (!defaultPermissions?.installedApps?.hide) {\n      $.readApps.value = !!defaultPermissions?.installedApps?.defaultRead;\n      $.writeApps.value = !!defaultPermissions?.installedApps?.defaultWrite;\n    }\n\n    if (!defaultPermissions?.siteVisitors?.hide) {\n      $.readUsers.value = !!defaultPermissions?.siteVisitors?.defaultRead;\n      $.writeUsers.value = !!defaultPermissions?.siteVisitors?.defaultWrite;\n    }\n  }\n\n  setKeyFieldIfNotDirty = (value: string) => {\n    const {\n      form: {\n        $: { key },\n      },\n      mode,\n    } = this;\n\n    if (mode === 'new' && !key.dirty) {\n      // In the formstate library setting a field value using\n      // the onChange API sets the dirty state of the field to true.\n      // However, since here it's not a manual user input\n      // we avoid changing the dirty state by setting a value directly.\n      key.value = value;\n    }\n  };\n\n  private containsKey(key: string) {\n    return this.dataExtensionState.allUserCustomFields.some(\n      (field) => field.id === key,\n    );\n  }\n\n  generateUniqueKey(name: string) {\n    const slug = slugify(name);\n    const type = this.form.$.type.value;\n\n    if (slug && slug.length >= 4 && !this.containsKey(slug)) {\n      return slug;\n    }\n\n    if (!type) {\n      return '';\n    }\n\n    let index = 1;\n\n    while (this.containsKey(`${type}_${index}`)) {\n      index += 1;\n    }\n\n    return `${type}_${index}`;\n  }\n\n  get t() {\n    return this.dataExtensionState.container.translate;\n  }\n\n  get isSubmitting() {\n    return this.modalState.modal.confirming.isLoading;\n  }\n\n  get namePlaceholder() {\n    const {\n      t,\n      form: {\n        $: { type },\n      },\n    } = this;\n\n    switch (type.value) {\n      case 'dropdown':\n        return t('cairo.customFields.fieldType.dropdownList.Name.placeholder');\n      case 'checkbox':\n        return t('cairo.customFields.fieldType.checkbox.Name.placeholder');\n      case 'shortText':\n        return t('cairo.customFields.fieldType.shortText.Name.placeholder');\n      case 'longText':\n        return t('cairo.customFields.fieldType.longText.Name.placeholder');\n      case 'url':\n        return t('cairo.customFields.placeholder.url');\n      case 'date':\n        return t('cairo.customFields.fieldType.date.Name.placeholder');\n      case 'dateTime':\n        return t('cairo.customFields.fieldType.dateAndTime.Name.placeholder');\n      case 'integer':\n        return t('cairo.customFields.fieldType.numberInteger.Name.placeholder');\n      case 'decimal':\n        return t('cairo.customFields.fieldType.numberDecimal.Name.placeholder');\n      default:\n        return t(\n          'cairo.customFields.addCustomField.modal.fieldName.placeholder',\n        );\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}
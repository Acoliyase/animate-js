{"version":3,"names":["getJobItemsAbsoluteCounter","job","query","totalForExport","paging","cursorPaging","getOffset","_job$data","_job$data2","_job$data3","data","processedItemsCount","pagingMetadata","offset","Math","max","limit","iterationsCount","min"],"sources":["../../../src/state/getJobItemsAbsoluteCounter.ts"],"sourcesContent":["import {\n  ExportAsyncJob,\n  ExportQueryV2 as QueryV2,\n} from '@wix/bex-utils/@wix/ambassador-fedinfra-exportservice-v1-export-async-job/types';\n\nexport function getJobItemsAbsoluteCounter(\n  job: ExportAsyncJob,\n  { query, totalForExport }: { query: QueryV2; totalForExport?: number | null },\n) {\n  const paging = query.paging ?? query.cursorPaging;\n  const getOffset = () => {\n    if (job.data?.processedItemsCount != null) {\n      return job.data.processedItemsCount;\n    }\n\n    if (job.data?.pagingMetadata?.offset != null) {\n      return Math.max(\n        job.data.pagingMetadata.offset - (paging?.limit as number),\n        0,\n      );\n    }\n\n    const iterationsCount = job.data?.iterationsCount ?? 0;\n    return Math.max(iterationsCount - 1, 0) * (paging?.limit as number);\n  };\n\n  const processedItemsCount = getOffset();\n  return totalForExport\n    ? Math.min(processedItemsCount, totalForExport)\n    : processedItemsCount;\n}\n"],"mappings":";;;;AAKO,SAASA,0BAA0BA,CACxCC,GAAmB,EACnB;EAAEC,KAAK;EAAEC;AAAmE,CAAC,EAC7E;EACA,MAAMC,MAAM,GAAGF,KAAK,CAACE,MAAM,IAAIF,KAAK,CAACG,YAAY;EACjD,MAAMC,SAAS,GAAGA,CAAA,KAAM;IAAA,IAAAC,SAAA,EAAAC,UAAA,EAAAC,UAAA;IACtB,IAAI,EAAAF,SAAA,GAAAN,GAAG,CAACS,IAAI,qBAARH,SAAA,CAAUI,mBAAmB,KAAI,IAAI,EAAE;MACzC,OAAOV,GAAG,CAACS,IAAI,CAACC,mBAAmB;IACrC;IAEA,IAAI,EAAAH,UAAA,GAAAP,GAAG,CAACS,IAAI,cAAAF,UAAA,GAARA,UAAA,CAAUI,cAAc,qBAAxBJ,UAAA,CAA0BK,MAAM,KAAI,IAAI,EAAE;MAC5C,OAAOC,IAAI,CAACC,GAAG,CACbd,GAAG,CAACS,IAAI,CAACE,cAAc,CAACC,MAAM,IAAIT,MAAM,oBAANA,MAAM,CAAEY,KAAK,CAAW,EAC1D,CACF,CAAC;IACH;IAEA,MAAMC,eAAe,GAAG,EAAAR,UAAA,GAAAR,GAAG,CAACS,IAAI,qBAARD,UAAA,CAAUQ,eAAe,KAAI,CAAC;IACtD,OAAOH,IAAI,CAACC,GAAG,CAACE,eAAe,GAAG,CAAC,EAAE,CAAC,CAAC,IAAIb,MAAM,oBAANA,MAAM,CAAEY,KAAK,CAAW;EACrE,CAAC;EAED,MAAML,mBAAmB,GAAGL,SAAS,CAAC,CAAC;EACvC,OAAOH,cAAc,GACjBW,IAAI,CAACI,GAAG,CAACP,mBAAmB,EAAER,cAAc,CAAC,GAC7CQ,mBAAmB;AACzB","ignoreList":[]}
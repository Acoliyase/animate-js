{"version":3,"names":["FedopsReporter","constructor","params","_defineProperty2","default","componentName","collection","internalMonitor","emitter","reportInteractionStart","once","isStale","customProps","cached","reportInteractionEnd","onFullRenderStart","exports"],"sources":["../../../src/state/FedopsReporter.ts"],"sourcesContent":["import { FiltersMap } from '../model';\nimport { WixPatternsMonitor } from '../services';\nimport { CollectionState } from './CollectionState';\n\nexport interface FedopsReporterParams<T, F extends FiltersMap> {\n  componentName: string;\n  collection: CollectionState<T, F>;\n  internalMonitor: WixPatternsMonitor;\n}\n\nexport class FedopsReporter<T, F extends FiltersMap> {\n  componentName;\n  collection;\n  internalMonitor;\n\n  constructor(params: FedopsReporterParams<T, F>) {\n    this.componentName = params.componentName;\n    this.collection = params.collection;\n    this.internalMonitor = params.internalMonitor;\n\n    const {\n      internalMonitor,\n      componentName,\n      collection: { emitter },\n    } = this;\n\n    internalMonitor.reportInteractionStart(componentName, 'initial-load');\n    internalMonitor.reportInteractionStart(componentName, 'e2e');\n\n    emitter.once('beforeInitialFetch', ({ isStale }) => {\n      const customProps = { cached: !isStale };\n\n      internalMonitor.reportInteractionEnd(componentName, 'initial-load');\n      internalMonitor.reportInteractionStart(\n        componentName,\n        'initial-fetch-data',\n        customProps,\n      );\n\n      emitter.once('ready', () => {\n        internalMonitor.reportInteractionEnd(\n          componentName,\n          'initial-fetch-data',\n          customProps,\n        );\n      });\n    });\n  }\n\n  onFullRenderStart() {\n    const { internalMonitor, componentName } = this;\n\n    internalMonitor.reportInteractionStart(\n      componentName,\n      'initial-full-render',\n    );\n\n    return () => {\n      internalMonitor.reportInteractionEnd(\n        componentName,\n        'initial-full-render',\n      );\n      internalMonitor.reportInteractionEnd(componentName, 'e2e');\n    };\n  }\n}\n"],"mappings":";;;;;;AAUO,MAAMA,cAAc,CAA0B;EAKnDC,WAAWA,CAACC,MAAkC,EAAE;IAAA,IAAAC,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA;IAC9C,IAAI,CAACC,aAAa,GAAGH,MAAM,CAACG,aAAa;IACzC,IAAI,CAACC,UAAU,GAAGJ,MAAM,CAACI,UAAU;IACnC,IAAI,CAACC,eAAe,GAAGL,MAAM,CAACK,eAAe;IAE7C,MAAM;MACJA,eAAe;MACfF,aAAa;MACbC,UAAU,EAAE;QAAEE;MAAQ;IACxB,CAAC,GAAG,IAAI;IAERD,eAAe,CAACE,sBAAsB,CAACJ,aAAa,EAAE,cAAc,CAAC;IACrEE,eAAe,CAACE,sBAAsB,CAACJ,aAAa,EAAE,KAAK,CAAC;IAE5DG,OAAO,CAACE,IAAI,CAAC,oBAAoB,EAAE,CAAC;MAAEC;IAAQ,CAAC,KAAK;MAClD,MAAMC,WAAW,GAAG;QAAEC,MAAM,EAAE,CAACF;MAAQ,CAAC;MAExCJ,eAAe,CAACO,oBAAoB,CAACT,aAAa,EAAE,cAAc,CAAC;MACnEE,eAAe,CAACE,sBAAsB,CACpCJ,aAAa,EACb,oBAAoB,EACpBO,WACF,CAAC;MAEDJ,OAAO,CAACE,IAAI,CAAC,OAAO,EAAE,MAAM;QAC1BH,eAAe,CAACO,oBAAoB,CAClCT,aAAa,EACb,oBAAoB,EACpBO,WACF,CAAC;MACH,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAG,iBAAiBA,CAAA,EAAG;IAClB,MAAM;MAAER,eAAe;MAAEF;IAAc,CAAC,GAAG,IAAI;IAE/CE,eAAe,CAACE,sBAAsB,CACpCJ,aAAa,EACb,qBACF,CAAC;IAED,OAAO,MAAM;MACXE,eAAe,CAACO,oBAAoB,CAClCT,aAAa,EACb,qBACF,CAAC;MACDE,eAAe,CAACO,oBAAoB,CAACT,aAAa,EAAE,KAAK,CAAC;IAC5D,CAAC;EACH;AACF;AAACW,OAAA,CAAAhB,cAAA,GAAAA,cAAA","ignoreList":[]}
{"version":3,"names":["_util","require","_v","DataExtensionStateBIReporter","constructor","params","_defineProperty2","default","ctaName","reportBi","withoutDefaults","cairoModalCtaClicked","modalName","origin","formValues","cairoDataExtensionUnsuccessfulUpdateInServer","actionName","errorType","permissions","getBiPermissions","fieldType","type","fieldName","name","key","cairoTryAgainClicked","loaction","readApps","readUsers","writeApps","writeUsers","apps","users","push","JSON","stringify","length","join","exports"],"sources":["../../../src/state/DataExtensionStateBIReporter.ts"],"sourcesContent":["import { ReportBI } from '../services';\nimport { withoutDefaults } from '../util';\nimport {\n  cairoDataExtensionUnsuccessfulUpdateInServer,\n  cairoModalCtaClicked,\n  cairoTryAgainClicked,\n} from '@wix/bex-utils/@wix/bi-logger-os-data/v2';\nimport { CustomFieldForm } from './CustomFieldModalState';\n\nexport interface DataExtensionStateBIReporterParams {\n  reportBi: ReportBI;\n}\n\nexport class DataExtensionStateBIReporter {\n  readonly reportBi: ReportBI;\n\n  constructor(params: Readonly<DataExtensionStateBIReporterParams>) {\n    const { reportBi } = params;\n\n    this.reportBi = reportBi;\n  }\n\n  reportArchiveFieldModalCtaClicked = (ctaName: string) => {\n    this.reportBi(\n      withoutDefaults(cairoModalCtaClicked)({\n        ctaName,\n        modalName: 'Archive custom field',\n      }),\n    );\n  };\n\n  getBiPermissions(formValues: CustomFieldForm) {\n    const { readApps, readUsers, writeApps, writeUsers } = formValues;\n    const apps = [];\n    const users = [];\n\n    if (readApps) {\n      apps.push('Read');\n    }\n\n    if (writeApps) {\n      apps.push('Write');\n    }\n\n    if (readUsers) {\n      users.push('Read');\n    }\n\n    if (writeUsers) {\n      users.push('Write');\n    }\n\n    return JSON.stringify({\n      'Installed apps': apps.length !== 0 ? apps.join(' and ') : null,\n      'Site visitors': users.length !== 0 ? users.join(' and ') : null,\n    });\n  }\n\n  reportArchiveFieldFailed = ({\n    origin,\n    formValues,\n  }: {\n    origin: string;\n    formValues?: CustomFieldForm;\n  }) => {\n    if (!formValues) {\n      return;\n    }\n\n    this.reportBi(\n      withoutDefaults(cairoDataExtensionUnsuccessfulUpdateInServer)({\n        actionName: 'Archive',\n        errorType: 'Technical issue',\n        origin,\n        permissions: this.getBiPermissions(formValues),\n        fieldType: formValues.type,\n        fieldName: formValues.name,\n        key: formValues.key,\n      }),\n    );\n  };\n\n  reportArchiveTryAgain = () => {\n    this.reportBi(\n      withoutDefaults(cairoTryAgainClicked)({\n        actionName: 'Archive custom field',\n        loaction: 'toast',\n      }),\n    );\n  };\n}\n"],"mappings":";;;;;;AACA,IAAAA,KAAA,GAAAC,OAAA;AACA,IAAAC,EAAA,GAAAD,OAAA;AAWO,MAAME,4BAA4B,CAAC;EAGxCC,WAAWA,CAACC,MAAoD,EAAE;IAAA,IAAAC,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA,6CAM7BC,OAAe,IAAK;MACvD,IAAI,CAACC,QAAQ,CACX,IAAAC,qBAAe,EAACC,uBAAoB,CAAC,CAAC;QACpCH,OAAO;QACPI,SAAS,EAAE;MACb,CAAC,CACH,CAAC;IACH,CAAC;IAAA,IAAAN,gBAAA,CAAAC,OAAA,oCA6B0B,CAAC;MAC1BM,MAAM;MACNC;IAIF,CAAC,KAAK;MACJ,IAAI,CAACA,UAAU,EAAE;QACf;MACF;MAEA,IAAI,CAACL,QAAQ,CACX,IAAAC,qBAAe,EAACK,+CAA4C,CAAC,CAAC;QAC5DC,UAAU,EAAE,SAAS;QACrBC,SAAS,EAAE,iBAAiB;QAC5BJ,MAAM;QACNK,WAAW,EAAE,IAAI,CAACC,gBAAgB,CAACL,UAAU,CAAC;QAC9CM,SAAS,EAAEN,UAAU,CAACO,IAAI;QAC1BC,SAAS,EAAER,UAAU,CAACS,IAAI;QAC1BC,GAAG,EAAEV,UAAU,CAACU;MAClB,CAAC,CACH,CAAC;IACH,CAAC;IAAA,IAAAlB,gBAAA,CAAAC,OAAA,iCAEuB,MAAM;MAC5B,IAAI,CAACE,QAAQ,CACX,IAAAC,qBAAe,EAACe,uBAAoB,CAAC,CAAC;QACpCT,UAAU,EAAE,sBAAsB;QAClCU,QAAQ,EAAE;MACZ,CAAC,CACH,CAAC;IACH,CAAC;IAxEC,MAAM;MAAEjB;IAAS,CAAC,GAAGJ,MAAM;IAE3B,IAAI,CAACI,QAAQ,GAAGA,QAAQ;EAC1B;EAWAU,gBAAgBA,CAACL,UAA2B,EAAE;IAC5C,MAAM;MAAEa,QAAQ;MAAEC,SAAS;MAAEC,SAAS;MAAEC;IAAW,CAAC,GAAGhB,UAAU;IACjE,MAAMiB,IAAI,GAAG,EAAE;IACf,MAAMC,KAAK,GAAG,EAAE;IAEhB,IAAIL,QAAQ,EAAE;MACZI,IAAI,CAACE,IAAI,CAAC,MAAM,CAAC;IACnB;IAEA,IAAIJ,SAAS,EAAE;MACbE,IAAI,CAACE,IAAI,CAAC,OAAO,CAAC;IACpB;IAEA,IAAIL,SAAS,EAAE;MACbI,KAAK,CAACC,IAAI,CAAC,MAAM,CAAC;IACpB;IAEA,IAAIH,UAAU,EAAE;MACdE,KAAK,CAACC,IAAI,CAAC,OAAO,CAAC;IACrB;IAEA,OAAOC,IAAI,CAACC,SAAS,CAAC;MACpB,gBAAgB,EAAEJ,IAAI,CAACK,MAAM,KAAK,CAAC,GAAGL,IAAI,CAACM,IAAI,CAAC,OAAO,CAAC,GAAG,IAAI;MAC/D,eAAe,EAAEL,KAAK,CAACI,MAAM,KAAK,CAAC,GAAGJ,KAAK,CAACK,IAAI,CAAC,OAAO,CAAC,GAAG;IAC9D,CAAC,CAAC;EACJ;AAkCF;AAACC,OAAA,CAAAnC,4BAAA,GAAAA,4BAAA","ignoreList":[]}
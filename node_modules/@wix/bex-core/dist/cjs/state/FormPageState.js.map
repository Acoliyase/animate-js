{"version":3,"names":["_mobx","require","_TaskState","_WidgetsFormState","FormPageState","constructor","props","_defineProperty2","default","TaskState","undefined","_form","form","_widgets","widgets","WidgetsFormState","makeObservable","isFetching","computed","_isFormDirty","observable","ref","isDirty","isFormDirty","flag","initTask","status","isLoading","isIdle","isSubmitSuccessful","_isSubmitSuccessful","retryFetch","runOnce","validate","registerWidget","key","state","getWidgetState","get","exports"],"sources":["../../../src/state/FormPageState.ts"],"sourcesContent":["import { computed, makeObservable, observable } from 'mobx';\nimport { FieldValues, UseFormReturn } from 'react-hook-form';\nimport { TaskState } from './TaskState';\nimport { WidgetState, WidgetsFormState } from './WidgetsFormState';\n\nexport interface FormPageProps<V extends FieldValues = FieldValues> {\n  /**\n   * An object representing the form state and methods, typically returned by a useForm hook.\n   */\n  form: UseFormReturn<V>;\n\n  widgets?: WidgetsFormState;\n}\n\nexport class FormPageState<V extends FieldValues = FieldValues> {\n  readonly _widgets: WidgetsFormState;\n  readonly _form: UseFormReturn<V>;\n  readonly initTask = new TaskState();\n  readonly submitTask = new TaskState();\n\n  _isSubmitSuccessful?: boolean = undefined;\n  _isFormDirty = false;\n\n  constructor(props: FormPageProps<V>) {\n    this._form = props.form;\n    this._widgets = props.widgets ?? new WidgetsFormState();\n\n    makeObservable(this, {\n      isFetching: computed,\n      _isFormDirty: observable.ref,\n      isDirty: computed,\n    });\n  }\n\n  set isFormDirty(flag: boolean) {\n    this._isFormDirty = flag;\n  }\n\n  get isDirty() {\n    return this._isFormDirty || this._widgets.isDirty;\n  }\n\n  get form() {\n    return this._form;\n  }\n\n  get isFetching() {\n    return this.initTask.status.isLoading || this.initTask.status.isIdle;\n  }\n\n  set isSubmitSuccessful(flag: boolean) {\n    this._isSubmitSuccessful = flag;\n  }\n\n  retryFetch() {\n    this.initTask.runOnce();\n  }\n\n  /**\n   * For backward compatibility, keep this as validate, but it only validates widgets.\n   */\n  validate() {\n    return this._widgets.validate();\n  }\n\n  registerWidget(key: string, state: WidgetState) {\n    this._widgets.registerWidget(key, state);\n  }\n\n  getWidgetState(key: string) {\n    return this._widgets.get(key);\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AAEA,IAAAC,UAAA,GAAAD,OAAA;AACA,IAAAE,iBAAA,GAAAF,OAAA;AAWO,MAAMG,aAAa,CAAsC;EAS9DC,WAAWA,CAACC,KAAuB,EAAE;IAAA,IAAAC,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA,oBANjB,IAAIC,oBAAS,CAAC,CAAC;IAAA,IAAAF,gBAAA,CAAAC,OAAA,sBACb,IAAIC,oBAAS,CAAC,CAAC;IAAA,IAAAF,gBAAA,CAAAC,OAAA,+BAELE,SAAS;IAAA,IAAAH,gBAAA,CAAAC,OAAA,wBAC1B,KAAK;IAGlB,IAAI,CAACG,KAAK,GAAGL,KAAK,CAACM,IAAI;IACvB,IAAI,CAACC,QAAQ,GAAGP,KAAK,CAACQ,OAAO,IAAI,IAAIC,kCAAgB,CAAC,CAAC;IAEvD,IAAAC,oBAAc,EAAC,IAAI,EAAE;MACnBC,UAAU,EAAEC,cAAQ;MACpBC,YAAY,EAAEC,gBAAU,CAACC,GAAG;MAC5BC,OAAO,EAAEJ;IACX,CAAC,CAAC;EACJ;EAEA,IAAIK,WAAWA,CAACC,IAAa,EAAE;IAC7B,IAAI,CAACL,YAAY,GAAGK,IAAI;EAC1B;EAEA,IAAIF,OAAOA,CAAA,EAAG;IACZ,OAAO,IAAI,CAACH,YAAY,IAAI,IAAI,CAACN,QAAQ,CAACS,OAAO;EACnD;EAEA,IAAIV,IAAIA,CAAA,EAAG;IACT,OAAO,IAAI,CAACD,KAAK;EACnB;EAEA,IAAIM,UAAUA,CAAA,EAAG;IACf,OAAO,IAAI,CAACQ,QAAQ,CAACC,MAAM,CAACC,SAAS,IAAI,IAAI,CAACF,QAAQ,CAACC,MAAM,CAACE,MAAM;EACtE;EAEA,IAAIC,kBAAkBA,CAACL,IAAa,EAAE;IACpC,IAAI,CAACM,mBAAmB,GAAGN,IAAI;EACjC;EAEAO,UAAUA,CAAA,EAAG;IACX,IAAI,CAACN,QAAQ,CAACO,OAAO,CAAC,CAAC;EACzB;;EAEA;AACF;AACA;EACEC,QAAQA,CAAA,EAAG;IACT,OAAO,IAAI,CAACpB,QAAQ,CAACoB,QAAQ,CAAC,CAAC;EACjC;EAEAC,cAAcA,CAACC,GAAW,EAAEC,KAAkB,EAAE;IAC9C,IAAI,CAACvB,QAAQ,CAACqB,cAAc,CAACC,GAAG,EAAEC,KAAK,CAAC;EAC1C;EAEAC,cAAcA,CAACF,GAAW,EAAE;IAC1B,OAAO,IAAI,CAACtB,QAAQ,CAACyB,GAAG,CAACH,GAAG,CAAC;EAC/B;AACF;AAACI,OAAA,CAAAnC,aAAA,GAAAA,aAAA","ignoreList":[]}
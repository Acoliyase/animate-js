{"version":3,"names":["_mobx","require","_PageState","_resizeObserverCompat","_CollectionPageStateBIReporter","CollectionPageState","constructor","params","_defineProperty2","default","performance","now","PageState","pageTitle","hasHeader","hideHeaderTotal","withinRouter","reportBI","bi","CollectionPageStateBIReporter","collectionPageState","makeObservable","observable","ref","total","init","_this$bi","_this$bi2","scrollableContent","pageState","scrollableContentRef","current","disposer","addResizeObserver","scrollTopBeforeUnmount","scrollHeight","scrollTo","top","appLoaded","exports"],"sources":["../../../../src/state/CollectionPageState/CollectionPageState.ts"],"sourcesContent":["import { makeObservable, observable } from 'mobx';\nimport { PageState } from '../PageState';\nimport { addResizeObserver } from '../resizeObserverCompat';\nimport { CollectionPageStateBIReporter } from './CollectionPageStateBIReporter';\nimport { ReportBI } from '../../services';\n\nexport interface CollectionPageStateParams {\n  pageTitle?: string;\n  hasHeader?: boolean;\n  hideHeaderTotal?: boolean;\n  reportBI?: ReportBI;\n  withinRouter?: boolean;\n}\n\nexport class CollectionPageState {\n  pageTitle?: string;\n  hasHeader?: boolean = false;\n  total?: number | boolean = false;\n  hideHeaderTotal?: boolean = false;\n  scrollTopBeforeUnmount: number | null = null;\n  withinRouter?: boolean;\n  readonly startTime = performance.now();\n  readonly bi?: CollectionPageStateBIReporter;\n\n  readonly pageState = new PageState();\n\n  constructor(params: CollectionPageStateParams) {\n    this.pageTitle = params.pageTitle;\n    this.hasHeader = params.hasHeader;\n    this.hideHeaderTotal = params.hideHeaderTotal;\n    this.withinRouter = params.withinRouter;\n    if (params.reportBI) {\n      this.bi = new CollectionPageStateBIReporter({\n        reportBI: params.reportBI,\n        collectionPageState: this,\n      });\n    }\n    makeObservable(this, {\n      pageTitle: observable.ref,\n      hasHeader: observable.ref,\n      hideHeaderTotal: observable.ref,\n      total: observable.ref,\n    });\n  }\n\n  init() {\n    this.bi?.init();\n\n    const scrollableContent = this.pageState.scrollableContentRef.current;\n    if (!scrollableContent) {\n      return () => {};\n    }\n\n    const disposer = addResizeObserver(scrollableContent, () => {\n      if (this.scrollTopBeforeUnmount === null) {\n        return;\n      }\n      if (scrollableContent.scrollHeight >= this.scrollTopBeforeUnmount) {\n        scrollableContent.scrollTo({\n          top: this.scrollTopBeforeUnmount,\n        });\n        this.scrollTopBeforeUnmount = null;\n      }\n    });\n    this.bi?.appLoaded?.();\n\n    return () => {\n      disposer?.();\n    };\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA,IAAAC,UAAA,GAAAD,OAAA;AACA,IAAAE,qBAAA,GAAAF,OAAA;AACA,IAAAG,8BAAA,GAAAH,OAAA;AAWO,MAAMI,mBAAmB,CAAC;EAY/BC,WAAWA,CAACC,MAAiC,EAAE;IAAA,IAAAC,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA,qBAVzB,KAAK;IAAA,IAAAD,gBAAA,CAAAC,OAAA,iBACA,KAAK;IAAA,IAAAD,gBAAA,CAAAC,OAAA,2BACJ,KAAK;IAAA,IAAAD,gBAAA,CAAAC,OAAA,kCACO,IAAI;IAAA,IAAAD,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA,qBAEvBC,WAAW,CAACC,GAAG,CAAC,CAAC;IAAA,IAAAH,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA,qBAGjB,IAAIG,oBAAS,CAAC,CAAC;IAGlC,IAAI,CAACC,SAAS,GAAGN,MAAM,CAACM,SAAS;IACjC,IAAI,CAACC,SAAS,GAAGP,MAAM,CAACO,SAAS;IACjC,IAAI,CAACC,eAAe,GAAGR,MAAM,CAACQ,eAAe;IAC7C,IAAI,CAACC,YAAY,GAAGT,MAAM,CAACS,YAAY;IACvC,IAAIT,MAAM,CAACU,QAAQ,EAAE;MACnB,IAAI,CAACC,EAAE,GAAG,IAAIC,4DAA6B,CAAC;QAC1CF,QAAQ,EAAEV,MAAM,CAACU,QAAQ;QACzBG,mBAAmB,EAAE;MACvB,CAAC,CAAC;IACJ;IACA,IAAAC,oBAAc,EAAC,IAAI,EAAE;MACnBR,SAAS,EAAES,gBAAU,CAACC,GAAG;MACzBT,SAAS,EAAEQ,gBAAU,CAACC,GAAG;MACzBR,eAAe,EAAEO,gBAAU,CAACC,GAAG;MAC/BC,KAAK,EAAEF,gBAAU,CAACC;IACpB,CAAC,CAAC;EACJ;EAEAE,IAAIA,CAAA,EAAG;IAAA,IAAAC,QAAA,EAAAC,SAAA;IACL,CAAAD,QAAA,OAAI,CAACR,EAAE,aAAPQ,QAAA,CAASD,IAAI,CAAC,CAAC;IAEf,MAAMG,iBAAiB,GAAG,IAAI,CAACC,SAAS,CAACC,oBAAoB,CAACC,OAAO;IACrE,IAAI,CAACH,iBAAiB,EAAE;MACtB,OAAO,MAAM,CAAC,CAAC;IACjB;IAEA,MAAMI,QAAQ,GAAG,IAAAC,uCAAiB,EAACL,iBAAiB,EAAE,MAAM;MAC1D,IAAI,IAAI,CAACM,sBAAsB,KAAK,IAAI,EAAE;QACxC;MACF;MACA,IAAIN,iBAAiB,CAACO,YAAY,IAAI,IAAI,CAACD,sBAAsB,EAAE;QACjEN,iBAAiB,CAACQ,QAAQ,CAAC;UACzBC,GAAG,EAAE,IAAI,CAACH;QACZ,CAAC,CAAC;QACF,IAAI,CAACA,sBAAsB,GAAG,IAAI;MACpC;IACF,CAAC,CAAC;IACF,CAAAP,SAAA,OAAI,CAACT,EAAE,aAAPS,SAAA,CAASW,SAAS,YAAlBX,SAAA,CAASW,SAAS,CAAG,CAAC;IAEtB,OAAO,MAAM;MACXN,QAAQ,YAARA,QAAQ,CAAG,CAAC;IACd,CAAC;EACH;AACF;AAACO,OAAA,CAAAlC,mBAAA,GAAAA,mBAAA","ignoreList":[]}
/**
 * Track a Wix Analytics event
 * @param eventName - Name of the event to track (supports standard Wix events and custom events)
 * @param eventData - Event data typed according to the event name
 */
export function trackEvent(eventName, eventData) {
    const wixAnalyticsApi = getAnalyticsApi();
    wixAnalyticsApi.trackEvent(eventName, eventData);
}
/**
 * Register an event listener for Wix Analytics events
 * @param eventHandler - Callback function that will be invoked when analytics events are tracked
 * @param eventHandler.eventName - Name of the tracked event
 * @param eventHandler.eventData - Event data associated with the tracked event
 */
export function registerEventListener(eventHandler) {
    const wixAnalyticsApi = getAnalyticsApi();
    wixAnalyticsApi.registerEventListener(eventHandler);
}
function getAnalyticsApi() {
    const baseApiImpl = {
        trackEvent(eventName, eventData) { },
        registerEventListener(eventHandler) { },
    };
    const veloWixWindow = 
    // @ts-expect-error - ignoring globals type error
    typeof globals !== "undefined"
        ? // @ts-expect-error - ignoring globals type error
            globals?.$ns?.["wix-window"]
        : undefined;
    if (veloWixWindow) {
        return {
            trackEvent(eventName, eventData) {
                if (!veloWixWindow.trackEvent) {
                    console.warn("[Analytics] window.trackEvent is not available");
                    return;
                }
                veloWixWindow.trackEvent(eventName, eventData);
            },
            registerEventListener(eventHandler) {
                if (!veloWixWindow.registerEventListener) {
                    console.warn("[Analytics] window.registerEventListener is not available");
                    return;
                }
                veloWixWindow.registerEventListener(eventHandler);
            },
        };
    }
    if (typeof window === "undefined") {
        console.warn("[Analytics] trackEvent/registerEventListener can only be used in browser environment");
        return baseApiImpl;
    }
    if (!window.wixDevelopersAnalytics) {
        console.warn("[Analytics] window.wixDevelopersAnalytics is not available");
        return baseApiImpl;
    }
    return {
        trackEvent(eventName, eventData) {
            if (window.wixAnalytics?.trackEvent) {
                window.wixAnalytics.trackEvent(eventName, eventData);
                return;
            }
            if (!window.wixDevelopersAnalytics?.triggerEvent) {
                console.warn("[Analytics] window.wixDevelopersAnalytics.triggerEvent is not available");
                return;
            }
            window.wixDevelopersAnalytics.triggerEvent(eventName, eventData);
        },
        registerEventListener(eventHandler) {
            if (!window.wixDevelopersAnalytics?.register) {
                console.warn("[Analytics] window.wixDevelopersAnalytics.register is not available");
                return;
            }
            const randomString = generateRandomString();
            window.wixDevelopersAnalytics.register(randomString, eventHandler);
        },
    };
}
function generateRandomString() {
    return new Date().getTime().toString() + Math.random().toString(36).substring(2, 15);
}
//# sourceMappingURL=analytics.js.map
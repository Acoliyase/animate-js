import { isElementHandleLike } from './entityTypeChecks/isElementHandleLike';
import { deprecationsCheck } from './deprecationsCheck';
import { hasElement, hasPage, hasRoot, hasSelector } from './configShapeChecks';
export const getUniDriverParams = (config, querySelector) => {
    if (config === null) {
        const errorMessage = `[unidriver-puppeteer] Unsupported adapterParams shape encountered: null`;
        return {
            page: undefined,
            base: () => {
                throw new Error(errorMessage);
            },
            selector: errorMessage,
        };
    }
    return {
        selector: hasSelector(config) ? config.selector : '',
        page: hasPage(config) ? config.page : undefined,
        base: async () => {
            if (isElementHandleLike(config)) {
                return config;
            }
            deprecationsCheck(config);
            if (hasRoot(config) && hasSelector(config)) {
                const rootElement = await config.root;
                return isElementHandleLike(rootElement)
                    ? await querySelector(rootElement, config.selector)
                    : rootElement;
            }
            if (hasRoot(config)) {
                return config.root;
            }
            if (hasElement(config)) {
                return config.element;
            }
            if (hasPage(config) && hasSelector(config)) {
                return isElementHandleLike(config.page)
                    ? await querySelector(config.page, config.selector)
                    : config.page;
            }
            if (hasPage(config)) {
                return config.page;
            }
            return config;
        },
    };
};
//# sourceMappingURL=getUniDriverParams.js.map
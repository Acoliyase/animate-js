"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getUniDriverParams = void 0;
const isElementHandleLike_1 = require("./entityTypeChecks/isElementHandleLike");
const deprecationsCheck_1 = require("./deprecationsCheck");
const configShapeChecks_1 = require("./configShapeChecks");
const getUniDriverParams = (config, querySelector) => {
    if (config === null) {
        const errorMessage = `[unidriver-puppeteer] Unsupported adapterParams shape encountered: null`;
        return {
            page: undefined,
            base: () => {
                throw new Error(errorMessage);
            },
            selector: errorMessage,
        };
    }
    return {
        selector: (0, configShapeChecks_1.hasSelector)(config) ? config.selector : '',
        page: (0, configShapeChecks_1.hasPage)(config) ? config.page : undefined,
        base: async () => {
            if ((0, isElementHandleLike_1.isElementHandleLike)(config)) {
                return config;
            }
            (0, deprecationsCheck_1.deprecationsCheck)(config);
            if ((0, configShapeChecks_1.hasRoot)(config) && (0, configShapeChecks_1.hasSelector)(config)) {
                const rootElement = await config.root;
                return (0, isElementHandleLike_1.isElementHandleLike)(rootElement)
                    ? await querySelector(rootElement, config.selector)
                    : rootElement;
            }
            if ((0, configShapeChecks_1.hasRoot)(config)) {
                return config.root;
            }
            if ((0, configShapeChecks_1.hasElement)(config)) {
                return config.element;
            }
            if ((0, configShapeChecks_1.hasPage)(config) && (0, configShapeChecks_1.hasSelector)(config)) {
                return (0, isElementHandleLike_1.isElementHandleLike)(config.page)
                    ? await querySelector(config.page, config.selector)
                    : config.page;
            }
            if ((0, configShapeChecks_1.hasPage)(config)) {
                return config.page;
            }
            return config;
        },
    };
};
exports.getUniDriverParams = getUniDriverParams;
//# sourceMappingURL=getUniDriverParams.js.map
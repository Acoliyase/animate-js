// src/routes/robots.ts
import { ok } from "assert";
import { oAuthApps } from "@wix/auth-management";
import { WIX_CLIENT_ID } from "astro:env/client";

// src/elevate.ts
import { createRESTModule } from "@wix/sdk-runtime/rest-modules";
function elevate(restModule) {
  return createRESTModule(restModule, true);
}

// src/routes/robots.ts
var GET = async ({ request }) => {
  const { redirectUrlWixPages } = await elevate(oAuthApps.getOAuthApp)(
    WIX_CLIENT_ID
  );
  ok(redirectUrlWixPages != null);
  const baseUrl = redirectUrlWixPages.endsWith("/") ? redirectUrlWixPages : `${redirectUrlWixPages}/`;
  const robotsUrl = new URL("robots.txt", baseUrl);
  const userAgent = request.headers.get("user-agent");
  const originalResponse = await fetch(robotsUrl, {
    headers: { ...userAgent != null ? { "User-Agent": userAgent } : {} }
  });
  if (!originalResponse.ok) {
    throw new Error(
      `Failed to retrieve original robots.txt from: \`${robotsUrl.toString()}\`. Error: \`${originalResponse.statusText}\``
    );
  }
  const contentType = originalResponse.headers.get("content-type");
  return new Response(originalResponse.body, {
    headers: {
      ...contentType != null ? { "Content-Type": contentType } : {}
    }
  });
};
export {
  GET
};

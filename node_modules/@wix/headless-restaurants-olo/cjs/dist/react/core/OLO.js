import { jsx as _jsx } from "react/jsx-runtime";
import { useEffect } from 'react';
import { createServicesMap } from '@wix/services-manager';
import { WixServices } from '@wix/services-manager-react';
// import { ItemService, ItemServiceDefinition, loadItemServiceConfig } from '@/components/restaurants-olo/services/itemDetailsService';
import { OLOSettingsService, OLOSettingsServiceDefinition, } from '@wix/headless-restaurants-olo/services';
/**
 * Core OLO Root component that sets up service management
 * Provides ItemService and CurrentCartService to child components
 *
 * @example
 * ```tsx
 * <CoreOLO.Root itemId="item-123">
 *   {({ servicesManager, isLoading, hasServices }) => (
 *     hasServices ? (
 *       <ServicesManagerProvider servicesManager={servicesManager}>
 *         <ItemDetailsComponents />
 *       </ServicesManagerProvider>
 *     ) : (
 *       <LoadingSpinner />
 *     )
 *   )}
 * </CoreOLO.Root>
 * ```
 */
export const Root = ({ itemId, itemServiceConfig, cartServiceConfig, oloSettingsServiceConfig, children, }) => {
    // const [servicesManager, setServicesManager] = useState<ServicesManager | null>(null);
    // const [isLoading, setIsLoading] = useState(true);
    // const [error, setError] = useState<string | undefined>();
    useEffect(() => {
        // const initializeServices = async () => {
        //   setIsLoading(true);
        //   setError(undefined);
        //   try {
        //     // Load configurations if not provided
        //     const loadedConfigs = await Promise.all([
        //       cartServiceConfig || loadCurrentCartServiceConfig(),
        //       itemServiceConfig || (loadItemServiceConfig(itemId))
        //     ]);
        //     const [currentCartServiceConfig, itemServiceConfigResult] = loadedConfigs;
        //     // Handle item service config result (discriminated union)
        //     if (itemServiceConfigResult && 'type' in itemServiceConfigResult) {
        //       if (itemServiceConfigResult.type === 'notFound') {
        //         setError('Item not found');
        //         return;
        //       }
        //       // Use the config from the success result
        //       const finalItemServiceConfig = itemServiceConfigResult.config;
        //       // Create services manager with both services
        //       const manager = createServicesManager(
        //         createServicesMap()
        //           .addService(CurrentCartServiceDefinition, CurrentCartService, currentCartServiceConfig)
        //         //   .addService(ItemServiceDefinition, ItemService, finalItemServiceConfig)
        //       );
        //       setServicesManager(manager);
        //     } else if (itemServiceConfigResult) {
        //       // Direct config provided
        //       const manager = createServicesManager(
        //         createServicesMap()
        //           .addService(CurrentCartServiceDefinition, CurrentCartService, currentCartServiceConfig)
        //         //   .addService(ItemServiceDefinition, ItemService, itemServiceConfigResult)
        //       );
        //       setServicesManager(manager);
        //     } else {
        //       // Only cart service, no item service
        //       const manager = createServicesManager(
        //         createServicesMap()
        //           .addService(CurrentCartServiceDefinition, CurrentCartService, currentCartServiceConfig)
        //       );
        //       setServicesManager(manager);
        //     }
        //   } catch (err) {
        //     console.error('Failed to initialize services:', err);
        //     setError('Failed to initialize services');
        //   } finally {
        //     setIsLoading(false);
        //   }
        // };
        // initializeServices();
    }, [itemId, itemServiceConfig, cartServiceConfig]);
    // const hasServices = Boolean(servicesManager);
    //   return children({
    //     servicesManager,
    //     isLoading,
    //     error,
    //     hasServices
    //   });
    console.log('oloSettingsServiceConfig', oloSettingsServiceConfig);
    return (_jsx(WixServices, { servicesMap: createServicesMap().addService(OLOSettingsServiceDefinition, OLOSettingsService, oloSettingsServiceConfig), children: children }));
};
/**
 * Convenience wrapper that combines Root with ServicesManagerProvider
 * Automatically provides services context to children
 *
 * @example
 * ```tsx
 * <CoreOLO.Provider itemId="item-123">
 *   <ItemDetailsComponents />
 * </CoreOLO.Provider>
 * ```
 */
export const Provider = ({ itemId, itemServiceConfig, cartServiceConfig, oloSettingsServiceConfig, 
// loading = <div>Loading services...</div>,
// error: errorComponent = (error: string) => <div>Error: {error}</div>,
children, }) => {
    return (_jsx(Root, { itemId: itemId, itemServiceConfig: itemServiceConfig, cartServiceConfig: cartServiceConfig, oloSettingsServiceConfig: oloSettingsServiceConfig, children: children }));
};
/**
 * Specialized wrapper for item details that ensures ItemService is available
 *
 * @example
 * ```tsx
 * <CoreOLO.ItemDetails itemId="item-123">
 *   <ItemDetailsPrimitive.Root>
 *     {({ item }) => <div>{item.name}</div>}
 *   </ItemDetailsPrimitive.Root>
 * </CoreOLO.ItemDetails>
 * ```
 */
export const ItemDetails = ({ itemId, configs, loading, error, children, }) => {
    return (_jsx(Provider, { itemId: itemId, itemServiceConfig: configs?.itemServiceConfig, cartServiceConfig: configs?.cartServiceConfig, loading: loading, error: error, children: children }));
};

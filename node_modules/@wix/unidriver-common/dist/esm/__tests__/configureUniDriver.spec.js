import { render } from '@testing-library/react';
import { configureUniDriver } from '@wix/unidriver-core';
import React from 'react';
import { describe } from 'vitest';
import { testUniDriver } from './TestUniDriver/testUniDriver';
describe('configureUniDriver', () => {
    afterEach(() => {
        configureUniDriver();
    });
    describe('queryAttribute', () => {
        it('should work with string', async () => {
            configureUniDriver({ queryAttribute: 'data-hook' });
            const { container } = render(React.createElement("div", null,
                React.createElement("span", { "data-hook": "test-hook" }, "TEXT")));
            const driver = testUniDriver(container);
            expect(await driver.s('[data-hook="test-hook"]').text()).toBe('TEXT');
            expect(await driver.$('test-hook').text()).toBe('TEXT');
        });
        it('should work with function', async () => {
            configureUniDriver({ queryAttribute: (selector) => `[data-hook="${selector}"]` });
            const { container } = render(React.createElement("div", null,
                React.createElement("span", { "data-hook": "test-hook" }, "TEXT")));
            const driver = testUniDriver(container);
            expect(await driver.s('[data-hook="test-hook"]').text()).toBe('TEXT');
            expect(await driver.$('test-hook').text()).toBe('TEXT');
        });
    });
    it('should set defaultTimeout', async () => {
        configureUniDriver({ defaultTimeout: 10 });
        const { container } = render(React.createElement("div", null,
            React.createElement("span", { "data-hook": "test-hook" }, "TEXT")));
        const driver = testUniDriver(container);
        const firstCompletedTask = await Promise.race([
            driver
                .$('div')
                .$('button')
                .click()
                .catch(() => {
                return 'selector';
            }),
            new Promise((resolve) => {
                setTimeout(() => {
                    resolve('timeout');
                }, 100);
            }),
        ]);
        expect(firstCompletedTask).toBe('selector');
    });
    it('should override with newest value', async () => {
        configureUniDriver({ queryAttribute: 'some-test-id' });
        configureUniDriver({ queryAttribute: 'data-hook' });
        const { container } = render(React.createElement("div", null,
            React.createElement("span", { "data-hook": "test-hook" }, "TEXT")));
        const driver = testUniDriver(container);
        expect(await driver.$('test-hook').text()).toBe('TEXT');
    });
    it('should reset to default if called without params', async () => {
        configureUniDriver({ queryAttribute: 'some-test-id' });
        configureUniDriver();
        const { container } = render(React.createElement("div", null,
            React.createElement("span", { "data-hook": "test-hook" }, "TEXT")));
        const driver = testUniDriver(container).awaited(0);
        expect(await driver
            .$('test-hook')
            .text()
            .catch(() => {
            return 'not_found';
        })).toBe('not_found');
    });
});
//# sourceMappingURL=configureUniDriver.spec.js.map
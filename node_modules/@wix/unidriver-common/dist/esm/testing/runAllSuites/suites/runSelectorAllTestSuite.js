import { itemCreator } from '../../itemCreator';
import { runTest } from '../utils/runTest';
export const runSelectorAllTestSuite = (params) => {
    const { isStorybook, setup } = params;
    describe('$$', () => {
        describe('get()', () => {
            it('returns single driver in the required position', async ({ mount }) => {
                const items = [itemCreator({ label: 'Bob' }), itemCreator({ label: 'David' })];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-two-items' } : { items }, async ({ driver }) => {
                    expect(await driver.$$('.label').get(0).text()).toBe('Bob');
                    expect(await driver.$$('.label').get(1).text()).toBe('David');
                });
            });
            it('exists() works properly on elements from `.get`', async ({ mount }) => {
                await runTest(setup, { mount }, isStorybook ? { story: 'base' } : { items: [] }, async ({ driver }) => {
                    expect(await driver.$$('.some-elem-bla-bla').get(0).exists()).toBe(false);
                    expect(await driver.$$('.add').get(0).exists()).toBe(true);
                });
            });
        });
        describe('text()', () => {
            it('returns the text of all given drivers in the list', async ({ mount }) => {
                const items = [itemCreator({ label: 'Bob' }), itemCreator({ label: 'David' })];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-two-items' } : { items }, async ({ driver }) => {
                    expect(await driver.$$('.label').text()).toEqual(['Bob', 'David']);
                });
            });
        });
        describe('count()', () => {
            it('returns positive count of elements when found', async ({ mount }) => {
                const items = [itemCreator({ label: 'Bob' }), itemCreator({ label: 'David' }), itemCreator({ label: 'Jacob' })];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items' } : { items }, async ({ driver }) => {
                    expect(await driver.$$('[data-hook="todo-item"]').count()).toBe(3);
                });
            });
            it('returns zero when elements not found', async ({ mount }) => {
                await runTest(setup, { mount }, isStorybook ? { story: 'base' } : { items: [] }, async ({ driver }) => {
                    expect(await driver.$$('[data-hook="not_existing_element"]').count()).toBe(0);
                });
            });
        });
        describe('map()', () => {
            it('works for text', async ({ mount }) => {
                const items = [itemCreator({ label: 'Bob' }), itemCreator({ label: 'David' }), itemCreator({ label: 'Jacob' })];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items' } : { items }, async ({ driver }) => {
                    expect(await driver.$$('[data-hook="todo-item"] .label').map((bd) => bd.text())).toEqual([
                        'Bob',
                        'David',
                        'Jacob',
                    ]);
                });
            });
            it('passes index', async ({ mount }) => {
                const items = [itemCreator({ label: 'Bob' }), itemCreator({ label: 'David' }), itemCreator({ label: 'Jacob' })];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items' } : { items }, async ({ driver }) => {
                    const idx = await driver.$$('[data-hook="todo-item"]').map((_, i) => Promise.resolve(i));
                    expect(idx).toEqual([0, 1, 2]);
                });
            });
        });
        describe('filter()', () => {
            it('should reduce list based on filter function', async ({ mount }) => {
                const items = [
                    itemCreator({ completed: false, label: 'Bob' }),
                    itemCreator({ label: 'David' }),
                    itemCreator({ completed: true, label: 'Jacob' }),
                ];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items' } : { items }, async ({ driver }) => {
                    const completed = driver
                        .$$('[data-hook="todo-item"]')
                        .filter(async (item) => (await item.attr('data-completed')) === 'true');
                    expect(await completed.count()).toBe(1);
                    expect(await completed.at(0).text()).toContain('Jacob');
                });
            });
        });
        describe('find()', () => {
            it('should return a single UniDriver list element', async ({ mount }) => {
                const items = [
                    itemCreator({ completed: false, label: 'Bob' }),
                    itemCreator({ label: 'David' }),
                    itemCreator({ completed: true, label: 'Jacob' }),
                ];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items' } : { items }, async ({ driver }) => {
                    const completed = driver
                        .$$('[data-hook="todo-item"]')
                        .find(async (item) => (await item.attr('data-completed')) === 'true');
                    expect(await completed.text()).toContain('Jacob');
                });
            });
        });
        describe('some()', () => {
            it('should return true', async ({ mount }) => {
                const items = [
                    itemCreator({ completed: false, label: 'Bob' }),
                    itemCreator({ label: 'David' }),
                    itemCreator({ completed: true, label: 'Jacob' }),
                ];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items' } : { items }, async ({ driver }) => {
                    const completed = await driver
                        .$$('[data-hook="todo-item"]')
                        .some(async (item) => (await item.attr('data-completed')) === 'true');
                    expect(completed).toBe(true);
                });
            });
            it('should return false', async ({ mount }) => {
                const items = [
                    itemCreator({ completed: false, label: 'Bob' }),
                    itemCreator({ label: 'David' }),
                    itemCreator({ completed: false, label: 'Jacob' }),
                ];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items-not-completed' } : { items }, async ({ driver }) => {
                    const completed = await driver
                        .$$('[data-hook="todo-item"]')
                        .some(async (item) => (await item.attr('data-completed')) === 'true');
                    expect(completed).toBe(false);
                });
            });
        });
        describe('every()', () => {
            it('should return true', async ({ mount }) => {
                const items = [
                    itemCreator({ completed: true, label: 'Bob' }),
                    itemCreator({ completed: true, label: 'David' }),
                    itemCreator({ completed: true, label: 'Jacob' }),
                ];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items-all-completed' } : { items }, async ({ driver }) => {
                    const completed = await driver
                        .$$('[data-hook="todo-item"]')
                        .every(async (item) => (await item.attr('data-completed')) === 'true');
                    expect(completed).toBe(true);
                });
            });
            it('should return false', async ({ mount }) => {
                const items = [
                    itemCreator({ completed: true, label: 'Bob' }),
                    itemCreator({ label: 'David' }),
                    itemCreator({ completed: true, label: 'Jacob' }),
                ];
                await runTest(setup, { mount }, isStorybook ? { story: 'with-three-items' } : { items }, async ({ driver }) => {
                    const completed = await driver
                        .$$('[data-hook="todo-item"]')
                        .every(async (item) => (await item.attr('data-completed')) === 'true');
                    expect(completed).toBe(false);
                });
            });
        });
    });
};
//# sourceMappingURL=runSelectorAllTestSuite.js.map
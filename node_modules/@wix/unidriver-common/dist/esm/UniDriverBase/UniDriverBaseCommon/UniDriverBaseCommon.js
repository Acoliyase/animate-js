import { unidriverConfig } from '@wix/unidriver-core/internal';
import { getSelectorsPath } from '../getSelectorsPath';
import { runWithinTimeBudget } from './runWithinTimeBudget/runWithinTimeBudget';
export class UniDriverBaseCommon {
    get selectorsPath() {
        return getSelectorsPath(this.ctx);
    }
    constructor(ctx) {
        Object.defineProperty(this, "ctx", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "defaultTimeBudget", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 1_000
        });
        this.ctx = ctx;
    }
    getTimeBudget(timeBudget) {
        const getTimeBudget = (ctx, currentTimeBudget) => {
            if (ctx.timeBudget !== undefined) {
                return ctx.timeBudget;
            }
            if (ctx.parent) {
                return getTimeBudget(ctx.parent, currentTimeBudget);
            }
            return timeBudget;
        };
        return ((typeof timeBudget === 'number' ? timeBudget : getTimeBudget(this.ctx)) ??
            unidriverConfig.defaultTimeout ??
            this.defaultTimeBudget);
    }
    async runWithinTimeBudget(fn, timeBudget) {
        return runWithinTimeBudget(fn, this.getTimeBudget(timeBudget));
    }
}
//# sourceMappingURL=UniDriverBaseCommon.js.map
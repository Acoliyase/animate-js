"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UniDriverBaseCommon = void 0;
const internal_1 = require("@wix/unidriver-core/internal");
const getSelectorsPath_1 = require("../getSelectorsPath");
const runWithinTimeBudget_1 = require("./runWithinTimeBudget/runWithinTimeBudget");
class UniDriverBaseCommon {
    get selectorsPath() {
        return (0, getSelectorsPath_1.getSelectorsPath)(this.ctx);
    }
    constructor(ctx) {
        Object.defineProperty(this, "ctx", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "defaultTimeBudget", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 1_000
        });
        this.ctx = ctx;
    }
    getTimeBudget(timeBudget) {
        const getTimeBudget = (ctx, currentTimeBudget) => {
            if (ctx.timeBudget !== undefined) {
                return ctx.timeBudget;
            }
            if (ctx.parent) {
                return getTimeBudget(ctx.parent, currentTimeBudget);
            }
            return timeBudget;
        };
        return ((typeof timeBudget === 'number' ? timeBudget : getTimeBudget(this.ctx)) ??
            internal_1.unidriverConfig.defaultTimeout ??
            this.defaultTimeBudget);
    }
    async runWithinTimeBudget(fn, timeBudget) {
        return (0, runWithinTimeBudget_1.runWithinTimeBudget)(fn, this.getTimeBudget(timeBudget));
    }
}
exports.UniDriverBaseCommon = UniDriverBaseCommon;
//# sourceMappingURL=UniDriverBaseCommon.js.map
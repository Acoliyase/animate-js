{"version":3,"names":["_typeUtils","require","_clone","_interopRequireDefault","FilterValidator","constructor","operatorName","previousInvalidArguments","ctor","_defineProperty2","default","_validations","_invalidArguments","clone","typeIsString","value","addValidation","isString","typeForDisplay","typeIsStringNumberOrDate","isDateStringOrNumber","typeIsStringNumberBoolOrDate","isDateStringNumberOrBoolean","sameType","first","second","typeIsStringNumberOrDateForAll","values","every","validFieldName","field","isInstanceOfSameClass","obj","arityIsOne","args","length","arityIsTwo","arityIsThree","arityIsAtLeastTwo","predicateFn","messageFn","push","validateAndAggregate","valid","_appendIfInvalid","message","exports","isNumber","isDate","isBoolean"],"sources":["../../src/filter-validator.ts"],"sourcesContent":["import {\n  typeForDisplay,\n  isDate,\n  isString,\n  isNumber,\n  isBoolean,\n} from './type-utils'\nimport clone from './clone'\nimport { Validator } from './validator'\n\nexport class FilterValidator implements Validator {\n  private ctor\n  private _invalidArguments: string[]\n  public _validations: Validation[]\n  public operatorName?: string\n\n  constructor(operatorName, previousInvalidArguments, ctor) {\n    this._validations = []\n    this.operatorName = operatorName\n    this.ctor = ctor\n    this._invalidArguments = clone(previousInvalidArguments)\n  }\n\n  typeIsString(value) {\n    return this.addValidation(\n      () => isString(value),\n      () =>\n        `Invalid ${this.operatorName} parameter value [${typeForDisplay(\n          value\n        )}]. ${this.operatorName} parameter must be a String.`\n    )\n  }\n\n  typeIsStringNumberOrDate(value) {\n    return this.addValidation(\n      () => isDateStringOrNumber(value),\n      () =>\n        `Invalid ${this.operatorName} parameter value [${typeForDisplay(\n          value\n        )}]. Valid ${\n          this.operatorName\n        } parameter types are String, Number or Date.`\n    )\n  }\n\n  typeIsStringNumberBoolOrDate(value) {\n    return this.addValidation(\n      () => isDateStringNumberOrBoolean(value),\n      () =>\n        `Invalid ${this.operatorName} parameter value [${typeForDisplay(\n          value\n        )}]. Valid ${\n          this.operatorName\n        } parameter types are String, Number, Boolean or Date.`\n    )\n  }\n\n  sameType(first, second) {\n    return this.addValidation(\n      () => typeForDisplay(first) === typeForDisplay(second),\n      () =>\n        `Invalid ${this.operatorName} parameter values [${typeForDisplay(\n          first\n        )}] and [${typeForDisplay(\n          second\n        )}]. Both parameters must be of the same type.`\n    )\n  }\n\n  typeIsStringNumberOrDateForAll(values) {\n    return this.addValidation(\n      () => values.every(isDateStringOrNumber),\n      () =>\n        `Invalid ${this.operatorName} usage. ${this.operatorName} supports only Number, String or Date items.`\n    )\n  }\n\n  validFieldName(field) {\n    return this.addValidation(\n      () => isString(field),\n      () =>\n        `Invalid ${this.operatorName} field value [${typeForDisplay(field)}]. ${\n          this.operatorName\n        } field must be a String.`\n    )\n  }\n\n  isInstanceOfSameClass(obj) {\n    return this.addValidation(\n      () => obj instanceof this.ctor,\n      () =>\n        `Invalid ${this.operatorName} parameter [${typeForDisplay(obj)}]. ${\n          this.operatorName\n        } expects FilterBuilder only.`\n    )\n  }\n\n  arityIsOne(args) {\n    return this.addValidation(\n      () => args.length === 1,\n      () =>\n        `Invalid ${this.operatorName} usage. ${this.operatorName} requires one parameter.`\n    )\n  }\n\n  arityIsTwo(args) {\n    return this.addValidation(\n      () => args.length === 2,\n      () =>\n        `Invalid ${this.operatorName} usage. ${this.operatorName} requires two parameters.`\n    )\n  }\n\n  arityIsThree(args) {\n    return this.addValidation(\n      () => args.length === 3,\n      () =>\n        `Invalid ${this.operatorName} usage. ${this.operatorName} requires three parameters.`\n    )\n  }\n\n  arityIsAtLeastTwo(args) {\n    return this.addValidation(\n      () => args.length >= 2,\n      () =>\n        `Invalid ${this.operatorName} usage. ${this.operatorName} requires at least two parameters.`\n    )\n  }\n\n  addValidation(predicateFn, messageFn) {\n    this._validations.push({\n      predicateFn,\n      messageFn,\n    })\n    return this\n  }\n\n  validateAndAggregate(): [string[], boolean] {\n    const valid = this._validations.every(({ predicateFn, messageFn }) =>\n      this._appendIfInvalid(predicateFn(), messageFn())\n    )\n    return [this._invalidArguments, valid]\n  }\n\n  _appendIfInvalid(valid, message) {\n    if (!valid) {\n      this._invalidArguments.push(message)\n      return false\n    }\n    return true\n  }\n}\n\nfunction isDateStringOrNumber(value) {\n  return isString(value) || isNumber(value) || isDate(value)\n}\n\nfunction isDateStringNumberOrBoolean(value) {\n  return isString(value) || isNumber(value) || isDate(value) || isBoolean(value)\n}\n\ninterface Validation {\n  predicateFn: Function\n  messageFn: Function\n}\n"],"mappings":"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","ignoreList":[]}
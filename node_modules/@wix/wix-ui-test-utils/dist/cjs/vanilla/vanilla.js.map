{"version":3,"names":["React","_interopRequireWildcard","require","ReactDom","_testUtils","_reactHelpers","_unidriverJsdomReactLegacy","_jsxFileName","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","getElement","wrapper","dataHook","domInstance","findDOMNode","dataHookOnInstance","attributes","getNamedItem","value","querySelector","testkitFactoryCreator","driverFactory","testkitArgs","element","eventTrigger","reactEventTrigger","uniTestkitFactoryCreator","jsdomReactUniDriver","document","body","isTestkitExists","Element","testkitFactory","options","div","createElement","dataHookPropName","extraProps","elementToRender","cloneElement","renderedElement","renderIntoDocument","__self","__source","fileName","lineNumber","columnNumber","appendChild","testkit","exists","isUniTestkitExists"],"sources":["../../../src/vanilla/vanilla.tsx"],"sourcesContent":["import * as React from 'react';\nimport * as ReactDom from 'react-dom';\nimport { renderIntoDocument, Simulate } from 'react-dom/test-utils';\n\nimport { reactEventTrigger } from '../react-helpers';\nimport { BaseDriver } from '../driver-factory';\nimport { BaseUniDriver } from '../base-driver';\n\nimport { UniDriver } from '@wix/unidriver-core';\nimport { jsdomReactUniDriver } from '@wix/unidriver-jsdom-react-legacy';\n\nexport interface TestkitArgs {\n  wrapper: Element;\n  dataHook: string;\n}\n\nexport type TestkitOutputRegular<T extends BaseDriver> = (data: {\n  element: Element | undefined;\n  wrapper: Element;\n  eventTrigger: typeof Simulate;\n  dataHook: string;\n}) => T;\n\nexport type TestkitOutputUni<T extends BaseUniDriver> = (\n  base: UniDriver,\n  body: UniDriver,\n  options: { dataHook: string },\n) => T;\n\nconst getElement = ({ wrapper, dataHook }: TestkitArgs) => {\n  const domInstance = ReactDom.findDOMNode(wrapper) as Element;\n\n  if (domInstance) {\n    const dataHookOnInstance = domInstance.attributes.getNamedItem(\n      'data-hook',\n    ) || { value: '' };\n\n    return dataHook === dataHookOnInstance.value\n      ? domInstance\n      : domInstance.querySelector(`[data-hook='${dataHook}']`);\n  }\n\n  return;\n};\n\nexport function testkitFactoryCreator<T extends BaseDriver>(\n  driverFactory: TestkitOutputRegular<T>,\n) {\n  return (testkitArgs: TestkitArgs) =>\n    driverFactory({\n      element: getElement(testkitArgs) as Element,\n      wrapper: testkitArgs.wrapper,\n      eventTrigger: reactEventTrigger(),\n      dataHook: testkitArgs.dataHook,\n    });\n}\n\nexport function uniTestkitFactoryCreator<T extends BaseUniDriver>(\n  driverFactory: TestkitOutputUni<T>,\n) {\n  return (testkitArgs: TestkitArgs) => {\n    const element = getElement(testkitArgs) as Element;\n    return driverFactory(\n      jsdomReactUniDriver(element),\n      jsdomReactUniDriver(document.body),\n      { dataHook: testkitArgs.dataHook },\n    );\n  };\n}\n\nexport function isTestkitExists<T extends BaseDriver>(\n  Element: React.ReactElement<any>,\n  testkitFactory: (obj: { wrapper: any; dataHook: string }) => T,\n  options?: { dataHookPropName?: string },\n) {\n  const div = document.createElement('div');\n  const dataHook = 'myDataHook';\n  const dataHookPropName = options && options.dataHookPropName;\n  const extraProps = dataHookPropName\n    ? { [dataHookPropName]: dataHook }\n    : { 'data-hook': dataHook, dataHook }; // For backward compatibility add dataHook which is used in Wix-Style-React\n  const elementToRender = React.cloneElement(Element, extraProps);\n  const renderedElement = renderIntoDocument(<div>{elementToRender}</div>);\n  const wrapper = div.appendChild(renderedElement as any);\n  const testkit = testkitFactory({ wrapper, dataHook });\n  return testkit.exists();\n}\n\nexport async function isUniTestkitExists<T extends BaseUniDriver>(\n  Element: React.ReactElement<any>,\n  testkitFactory: (obj: { wrapper: any; dataHook: string }) => T,\n  options?: { dataHookPropName?: string },\n) {\n  const div = document.createElement('div');\n  const dataHook = 'myDataHook';\n  const dataHookPropName = options && options.dataHookPropName;\n  const extraProps = dataHookPropName\n    ? { [dataHookPropName]: dataHook }\n    : { 'data-hook': dataHook, dataHook };\n  const elementToRender = React.cloneElement(Element, extraProps);\n  const renderedElement = renderIntoDocument(<div>{elementToRender}</div>);\n  const wrapper = div.appendChild(renderedElement as any);\n  const testkit = testkitFactory({ wrapper, dataHook });\n  return testkit.exists();\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"itemHelper.js","sourceRoot":"","sources":["../../../../src/components/item/itemHelper.js"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,SAAS,EAAE,cAAc,EAAE,UAAU,EAAE,MAAM,iBAAiB,CAAC;AAEnG,SAAS,yBAAyB;IAChC,OAAO,CAAC,UAAU,EAAE,IAAI,SAAS,EAAE,CAAC,IAAI,MAAM,CAAC,QAAQ,CAAC;AAC1D,CAAC;AAED,MAAM,UAAU,aAAa,CAAC,EAAE,aAAa,EAAE,0BAA0B,EAAE,UAAU,EAAE;IACrF,IAAI,yBAAyB,EAAE,IAAI,0BAA0B,EAAE;QAC7D;;4EAEoE;QACpE,MAAM,aAAa,GAAG,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC;QACpD,IAAI,aAAa,KAAK,UAAU,EAAE;YAChC,aAAa,CAAC,KAAK,EAAE,CAAC;SACvB;KACF;AACH,CAAC;AAED,SAAS,2BAA2B,CAAC,SAAS,EAAE,SAAS;IACvD,MAAM,aAAa,GAAG,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC;IACpD,OAAO,CACL,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC;QACnD,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,gBAAgB,SAAS,KAAK,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,CAAC,CAC1F,CAAC;AACJ,CAAC;AAED,MAAM,UAAU,2BAA2B,CAAC,EAAE,SAAS,EAAE,YAAY,EAAE,aAAa,EAAE;IACpF,IAAI;QACF,IAAI,yBAAyB,EAAE,IAAI,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,EAAE;YAC1E,MAAM,mBAAmB,GAAG,2BAA2B,CAAC,aAAa,EAAE,YAAY,CAAC,SAAS,CAAC,CAAC;YAC/F,MAAM,iBAAiB,GAAG,2BAA2B,CAAC,WAAW,EAAE,YAAY,CAAC,SAAS,CAAC,CAAC;YAC3F,IAAI,mBAAmB,IAAI,iBAAiB,EAAE;gBAC5C,IACE,YAAY,CAAC,oBAAoB,KAAK,SAAS,CAAC,oBAAoB;oBACpE,YAAY,CAAC,oBAAoB,KAAK,YAAY,CAAC,EAAE,EACrD;oBACA,6EAA6E;oBAC7E,aAAa,CAAC,KAAK,EAAE,CAAC;iBACvB;qBAAM,IACL,YAAY,CAAC,WAAW,KAAK,SAAS,CAAC,WAAW;oBAClD,YAAY,CAAC,WAAW,KAAK,YAAY,CAAC,GAAG,EAC7C;oBACA,sDAAsD;oBACtD,aAAa,CAAC,KAAK,EAAE,CAAC;iBACvB;aACF;SACF;KACF;IAAC,OAAO,CAAC,EAAE;QACV,OAAO,CAAC,KAAK,CAAC,uCAAuC,EAAE,CAAC,CAAC,CAAC;KAC3D;AACH,CAAC;AAED,MAAM,UAAU,4BAA4B,CAAC,OAAO;IAClD,OAAO,CACL,OAAO,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC;QAChE,CAAC,CAAC,KAAK,CAAC,6BAA6B,CAAC,OAAO,CAAC;YAC5C,OAAO,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;gBACxD,cAAc,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,CAC5E,CAAC;AACJ,CAAC","sourcesContent":["import { window, utils, isSiteMode, isSEOMode, GALLERY_CONSTS, optionsMap } from 'pro-gallery-lib';\n\nfunction shouldChangeActiveElement() {\n  return (isSiteMode() || isSEOMode()) && window.document;\n}\n\nexport function onAnchorFocus({ itemContainer, enableExperimentalFeatures, itemAnchor }) {\n  if (shouldChangeActiveElement() && enableExperimentalFeatures) {\n    /* Relevant only for Screen-Reader cases:\n         When we navigate on the accessibility tree, screen readers stops and focuses on the <a> tag,\n         so it will not go deeper to the item-container keyDown event */\n    const activeElement = window.document.activeElement;\n    if (activeElement === itemAnchor) {\n      itemContainer.focus();\n    }\n  }\n}\n\nfunction isThisGalleryElementInFocus(className, galleryId) {\n  const activeElement = window.document.activeElement;\n  return (\n    String(activeElement.className).includes(className) &&\n    !!window.document.querySelector(`#pro-gallery-${galleryId} #${String(activeElement.id)}`)\n  );\n}\n\nexport function changeActiveElementIfNeeded({ prevProps, currentProps, itemActionRef }) {\n  try {\n    if (shouldChangeActiveElement() && window.document.activeElement.className) {\n      const isGalleryItemAction = isThisGalleryElementInFocus('item-action', currentProps.galleryId);\n      const isShowMoreInFocus = isThisGalleryElementInFocus('show-more', currentProps.galleryId);\n      if (isGalleryItemAction || isShowMoreInFocus) {\n        if (\n          currentProps.thumbnailHighlightId !== prevProps.thumbnailHighlightId &&\n          currentProps.thumbnailHighlightId === currentProps.id\n        ) {\n          // if the highlighted thumbnail changed and it is the same as this itemview's\n          itemActionRef.focus();\n        } else if (\n          currentProps.activeIndex !== prevProps.activeIndex &&\n          currentProps.activeIndex === currentProps.idx\n        ) {\n          //check if activeIndex has changed to the current item\n          itemActionRef.focus();\n        }\n      }\n    }\n  } catch (e) {\n    console.error('Could not set focus to active element', e);\n  }\n}\n\nexport function shouldCreateVideoPlaceholder(options) {\n  return (\n    options[optionsMap.behaviourParams.item.video.enablePlaceholder] &&\n    (!utils.isSingleItemHorizontalDisplay(options) ||\n      options[optionsMap.behaviourParams.item.video.playTrigger] !==\n        GALLERY_CONSTS[optionsMap.behaviourParams.item.video.playTrigger].AUTO)\n  );\n}\n"]}